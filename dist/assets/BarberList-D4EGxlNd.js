import{u as x,a as pe,b as xe,r as l,d as ve,j as n,h as ge,C as G,i as je,S as ke,_ as J}from"./index-zklAvn-K.js";import{g as $e,c as fe,a as ye,b as Ie,d as Ce,e as Se}from"./BarberAction-BTxzqJAm.js";import{B as Q}from"./ButtonLoader-DrEEcdA8.js";import{M as U}from"./Modal-KFQkxZ6b.js";import"./index-DikGMDqK.js";import"./clsx-B-dksMZM.js";import"./getReactElementRef-C0jiAxVM.js";const we="_admin_barber_wrapper_1kh31_1",Ne="_barber_send_btn_1kh31_33",Ae="_create_barber_btn_1kh31_72",Ee="_admin_barber_content_wrapper_1kh31_119",Be="_admin_barber_content_body_1kh31_129",Me="_admin_barber_content_body_item_1kh31_222",Oe="_barber_online_btn_active_1kh31_313",De="_barber_clock_btn_active_1kh31_314",Ke="_barber_online_btn_inactive_1kh31_325",Le="_barber_clock_btn_inactive_1kh31_326",He="_barber_approve_btn_active_1kh31_351",Re="_barber_approve_btn_inactive_1kh31_362",ze="_modal_container_1kh31_375",Pe="_modal_content_container_1kh31_442",qe="_barber_content_body_error_1kh31_520",Fe="_dark_1kh31_534",s={admin_barber_wrapper:we,barber_send_btn:Ne,create_barber_btn:Ae,admin_barber_content_wrapper:Ee,admin_barber_content_body:Be,admin_barber_content_body_item:Me,barber_online_btn_active:Oe,barber_clock_btn_active:De,barber_online_btn_inactive:Ke,barber_clock_btn_inactive:Le,barber_approve_btn_active:He,barber_approve_btn_inactive:Re,modal_container:ze,modal_content_container:Pe,barber_content_body_error:qe,dark:Fe},en=()=>{const h=x(e=>e.AdminLoggedInMiddleware.adminSalonId),V=x(e=>e.getAdminBarberList),{loading:W,resolve:X,getAllBarbers:r}=V,u=pe(),O=xe(),Y=()=>{O("/admin-barber/createbarber")},Z=e=>{O(`/admin-barber/editbarber/${e.salonId}`,{state:e})};l.useEffect(()=>{if(r&&r.length>0){const e=new Map;r.forEach(a=>{const t=`${a.salonId}-${a.barberId}`;e.set(t,a.isOnline||!1)}),g(e);const o=new Map;r.forEach(a=>{const t=`${a.salonId}-${a.barberId}`;o.set(t,a.isClockedIn||!1)}),C(o)}},[r]);const[c,g]=l.useState(new Map),ee=e=>{g(a=>{const t=new Map(a),b=`${e.salonId}-${e.barberId}`,p=!t.get(b)||!1;return t.set(b,p),t});const o={barberId:e.barberId,salonId:e.salonId,isOnline:!(c!=null&&c.get(`${e.salonId}-${e.barberId}`))||!1};u(fe(o,g,e,c==null?void 0:c.get(`${e.salonId}-${e.barberId}`)))},[_,C]=l.useState(new Map),ne=e=>{C(a=>{const t=new Map(a),b=`${e.salonId}-${e.barberId}`,p=!t.get(b)||!1;return t.set(b,p),t});const o={barberId:e.barberId,salonId:e.salonId,isClockedIn:!(_!=null&&_.get(`${e.salonId}-${e.barberId}`))||!1};u(ye(o,C,e,_==null?void 0:_.get(`${e.salonId}-${e.barberId}`),g))},S=l.useRef(new AbortController);l.useEffect(()=>{const e=new AbortController;return S.current=e,u($e(h,e.signal)),()=>{S.current&&S.current.abort()}},[h,u]);const[i,w]=l.useState(new Map);l.useEffect(()=>{if(r){const e=new Map;r.forEach(o=>{const a=`${o.salonId}-${o.email}`;e.set(a,o.isApproved||!1)}),w(e)}},[r]);const ae=e=>{w(a=>{const t=new Map(a),b=`${e.salonId}-${e.email}`,p=!t.get(b)||!1;return t.set(b,p),t});const o={salonId:e.salonId,email:e.email,isApproved:!(i!=null&&i.get(`${e.salonId}-${e.email}`))||!1};u(Ie(o,w,e,i==null?void 0:i.get(`${e.salonId}-${e.email}`)))},se=x(e=>e.adminApproveBarber),{loading:te,resolve:Te,response:Ge}=se;l.useState(!1);const m=x(ve)==="On",[re,N]=l.useState(!1),[D,A]=l.useState({}),[v,j]=l.useState([]),[K,k]=l.useState([]),[E,$]=l.useState([]),oe=e=>{const o=!D[e._id];A(a=>({...a,[e._id]:o})),o?(j(a=>[...a,e.email]),k(a=>[...a,+`${e==null?void 0:e.mobileCountryCode}${e==null?void 0:e.mobileNumber}`]),$(a=>[...a,e.name]),N(!1)):(j(a=>a.filter(t=>t!==e.email)),k(a=>a.filter(t=>t!==+`${e==null?void 0:e.mobileCountryCode}${e==null?void 0:e.mobileNumber}`)),$(a=>a.filter(t=>t!==e.name)),N(!1))},ie=e=>{N(o=>{if(o)j([]),k([]),$([]),A({});else{const a=r.map(d=>d.email),t=r.map(d=>+`${d==null?void 0:d.mobileCountryCode}${d==null?void 0:d.mobileNumber}`),b=r.map(d=>d.name),p=r.reduce((d,ue)=>(d[ue._id]=!0,d),{});j(a),k(t),$(b),A(p)}return!o})},[le,f]=l.useState(!1),de=()=>{v.length>0?f(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},[L,H]=l.useState(""),[R,B]=l.useState(""),z=()=>{u(Ce({subject:L,message:R,role:"Barber",recipientEmails:v},H,B,f))},y=e=>{e.key==="Enter"&&z()},ce=x(e=>e.adminSendBarberEmail),{loading:P}=ce,[_e,I]=l.useState(!1),[q,me]=l.useState(""),be=()=>{K.length>0?I(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},F=()=>{u(Se({smsBody:q,numbers:K},B,I))},M=e=>{e.key==="Enter"&&F()},he=x(e=>e.adminSendBarberMessage),{loading:T}=he;return n.jsxs("div",{className:`${s.admin_barber_wrapper} ${m&&s.dark}`,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Barber List"}),n.jsxs("div",{children:[n.jsx("button",{className:`${s.barber_send_btn} ${m&&s.dark}`,onClick:de,title:"Email",disabled:h===0,style:{cursor:h===0?"not-allowed":"cursor"},children:n.jsx("div",{children:n.jsx(ge,{})})}),n.jsx(U,{open:le,onClose:()=>f(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:`${s.modal_container} ${m&&s.dark}`,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Email"}),n.jsx("button",{onClick:()=>f(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:s.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"support@iqueuebarbers.com",readOnly:!0,onKeyDown:y})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:v==null?void 0:v.map(e=>" "+e),onKeyDown:y})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Subject"}),n.jsx("input",{type:"text",placeholder:"Enter Subject",value:L,onChange:e=>H(e.target.value),onKeyDown:y})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:R,onChange:e=>B(e.target.value),onKeyDown:y})]}),P?n.jsx("button",{className:s.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:z,disabled:P,className:s.barber_send_btn,children:"Send"})]})]})}),n.jsx("button",{className:`${s.barber_send_btn} ${m&&s.dark}`,onClick:be,disabled:h===0,style:{cursor:h===0?"not-allowed":"cursor"},title:"Message",children:n.jsx("div",{children:n.jsx(je,{})})}),n.jsx(U,{open:_e,onClose:()=>I(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:`${s.modal_container} ${m&&s.dark}`,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Message"}),n.jsx("button",{onClick:()=>I(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:s.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"iqueuebarbers",readOnly:!0,onKeyDown:M})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:E==null?void 0:E.map(e=>" "+e),onKeyDown:M})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:q,onChange:e=>me(e.target.value),onKeyDown:M})]}),T?n.jsx("button",{className:s.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:F,disabled:T,className:s.barber_send_btn,children:"Send"})]})]})}),n.jsxs("button",{onClick:Y,className:`${s.create_barber_btn}`,disabled:h===0,style:{cursor:h===0?"not-allowed":"cursor"},children:[n.jsx("p",{children:"Create"}),n.jsx("div",{children:"+"})]})]})]}),n.jsx("div",{className:`${s.admin_barber_content_wrapper} ${m&&s.dark}`,children:W?n.jsx("div",{className:s.admin_barber_content_body,children:n.jsx(ke,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:m?"var(--dark-loader-bg-color)":"var(--light-loader-bg-color)",highlightColor:m?"var(--dark-loader-highlight-color)":"var(--light-loader-highlight-color)"})}):X&&(r==null?void 0:r.length)>0?n.jsxs("div",{className:`${s.admin_barber_content_body} ${m&&s.dark}`,children:[n.jsxs("div",{children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",onChange:ie,checked:re})}),n.jsx("p",{children:"Name"}),n.jsx("p",{children:"Email"}),n.jsx("div",{children:n.jsx("p",{children:"isOnline"})}),n.jsx("div",{children:n.jsx("p",{children:"isClockIn"})}),n.jsx("div",{children:n.jsx("p",{children:"isApprove"})}),n.jsx("div",{children:n.jsx("p",{children:"Edit"})})]}),r==null?void 0:r.map((e,o)=>n.jsxs("div",{className:s.admin_barber_content_body_item,style:{borderBottom:(r==null?void 0:r.length)-1===o&&"none"},children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",checked:D[e._id]||!1,onChange:()=>oe(e)})}),n.jsx("p",{children:(e==null?void 0:e.name.length)>18?(e==null?void 0:e.name.slice(0,18))+"...":e==null?void 0:e.name}),n.jsx("p",{children:(e==null?void 0:e.email.length)>18?(e==null?void 0:e.email.slice(0,18))+"...":e==null?void 0:e.email}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ee(e),className:c!=null&&c.get(`${e.salonId}-${e.barberId}`)?s.barber_online_btn_active:s.barber_online_btn_inactive,children:c!=null&&c.get(`${e.salonId}-${e.barberId}`)?"Online":"Offline"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ne(e),className:_!=null&&_.get(`${e.salonId}-${e.barberId}`)?s.barber_clock_btn_active:s.barber_clock_btn_inactive,children:_!=null&&_.get(`${e.salonId}-${e.barberId}`)?"Clock-In":"Clock-Out"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ae(e),className:i!=null&&i.get(`${e.salonId}-${e.email}`)?s.barber_approve_btn_active:s.barber_approve_btn_inactive,disabled:!!te,children:i!=null&&i.get(`${e.salonId}-${e.email}`)?"Approved":"Approve"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>Z(e),disabled:(i==null?void 0:i.get(`${e.salonId}-${e.email}`))===!1,style:{cursor:(i==null?void 0:i.get(`${e.salonId}-${e.email}`))===!1&&"not-allowed"},children:"Edit"})})]},e._id))]}):n.jsx("div",{className:`${s.barber_content_body_error} ${m&&s.dark}`,children:n.jsx("p",{children:"Barbers not available"})})})]})};export{en as default};
