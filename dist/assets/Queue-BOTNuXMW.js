import{A,p as g,q as k,_ as u,t as v,v as h,w as C,x as I,y as b,b as m,u as L,r as S,d as R,j as a,z as N}from"./index-D1NNQ8TS.js";import{S as U}from"./index-BfkzATpX.js";import{a as D}from"./DashboardAction-fMlSZjtm.js";const $="_admin_queue_wrapper_1qkef_1",B="_admin_queue_content_wrapper_1qkef_29",M="_admin_queue_content_body_1qkef_39",z="_admin_queue_content_body_item_1qkef_129",T="_admin_queue_content_body_error_1qkef_208",P="_modal_container_1qkef_221",r={admin_queue_wrapper:$,admin_queue_content_wrapper:B,admin_queue_content_body:M,admin_queue_content_body_item:z,admin_queue_content_body_error:T,modal_container:P},V=(t,_)=>async o=>{var d,s,i,l;try{o({type:A});const{data:n}=await g.post("/api/queue/barberServedQueue",t);o({type:k,payload:n}),u.success("Customer serve successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const{data:f}=await g.get(`/api/queue/getQListBySalonId?salonId=${_}`);o({type:v,payload:f})}catch(n){if(((d=n==null?void 0:n.response)==null?void 0:d.status)===500){o({type:h,payload:"Something went wrong !"}),u.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}o({type:h,payload:(s=n==null?void 0:n.response)==null?void 0:s.data}),u.error((l=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:l.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},F=(t,_)=>async o=>{var d,s,i,l;try{o({type:C});const{data:n}=await g.post("/api/queue/cancelQ",t);o({type:I,payload:n}),u.success("Customer cancel successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const{data:f}=await g.get(`/api/queue/getQListBySalonId?salonId=${_}`);o({type:v,payload:f})}catch(n){if(((d=n==null?void 0:n.response)==null?void 0:d.status)===500){o({type:b,payload:"Something went wrong !"}),u.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}o({type:b,payload:(s=n==null?void 0:n.response)==null?void 0:s.data}),u.error((l=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:l.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},G=()=>{const t=m(e=>e.AdminLoggedInMiddleware.adminSalonId),_=m(e=>e.AdminLoggedInMiddleware.adminEmail),o=L(),d=S.useRef(new AbortController);S.useEffect(()=>{const e=new AbortController;return d.current=e,o(D(t,e.signal)),()=>{d.current&&d.current.abort()}},[t,o]);const s=m(e=>e.getAllQueueList),{loading:i,resolve:l,queueList:n}=s,c=m(R)==="On",q=e=>{if(e.qPosition!==1)return u.error("Queue position is not 1",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const p=window.confirm("Are you Sure ?"),y={adminEmail:_,barberId:e.barberId,salonId:t,services:e.services,_id:e._id};p&&o(V(y,t))},E=e=>{const p=window.confirm("Are you Sure ?"),y={adminEmail:_,barberId:e.barberId,salonId:t,_id:e._id};p&&o(F(y,t))},Q=m(e=>e.adminServeQueue),{loading:x}=Q,j=m(e=>e.adminCancelQueue),{loading:w}=j;return a.jsxs("div",{className:`${r.admin_queue_wrapper} ${c&&r.dark}`,children:[a.jsx("div",{children:a.jsx("p",{children:"Queue List"})}),a.jsx("div",{className:`${r.admin_queue_content_wrapper} ${c&&r.dark}`,children:i?a.jsx("div",{className:r.admin_queue_content_body,children:a.jsx(U,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:c?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:c?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):l&&(n==null?void 0:n.length)>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${r.admin_queue_content_body} ${c&&r.dark}`,children:[a.jsxs("div",{children:[a.jsx("p",{children:"Name"}),a.jsx("p",{children:"Time Joined Q"}),a.jsx("p",{children:"Barber Name"}),a.jsx("p",{children:"Q Postion"}),a.jsx("p",{children:"Type"}),a.jsx("p",{children:"Serve"}),a.jsx("p",{children:"Cancel"})]}),n==null?void 0:n.map((e,p)=>a.jsxs("div",{className:`${r.admin_queue_content_body_item} ${c&&r.dark}`,style:{borderBottom:n.length-1===p&&"none"},children:[a.jsx("p",{children:e.name.length>18?e.name.slice(0,18)+"...":e.name}),a.jsx("p",{children:e.timeJoinedQ}),a.jsx("p",{children:e.barberName.length>18?e.barberName.slice(0,18)+"...":e.barberName}),a.jsx("p",{children:e.qPosition}),a.jsx("div",{children:e.serviceType==="VIP"?a.jsx(N,{}):"-"}),a.jsx("div",{children:a.jsx("button",{onClick:()=>q(e),disabled:x,children:"Serve"})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>E(e),disabled:w,children:"Cancel"})})]},e._id))]})}):a.jsx("div",{className:`${r.admin_queue_content_body_error} ${c&&r.dark}`,children:a.jsx("p",{children:"Queue not available"})})})]})};export{G as default};
