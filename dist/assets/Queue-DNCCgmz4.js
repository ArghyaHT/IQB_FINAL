import{b as l,u as P,r as a,d as J,j as r,t as V,v as z,C as F,_ as G}from"./index-LE4wwcdg.js";import{S as A}from"./index-BAtn3kHc.js";import{a as K}from"./DashboardAction-BOl7_IaL.js";import{a as U,b as X}from"./QueueAction-IuVvU23l.js";import{g as Y}from"./BarberAction-C1pW1p8U.js";import{B as Z}from"./ButtonLoader-evyw5ydJ.js";import{M as ee}from"./Modal-2aVE2EVH.js";import"./index-C8qIyj46.js";import"./clsx-B-dksMZM.js";import"./getReactElementRef-Difek1I8.js";const re="_admin_queue_wrapper_1cjjc_1",oe="_customer_search_1cjjc_28",ne="_admin_queue_content_wrapper_1cjjc_65",ae="_admin_queue_content_body_1cjjc_75",te="_admin_queue_content_body_item_1cjjc_169",de="_admin_queue_content_body_error_1cjjc_248",ie="_modal_container_1cjjc_261",se="_modal_content_container_1cjjc_327",ce="_barber_dropdown_loading_1cjjc_343",le="_barber_dropdown_1cjjc_343",_e="_barber_dropdown_error_1cjjc_370",me="_choose_barber_dropdown_item_1cjjc_423",ue="_barber_online_dot_1cjjc_453",o={admin_queue_wrapper:re,customer_search:oe,admin_queue_content_wrapper:ne,admin_queue_content_body:ae,admin_queue_content_body_item:te,admin_queue_content_body_error:de,modal_container:ie,modal_content_container:se,barber_dropdown_loading:ce,barber_dropdown:le,barber_dropdown_error:_e,choose_barber_dropdown_item:me,barber_online_dot:ue},Ae=()=>{const d=l(e=>e.AdminLoggedInMiddleware.adminSalonId),x=l(e=>e.AdminLoggedInMiddleware.adminEmail),_=P(),j=a.useRef(new AbortController);a.useEffect(()=>{const e=new AbortController;return j.current=e,_(K(d,e.signal)),()=>{j.current&&j.current.abort()}},[d,_]);const k=l(e=>e.getAllQueueList),{loading:S,resolve:N,queueList:i}=k,[s,p]=a.useState([]);a.useEffect(()=>{i&&p(i)},[i]);const[b,Q]=a.useState(""),L=e=>{Q(e);const n=e.toLowerCase().trim();p(b?c=>i==null?void 0:i.filter(q=>q.name.toLowerCase().includes(n)||q.barberName.toLowerCase().includes(n)):i)},t=l(J)==="On",B=e=>{if(e.qPosition!==1)return G.error("Queue position is not 1",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const n=window.confirm("Are you Sure ?"),c={adminEmail:x,barberId:e.barberId,salonId:d,services:e.services,_id:e._id};n&&(C(e==null?void 0:e.barberName),y(e==null?void 0:e.barberEmail),h({open:!0,data:c}))},E=e=>{const n=window.confirm("Are you Sure ?"),c={adminEmail:x,barberId:e.barberId,salonId:d,_id:e._id};n&&_(U(c,d))},I=l(e=>e.adminServeQueue),{loading:v}=I,$=l(e=>e.adminCancelQueue),{loading:R}=$,[f,h]=a.useState({open:!1,data:{}}),[T,C]=a.useState(""),[w,y]=a.useState(""),g=a.useRef(new AbortController);a.useEffect(()=>{const e=new AbortController;return g.current=e,_(Y(d,e.signal)),()=>{g.current&&g.current.abort()}},[d,_]);const M=l(e=>e.getAdminBarberList),{loading:O,resolve:H,getAllBarbers:u}=M,[m,W]=a.useState([]);a.useEffect(()=>{if(u){const e=u==null?void 0:u.filter(n=>n.isClockedIn);W(e)}},[u]);const D=()=>{const e={...f.data,servedByEmail:w};_(X(e,d,h))};return r.jsxs("div",{className:`${o.admin_queue_wrapper} ${t&&o.dark}`,children:[r.jsxs("div",{children:[r.jsx("p",{children:"Queue List"}),r.jsxs("div",{className:`${o.customer_search} ${t&&o.dark}`,children:[r.jsx("input",{type:"text",placeholder:"Search Queue",value:b,onChange:e=>L(e.target.value)}),r.jsx("div",{children:r.jsx(V,{})})]})]}),r.jsx("div",{className:`${o.admin_queue_content_wrapper} ${t&&o.dark}`,children:S?r.jsx("div",{className:o.admin_queue_content_body,children:r.jsx(A,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:t?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:t?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):N&&(s==null?void 0:s.length)>0?r.jsx(r.Fragment,{children:r.jsxs("div",{className:`${o.admin_queue_content_body} ${t&&o.dark}`,children:[r.jsxs("div",{children:[r.jsx("p",{children:"#"}),r.jsx("p",{children:"Name"}),r.jsx("p",{children:"Barber Name"}),r.jsx("p",{children:"Time Joined Q"}),r.jsx("div",{children:r.jsx("p",{children:"Qg Code"})}),r.jsx("div",{children:r.jsx("p",{children:"EWT"})}),r.jsx("div",{children:r.jsx("p",{children:"Type"})}),r.jsx("div",{children:r.jsx("p",{children:"Serve"})}),r.jsx("div",{children:r.jsx("p",{children:"Cancel"})})]}),s==null?void 0:s.map((e,n)=>r.jsxs("div",{className:`${o.admin_queue_content_body_item} ${t&&o.dark}`,style:{borderBottom:s.length-1===n&&"none"},children:[r.jsx("p",{children:e.qPosition}),r.jsx("p",{children:e.name.length>18?e.name.slice(0,18)+"...":e.name}),r.jsx("p",{children:e.barberName.length>18?e.barberName.slice(0,18)+"...":e.barberName}),r.jsx("p",{children:e.timeJoinedQ}),r.jsx("p",{children:e==null?void 0:e.qgCode}),r.jsx("p",{children:e==null?void 0:e.serviceEWT}),r.jsx("div",{children:e.serviceType==="VIP"?r.jsx(z,{}):"-"}),r.jsx("div",{children:r.jsx("button",{onClick:()=>B(e),disabled:v,children:"Serve"})}),r.jsx("div",{children:r.jsx("button",{onClick:()=>E(e),disabled:R,children:"Cancel"})})]},e._id))]})}):r.jsx("div",{className:`${o.admin_queue_content_body_error} ${t&&o.dark}`,children:r.jsx("p",{children:"Queue not available"})})}),r.jsx(ee,{open:f.open,onClose:()=>h({open:!1,data:{}}),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:r.jsxs("div",{className:o.modal_container,children:[r.jsxs("div",{children:[r.jsx("p",{children:"Choose Barber"}),r.jsx("button",{onClick:()=>h({open:!1,data:{}}),children:r.jsx(F,{})})]}),r.jsxs("div",{className:o.modal_content_container,children:[r.jsx("input",{type:"text",value:T,placeholder:"Choose Barber",readOnly:!0}),O?r.jsx("div",{className:o.barber_dropdown_loading,children:r.jsx(A,{count:3,height:"6rem",style:{marginBottom:"1rem"},baseColor:t?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:t?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):H&&(m==null?void 0:m.length)>0?r.jsx("div",{className:o.barber_dropdown,children:m==null?void 0:m.map(e=>{var n,c;return r.jsxs("div",{className:o.choose_barber_dropdown_item,onClick:()=>{y(e==null?void 0:e.email),C(e==null?void 0:e.name)},style:{borderLeft:e.isOnline?"0.5rem solid limegreen":"0.5rem solid red",outline:w===(e==null?void 0:e.email)?"0.1rem solid rgba(0,0,0,1)":"none"},children:[r.jsxs("div",{children:[r.jsx("img",{src:(c=(n=e==null?void 0:e.profile)==null?void 0:n[0])==null?void 0:c.url,alt:"img"}),r.jsx("div",{className:o.barber_online_dot,style:{backgroundColor:e.isOnline?"limegreen":"red"}})]}),r.jsxs("div",{children:[r.jsx("p",{children:e.name}),r.jsxs("p",{children:["Queue Count : ",e.queueCount]}),r.jsxs("p",{children:["EWT : ",e.barberEWT," mins"]})]})]},e._id)})}):r.jsx("div",{className:o.barber_dropdown_error,children:r.jsx("p",{children:"No barbers available"})})]}),v?r.jsx("button",{style:{display:"grid",placeItems:"center"},children:r.jsx(Z,{})}):r.jsx("button",{onClick:D,children:"Serve"})]})})]})};export{Ae as default};
