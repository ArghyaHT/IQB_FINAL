import{u as Ye,a as Je,b as x,r as s,d as qe,j as e,a4 as Qe,aF as de,C as D,aG as Xe,E as R,N as I,aH as Ze,_,p as ce,cs as et}from"./index-LM_i2ckE.js";import{l as tt,U as nt}from"./libphonenumber-CwkKWUiL.js";import{B as _e}from"./ButtonLoader-BtnBP41U.js";import{b as at,a as ot,c as st,d as it,e as rt,f as lt}from"./BarberProfileAction-D6t0W2hw.js";import{S as dt}from"./Skeleton-D9zihpVu.js";import{M as V}from"./Modal-Csg6tum7.js";import{C as ct}from"./ClickAwayListener-BATV5K82.js";import"./clsx-B-dksMZM.js";import"./index-B-Fco__9.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-BWJB0fH6.js";const _t="_barber_edit_profile_container_wybdk_1",mt="_barber_edit_profile_container_left_wybdk_18",pt="_barber_edit_profile_content_left_wybdk_31",ut="_barber_edit_profile_container_right_wybdk_70",ft="_edit_profile_btn_wybdk_135",ht="_upload_image_container_wybdk_195",bt="_barber_profile_loader_wybdk_240",jt="_profile_skeleton_img_wybdk_250",xt="_barber_edit_email_container_wybdk_256",yt="_barber_verified_icon_wybdk_295",gt="_barber_notverified_icon_wybdk_312",vt="_barber_edit_mobile_container_wybdk_329",wt="_barber_edit_gender_container_wybdk_398",Ct="_modal_container_wybdk_441",kt="_modal_content_container_wybdk_507",St="_edit_modal_btn_wybdk_552",Nt="_modal_common_container_wybdk_587",i={barber_edit_profile_container:_t,barber_edit_profile_container_left:mt,barber_edit_profile_content_left:pt,barber_edit_profile_container_right:ut,edit_profile_btn:ft,upload_image_container:ht,barber_profile_loader:bt,profile_skeleton_img:jt,barber_edit_email_container:xt,barber_verified_icon:yt,barber_notverified_icon:gt,barber_edit_mobile_container:vt,barber_edit_gender_container:wt,modal_container:Ct,modal_content_container:kt,edit_modal_btn:St,modal_common_container:Nt},Tt=()=>{var ne,ae,oe;const d=Ye(),L=Je(),n=x(t=>t.BarberLoggedInMiddleware.entiredata.user[0]),[m,me]=s.useState(n==null?void 0:n.emailVerified),[p,pe]=s.useState(n==null?void 0:n.mobileVerified),[y,ue]=s.useState(n==null?void 0:n.name),[K,fe]=s.useState((ne=n==null?void 0:n.dateOfBirth)==null?void 0:ne.split("T")[0]),A=s.useRef(null),he=()=>{A.current.click()},[be,g]=s.useState(!1),je=async t=>{var ie,re,le;const a=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(a.type)){_.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const se=2*1024*1024;if(a.size>se){_.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const f=new FormData;f.append("email",n==null?void 0:n.email),f.append("profile",a),f.append("salonId",n==null?void 0:n.salonId);try{g(!0);const c=await ce.post("/api/barber/uploadBarberProfilePicture",f,{headers:{"Content-Type":"multipart/form-data"}});g(!1);const{data:He}=await ce.get("/api/barber/barberloggedin");d({type:et,payload:He}),_.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(c){if(g(!1),((ie=c==null?void 0:c.response)==null?void 0:ie.status)===500){_.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}_.error((le=(re=c==null?void 0:c.response)==null?void 0:re.data)==null?void 0:le.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},B=s.useRef(30),U="lastEmailVerificationTime",T=()=>{if(!m){const t=localStorage.getItem(U),a=Math.floor(Date.now()/1e3);if(t&&a-t<B.current){const o=B.current-(a-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(U,a),d(at(n==null?void 0:n.email,j))}},[r,v]=s.useState(["","","",""]),w=s.useRef([]),xe=(t,a)=>{const o=[...r];o[t]=a,a&&t<r.length-1&&w.current[t+1].focus(),v(o)},ye=(t,a)=>{if(a.key==="Backspace"&&t>0&&!r[t]){const o=[...r];o[t-1]="",w.current[t-1].focus(),v(o)}a.key==="Enter"&&H()},G=s.useRef(30),z="lastMobileVerificationTime",P=()=>{if(!p){const t=localStorage.getItem(z),a=Math.floor(Date.now()/1e3);if(t&&a-t<G.current){const o=G.current-(a-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(z,a),d(ot(n==null?void 0:n.email,b))}},[l,C]=s.useState(["","","",""]),k=s.useRef([]),ge=(t,a)=>{const o=[...l];o[t]=a,a&&t<l.length-1&&k.current[t+1].focus(),C(o)},ve=(t,a)=>{if(a.key==="Backspace"&&t>0&&!l[t]){const o=[...l];o[t-1]="",k.current[t-1].focus(),C(o)}a.key==="Enter"&&Y()},[S,we]=s.useState(n==null?void 0:n.gender),[Ce,N]=s.useState(!1),ke=()=>{N(t=>!t)},E=t=>{we(t),N(!1)},[F,Se]=s.useState(`${n==null?void 0:n.mobileCountryCode}${(ae=n==null?void 0:n.mobileNumber)==null?void 0:ae.toString()}`),[Ne,Ee]=s.useState(n==null?void 0:n.mobileCountryCode),[Oe,$]=s.useState(!1),W=()=>{if(Oe)_.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,dateOfBirth:K,mobileNumber:Number(F),countryCode:Number(Ne),name:y,gender:S,password:h};d(st(t,L))}},u=t=>{t.key==="Enter"&&W()},Me=x(t=>t.barberUpdateProfile),{loading:De,resolve:Et}=Me,H=()=>{const t=r==null?void 0:r.join("");d(it(n==null?void 0:n.email,t,j,v,me))},Y=()=>{const t=l==null?void 0:l.join("");d(rt(n==null?void 0:n.email,t,b,C,pe))},[J,Re]=s.useState(""),[h,Ie]=s.useState(""),[q,Ve]=s.useState("");s.useState(!1);const Q=()=>{if(h!==q)_.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:h,oldPassword:J};d(lt(t,L))}},O=t=>{t.key==="Enter"&&Q()},Le=x(t=>t.barberUpdatePassword),{loading:Ke}=Le;x(qe);const[X,Ae]=s.useState(!1),[Z,Be]=s.useState(!1),[ee,Ue]=s.useState(!1),te=tt.PhoneNumberUtil.getInstance(),Te=t=>{try{return te.isValidNumber(te.parseAndKeepRawInput(t))}catch{return!1}},[Ge,ze]=s.useState("gb"),Pe=(t,a)=>{const{country:o,inputValue:se}=a;Te(t)?(Se(t),Ee(o==null?void 0:o.dialCode),ze(o==null?void 0:o.iso2),$(!1)):$(!0)},[Fe,M]=s.useState(!1),[$e,b]=s.useState(!1),[We,j]=s.useState(!1);return e.jsxs("main",{className:i.barber_edit_profile_container,children:[e.jsxs("div",{className:i.barber_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:i.barber_edit_profile_content_left,children:[e.jsxs("div",{children:[be?e.jsx(dt,{variant:"rectangular",className:i.barber_profile_loader}):e.jsx("img",{src:(oe=n==null?void 0:n.profile[0])==null?void 0:oe.url,alt:"profile"}),e.jsx("button",{className:i.upload_image_container,onClick:()=>he(),children:e.jsx(Qe,{})}),e.jsx("input",{type:"file",ref:A,style:{display:"none"},onChange:je})]}),e.jsx("p",{children:y}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:i.barber_edit_profile_container_right,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:y,onChange:t=>ue(t.target.value),onKeyDown:u})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:i.barber_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0,onKeyDown:u}),e.jsx("button",{onClick:()=>T(),className:m?i.barber_verified_icon:i.barber_notverified_icon,title:m?"Verified":"NotVerified",style:{cursor:m?"not-allowed":"pointer"},children:m?e.jsx(de,{}):e.jsx(D,{})})]})]}),e.jsx(V,{open:We,onClose:()=>j(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Xe,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:r.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:o=>w.current[a]=o,onChange:o=>xe(a,o.target.value),onKeyDown:o=>ye(a,o)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>T(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>j(!1),children:"Cancel"}),e.jsx("button",{onClick:H,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>M(!0),readOnly:!0})]}),e.jsx(V,{open:Fe,onClose:()=>M(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>M(!1),children:e.jsx(D,{})})]}),e.jsxs("div",{className:i.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${Z?"text":"password"}`,value:J,onChange:t=>Re(t.target.value),placeholder:"Enter Old Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Be(t=>!t),children:Z?e.jsx(R,{}):e.jsx(I,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${X?"text":"password"}`,value:h,onChange:t=>Ie(t.target.value),placeholder:"Enter New Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Ae(t=>!t),children:X?e.jsx(R,{}):e.jsx(I,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${ee?"text":"password"}`,value:q,onChange:t=>Ve(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Ue(t=>!t),children:ee?e.jsx(R,{}):e.jsx(I,{})})]})]}),e.jsx("button",{className:i.edit_modal_btn,onClick:Q,children:Ke?e.jsx(_e,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:i.barber_edit_mobile_container,children:[e.jsx("div",{onKeyDown:u,children:e.jsx(nt,{forceDialCode:!0,defaultCountry:Ge,value:F,onChange:(t,a)=>Pe(t,a)})}),e.jsx("button",{onClick:()=>P(),className:p?i.barber_verified_icon:i.barber_notverified_icon,title:p?"Verified":"NotVerified",style:{cursor:p?"not-allowed":"pointer"},children:p?e.jsx(de,{}):e.jsx(D,{})})]})]}),e.jsx(V,{open:$e,onClose:()=>b(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Ze,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:l.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:o=>k.current[a]=o,onChange:o=>ge(a,o.target.value),onKeyDown:o=>ve(a,o)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>P(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>b(!1),children:"Cancel"}),e.jsx("button",{onClick:Y,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:K,onChange:t=>fe(t.target.value),onKeyDown:u})]}),e.jsxs("div",{className:i.barber_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${S?`${S}`:""}`,onClick:()=>ke(),readOnly:!0,onKeyDown:u}),Ce&&e.jsx(ct,{onClickAway:()=>N(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>E("Male"),children:"Male"}),e.jsx("p",{onClick:()=>E("Female"),children:"Female"}),e.jsx("p",{onClick:()=>E("Other"),children:"Other"})]})})]}),e.jsx("button",{className:i.edit_profile_btn,onClick:W,children:De?e.jsx(_e,{}):"Save"})]})]})};export{Tt as default};
