import{b as m,u as ue,a as ve,r as l,d as xe,j as n,f as ge,C as G,M as je,_ as J}from"./index-BkrqFLdW.js";import{S as ke}from"./index-CpEv5vGv.js";import{g as ye,c as fe,a as Ce,b as $e,d as Ie,e as Me}from"./BarberAction-Cv-3Z-Z0.js";import{B as Q}from"./ButtonLoader-BCe9awME.js";import{M as U}from"./Modal-CcfTxvKK.js";import"./index-CIaaRRv5.js";import"./clsx-B-dksMZM.js";import"./getReactElementRef-BgpHnz-X.js";const we="_admin_barber_wrapper_lyuqw_1",Be="_barber_send_btn_lyuqw_33",Se="_create_barber_btn_lyuqw_71",Ne="_admin_barber_content_wrapper_lyuqw_117",Ae="_admin_barber_content_body_lyuqw_128",Ee="_admin_barber_content_body_item_lyuqw_239",qe="_barber_online_btn_active_lyuqw_330",Oe="_barber_clock_btn_active_lyuqw_331",De="_barber_online_btn_inactive_lyuqw_342",Ke="_barber_clock_btn_inactive_lyuqw_343",Le="_barber_approve_btn_active_lyuqw_368",He="_barber_approve_btn_inactive_lyuqw_379",Re="_modal_container_lyuqw_392",Pe="_modal_content_container_lyuqw_459",ze="_barber_content_body_error_lyuqw_568",r={admin_barber_wrapper:we,barber_send_btn:Be,create_barber_btn:Se,admin_barber_content_wrapper:Ne,admin_barber_content_body:Ae,admin_barber_content_body_item:Ee,barber_online_btn_active:qe,barber_clock_btn_active:Oe,barber_online_btn_inactive:De,barber_clock_btn_inactive:Ke,barber_approve_btn_active:Le,barber_approve_btn_inactive:He,modal_container:Re,modal_content_container:Pe,barber_content_body_error:ze},en=()=>{const h=m(e=>e.AdminLoggedInMiddleware.adminSalonId),V=m(e=>e.getAdminBarberList),{loading:W,resolve:X,getAllBarbers:s}=V,_=ue(),q=ve(),Y=()=>{q("/admin-barber/createbarber")},Z=e=>{q(`/admin-barber/editbarber/${e.salonId}`,{state:e})};l.useEffect(()=>{if(s&&s.length>0){const e=new Map;s.forEach(a=>{const t=`${a.salonId}-${a.barberId}`;e.set(t,a.isOnline||!1)}),v(e);const o=new Map;s.forEach(a=>{const t=`${a.salonId}-${a.barberId}`;o.set(t,a.isClockedIn||!1)}),I(o)}},[s]);const[u,v]=l.useState(new Map),ee=e=>{v(a=>{const t=new Map(a),c=`${e.salonId}-${e.barberId}`,b=!t.get(c)||!1;return t.set(c,b),t});const o={barberId:e.barberId,salonId:e.salonId,isOnline:!u.get(`${e.salonId}-${e.barberId}`)||!1};_(fe(o,v,e,u.get(`${e.salonId}-${e.barberId}`)))},[x,I]=l.useState(new Map),ne=e=>{I(a=>{const t=new Map(a),c=`${e.salonId}-${e.barberId}`,b=!t.get(c)||!1;return t.set(c,b),t});const o={barberId:e.barberId,salonId:e.salonId,isClockedIn:!x.get(`${e.salonId}-${e.barberId}`)||!1};_(Ce(o,I,e,x.get(`${e.salonId}-${e.barberId}`),v))},M=l.useRef(new AbortController);l.useEffect(()=>{const e=new AbortController;return M.current=e,_(ye(h,e.signal)),()=>{M.current&&M.current.abort()}},[h,_]);const[g,w]=l.useState(new Map);l.useEffect(()=>{if(s){const e=new Map;s.forEach(o=>{const a=`${o.salonId}-${o.email}`;e.set(a,o.isApproved||!1)}),w(e)}},[s]);const ae=e=>{w(a=>{const t=new Map(a),c=`${e.salonId}-${e.email}`,b=!t.get(c)||!1;return t.set(c,b),t});const o={salonId:e.salonId,email:e.email,isApproved:!g.get(`${e.salonId}-${e.email}`)||!1};_($e(o,w,e,g.get(`${e.salonId}-${e.email}`)))},re=m(e=>e.adminApproveBarber),{loading:te,resolve:Fe,response:Te}=re;l.useState(!1);const d=m(xe)==="On",[se,B]=l.useState(!1),[O,S]=l.useState({}),[p,j]=l.useState([]),[D,k]=l.useState([]),[N,y]=l.useState([]),oe=e=>{const o=!O[e._id];S(a=>({...a,[e._id]:o})),o?(j(a=>[...a,e.email]),k(a=>[...a,+`${e==null?void 0:e.mobileCountryCode}${e==null?void 0:e.mobileNumber}`]),y(a=>[...a,e.name]),B(!1)):(j(a=>a.filter(t=>t!==e.email)),k(a=>a.filter(t=>t!==+`${e==null?void 0:e.mobileCountryCode}${e==null?void 0:e.mobileNumber}`)),y(a=>a.filter(t=>t!==e.name)),B(!1))},le=e=>{B(o=>{if(o)j([]),k([]),y([]),S({});else{const a=s.map(i=>i.email),t=s.map(i=>+`${i==null?void 0:i.mobileCountryCode}${i==null?void 0:i.mobileNumber}`),c=s.map(i=>i.name),b=s.reduce((i,he)=>(i[he._id]=!0,i),{});j(a),k(t),y(c),S(b)}return!o})},[ie,f]=l.useState(!1),ce=()=>{p.length>0?f(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},[K,L]=l.useState(""),[H,A]=l.useState(""),R=()=>{_(Ie({subject:K,message:H,role:"Barber",recipientEmails:p},L,A,f))},C=e=>{e.key==="Enter"&&R()},de=m(e=>e.adminSendBarberEmail),{loading:P}=de,[_e,$]=l.useState(!1),[z,be]=l.useState(""),me=()=>{D.length>0?$(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},F=()=>{_(Me({smsBody:z,numbers:D},A,$))},E=e=>{e.key==="Enter"&&F()},pe=m(e=>e.adminSendBarberMessage),{loading:T}=pe;return n.jsxs("div",{className:`${r.admin_barber_wrapper} ${d&&r.dark}`,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Barber List"}),n.jsxs("div",{children:[n.jsx("button",{className:`${r.barber_send_btn} ${d&&r.dark}`,onClick:ce,title:"Email",children:n.jsx("div",{children:n.jsx(ge,{})})}),n.jsx(U,{open:ie,onClose:()=>f(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:r.modal_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Email"}),n.jsx("button",{onClick:()=>f(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:r.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"support@iqueuebarbers.com",readOnly:!0,onKeyDown:C})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:p==null?void 0:p.map(e=>" "+e),onKeyDown:C})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Subject"}),n.jsx("input",{type:"text",placeholder:"Enter Subject",value:K,onChange:e=>L(e.target.value),onKeyDown:C})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:H,onChange:e=>A(e.target.value),onKeyDown:C})]}),P?n.jsx("button",{className:r.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:R,disabled:P,className:r.barber_send_btn,children:"Send"})]})]})}),n.jsx("button",{className:`${r.barber_send_btn} ${d&&r.dark}`,onClick:me,title:"Message",children:n.jsx("div",{children:n.jsx(je,{})})}),n.jsx(U,{open:_e,onClose:()=>$(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:r.modal_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Message"}),n.jsx("button",{onClick:()=>$(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:r.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"iqueuebarbers",readOnly:!0,onKeyDown:E})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:N==null?void 0:N.map(e=>" "+e),onKeyDown:E})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:z,onChange:e=>be(e.target.value),onKeyDown:E})]}),T?n.jsx("button",{className:r.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:F,disabled:T,className:r.barber_send_btn,children:"Send"})]})]})}),n.jsxs("button",{onClick:Y,className:`${r.create_barber_btn}`,disabled:h===0,style:{cursor:h===0?"not-allowed":"cursor"},children:[n.jsx("p",{children:"Create"}),n.jsx("div",{children:"+"})]})]})]}),n.jsx("div",{className:`${r.admin_barber_content_wrapper} ${d&&r.dark}`,children:W?n.jsx("div",{className:r.admin_barber_content_body,children:n.jsx(ke,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:d?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:d?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):X&&(s==null?void 0:s.length)>0?n.jsxs("div",{className:`${r.admin_barber_content_body} ${d&&r.dark}`,children:[n.jsxs("div",{children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",onChange:le,checked:se})}),n.jsx("p",{children:"Name"}),n.jsx("p",{children:"Email"}),n.jsx("div",{children:n.jsx("p",{children:"isOnline"})}),n.jsx("div",{children:n.jsx("p",{children:"isClockIn"})}),n.jsx("div",{children:n.jsx("p",{children:"isApprove"})}),n.jsx("div",{children:n.jsx("p",{children:"Edit"})})]}),s==null?void 0:s.map((e,o)=>n.jsxs("div",{className:r.admin_barber_content_body_item,style:{borderBottom:(s==null?void 0:s.length)-1===o&&"none"},children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",checked:O[e._id]||!1,onChange:()=>oe(e)})}),n.jsx("p",{children:(e==null?void 0:e.name.length)>18?(e==null?void 0:e.name.slice(0,18))+"...":e==null?void 0:e.name}),n.jsx("p",{children:(e==null?void 0:e.email.length)>18?(e==null?void 0:e.email.slice(0,18))+"...":e==null?void 0:e.email}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ee(e),className:u.get(`${e.salonId}-${e.barberId}`)?r.barber_online_btn_active:r.barber_online_btn_inactive,children:u.get(`${e.salonId}-${e.barberId}`)?"Online":"Offline"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ne(e),className:x.get(`${e.salonId}-${e.barberId}`)?r.barber_clock_btn_active:r.barber_clock_btn_inactive,children:x.get(`${e.salonId}-${e.barberId}`)?"Clock-In":"Clock-Out"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ae(e),className:g.get(`${e.salonId}-${e.email}`)?r.barber_approve_btn_active:r.barber_approve_btn_inactive,disabled:!!te,children:g.get(`${e.salonId}-${e.email}`)?"Approved":"Approve"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>Z(e),children:"Edit"})})]},e._id))]}):n.jsx("div",{className:`${r.barber_content_body_error} ${d&&r.dark}`,children:n.jsx("p",{children:"Barbers not available"})})})]})};export{en as default};
