import{a as ft,b as pt,u as C,r as s,d as ht,j as e,a6 as gt,aF as ke,C as B,aG as bt,E as G,N as F,aH as jt,_ as i,z as Ne,aI as xt}from"./index-smej7xwq.js";import{l as vt,U as yt}from"./libphonenumber-PSfFT2tU.js";import{a as wt,b as Ct,c as St,d as kt,e as Nt,f as Et}from"./AdminProfileAction-BoaNKlMP.js";import{B as Ee}from"./ButtonLoader-BLdiC7PJ.js";import{g as Dt,C as Mt}from"./Date-gKmymVnx.js";import{S as Ot}from"./Skeleton-D-WD51In.js";import{M as Y}from"./Modal-CbCgZbhR.js";import{C as De}from"./ClickAwayListener-CmpceTmi.js";import"./clsx-B-dksMZM.js";import"./index-CtLL9ryC.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-CSb6vkGd.js";const zt="_admin_edit_profile_container_15lc0_1",$t="_admin_edit_profile_container_left_15lc0_18",It="_admin_edit_profile_content_left_15lc0_31",Rt="_admin_edit_profile_container_right_15lc0_37",Vt="_edit_profile_btn_15lc0_72",Pt="_upload_image_container_15lc0_132",At="_admin_profile_loader_15lc0_172",Lt="_profile_skeleton_img_15lc0_182",Tt="_admin_edit_email_container_15lc0_188",Kt="_admin_verified_icon_15lc0_227",Ut="_admin_notverified_icon_15lc0_244",Bt="_admin_edit_mobile_container_15lc0_261",Gt="_admin_edit_gender_container_15lc0_330",Ft="_modal_container_15lc0_373",Yt="_modal_content_container_15lc0_439",Wt="_edit_modal_btn_15lc0_484",Ht="_modal_common_container_15lc0_519",qt="_error_message_15lc0_652",Jt="_calender_container_15lc0_658",Qt="_calender_drop_container_15lc0_662",Xt="_dark_15lc0_671",a={admin_edit_profile_container:zt,admin_edit_profile_container_left:$t,admin_edit_profile_content_left:It,admin_edit_profile_container_right:Rt,edit_profile_btn:Vt,upload_image_container:Pt,admin_profile_loader:At,profile_skeleton_img:Lt,admin_edit_email_container:Tt,admin_verified_icon:Kt,admin_notverified_icon:Ut,admin_edit_mobile_container:Bt,admin_edit_gender_container:Gt,modal_container:Ft,modal_content_container:Yt,edit_modal_btn:Wt,modal_common_container:Ht,error_message:qt,calender_container:Jt,calender_drop_container:Qt,dark:Xt},_n=()=>{var ye;const _=ft(),W=pt(),n=C(t=>t.AdminLoggedInMiddleware.entiredata.user[0]),[h,Me]=s.useState(n==null?void 0:n.emailVerified),[g,Oe]=s.useState(n==null?void 0:n.mobileVerified),[d,H]=s.useState(""),[S,k]=s.useState(""),[N,q]=s.useState(""),[J,Q]=s.useState(""),[ze,X]=s.useState("");s.useEffect(()=>{var t,r,o,f;n&&(Q(`${(t=n==null?void 0:n.mobileCountryCode)==null?void 0:t.toString()}${(r=n==null?void 0:n.mobileNumber)==null?void 0:r.toString()}`),H(n==null?void 0:n.name),k((o=n==null?void 0:n.dateOfBirth)==null?void 0:o.split("T")[0]),q(n==null?void 0:n.gender),X((f=n==null?void 0:n.mobileCountryCode)==null?void 0:f.toString()))},[n]);const Z=s.useRef(null),$e=()=>{Z.current.click()},[Ie,E]=s.useState(!1),Re=async t=>{var we,Ce,Se;const r=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(r.type)){i.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const f=2*1024*1024;if(r.size>f){i.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const p=new FormData;p.append("email",n==null?void 0:n.email),p.append("profile",r),p.append("salonId",n==null?void 0:n.salonId);try{E(!0),await Ne.post("/api/admin/uploadAdminProfilePicture",p,{headers:{"Content-Type":"multipart/form-data"}}),E(!1);const{data:u}=await Ne.get("/api/admin/adminloggedin");_({type:xt,payload:u}),i.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(u){if(E(!1),((we=u==null?void 0:u.response)==null?void 0:we.status)===500){i.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}i.error((Se=(Ce=u==null?void 0:u.response)==null?void 0:Ce.data)==null?void 0:Se.message,{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},ee=s.useRef(30),te="lastEmailVerificationTime",ne=()=>{if(!h){const t=localStorage.getItem(te),r=Math.floor(Date.now()/1e3);if(t&&r-t<ee.current){const o=ee.current-(r-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(te,r),_(wt(n==null?void 0:n.email,w))}},[c,D]=s.useState(["","","",""]),M=s.useRef([]),Ve=(t,r)=>{const o=[...c];o[t]=r,r&&t<c.length-1&&M.current[t+1].focus(),D(o)},Pe=(t,r)=>{if(r.key==="Backspace"&&t>0&&!c[t]){const o=[...c];o[t-1]="",M.current[t-1].focus(),D(o)}r.key==="Enter"&&ce()},re=s.useRef(30),oe="lastMobileVerificationTime",se=()=>{if(!g){const t=localStorage.getItem(oe),r=Math.floor(Date.now()/1e3);if(t&&r-t<re.current){const o=re.current-(r-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(oe,r),_(Ct(n==null?void 0:n.email,y))}},[m,O]=s.useState(["","","",""]),z=s.useRef([]),Ae=(t,r)=>{const o=[...m];o[t]=r,r&&t<m.length-1&&z.current[t+1].focus(),O(o)},Le=(t,r)=>{if(r.key==="Backspace"&&t>0&&!m[t]){const o=[...m];o[t-1]="",z.current[t-1].focus(),O(o)}r.key==="Enter"&&me()},[Te,$]=s.useState(!1),Ke=()=>{$(t=>!t)},I=t=>{q(t),$(!1)},[Ue,R]=s.useState(!1),[ae,ie]=s.useState(""),[le,Be]=s.useState(""),de=()=>{if(d.length===0||d.length>20)return i.error("Name must be between 1 to 20 characters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),ie("Name must be between 1 to 20 characters");if(Ue)return i.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),Be("Invalid Number");const t={email:n==null?void 0:n.email,dateOfBirth:S,mobileNumber:Number(J),countryCode:Number(ze),name:d,gender:N};_(St(t,W))},j=t=>{t.key==="Enter"&&de()},V=t=>{t.key==="Enter"&&he()},ce=()=>{const t=c==null?void 0:c.join("");_(kt(n==null?void 0:n.email,t,w,D,Me))},me=()=>{const t=m==null?void 0:m.join("");_(Nt(n==null?void 0:n.email,t,y,O,Oe))},[x,Ge]=s.useState(""),[b,Fe]=s.useState(""),[v,Ye]=s.useState(""),We=C(t=>t.adminUpdateProfile),{loading:He}=We,[ue,P]=s.useState(""),[_e,A]=s.useState(""),[fe,L]=s.useState(""),[pe,T]=s.useState(""),he=()=>{if(!x)return i.error("Please enter password",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),P("Please enter old password");if(x.length<8)return i.error("Password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),P("Old password length must be 8 charecters");if(!b)return i.error("Please enter password",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),A("Please enter new password");if(b.length<8)return i.error("Password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),A("New password length must be 8 charecters");if(!v)return i.error("Please enter confirm password",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),L("Please enter confirm password");if(v.length<8)return i.error("Confirm password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),L("Confirm password length must be 8 charecters");if(b!==v)return i.error("Password and confirm password do not match",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),T("Password and confirm password do not match");const t={email:n==null?void 0:n.email,password:b,oldPassword:x};_(Et(t,W))},qe=C(t=>t.adminUpdatePassword),{loading:Je}=qe,l=C(ht)==="On",[ge,Qe]=s.useState(!1),[be,Xe]=s.useState(!1),[je,Ze]=s.useState(!1),xe=vt.PhoneNumberUtil.getInstance(),et=t=>{try{return xe.isValidNumber(xe.parseAndKeepRawInput(t))}catch{return!1}},[tt,nt]=s.useState("gb"),rt=(t,r)=>{R("");const{country:o,inputValue:f}=r;et(t)?(Q(t),X(o==null?void 0:o.dialCode),nt(o==null?void 0:o.iso2),R(!1)):R(!0)},[ot,K]=s.useState(!1),[st,y]=s.useState(!1),[at,w]=s.useState(!1);s.useEffect(()=>{const t=document.querySelector(".react-international-phone-input-container .react-international-phone-input");t&&(t.style.color=l?"var(--light-color-4)":"var(--light-color-2)")},[l]);const[it,U]=s.useState(!1),lt=()=>{U(!1)},[dt,ct]=s.useState(new Date),mt=t=>{const r=new Date(t),o=r.getFullYear(),f=String(r.getMonth()+1).padStart(2,"0"),p=String(r.getDate()).padStart(2,"0");return`${o}-${f}-${p}`},ut=t=>{const r=mt(t);ct(r),k(r),U(!1)},[_t,ve]=s.useState(!1);return s.useEffect(()=>{const t=()=>{window.innerWidth<=576?ve(!0):ve(!1)};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),e.jsxs("main",{className:`${a.admin_edit_profile_container} ${l&&a.dark}`,children:[e.jsxs("div",{className:a.admin_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:`${a.admin_edit_profile_content_left} ${l&&a.dark}`,children:[e.jsxs("div",{children:[Ie?e.jsx(Ot,{variant:"rectangular",className:a.admin_profile_loader,style:{backgroundColor:!1}}):e.jsx("img",{src:(ye=n==null?void 0:n.profile[0])==null?void 0:ye.url,alt:"profile"}),e.jsx("button",{className:a.upload_image_container,onClick:()=>$e(),children:e.jsx(gt,{})}),e.jsx("input",{type:"file",ref:Z,style:{display:"none"},onChange:Re})]}),e.jsx("p",{children:(d==null?void 0:d.length)>20?`${d.slice(0,20)}...`:d}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:`${a.admin_edit_profile_container_right}  ${l&&a.dark}`,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:d,onChange:t=>{ie(""),H(t.target.value)},onKeyDown:j,style:{border:ae?"0.1rem solid red":"none"}}),e.jsx("p",{className:a.error_message,children:ae})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:`${a.admin_edit_email_container} ${l&&a.dark}`,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0}),e.jsx("button",{onClick:()=>ne(),className:h?a.admin_verified_icon:a.admin_notverified_icon,title:h?"Verified":"NotVerified",style:{cursor:h?"not-allowed":"pointer"},children:h?e.jsx(ke,{}):e.jsx(B,{})})]})]}),e.jsx(Y,{open:at,onClose:()=>w(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:`${a.modal_common_container} ${l&&a.dark}`,children:[e.jsx("div",{children:e.jsx(bt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:c.map((t,r)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:r===0,ref:o=>M.current[r]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Ve(r,o.target.value)},onKeyDown:o=>Pe(r,o)},r))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>ne(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>w(!1),children:"Cancel"}),e.jsx("button",{onClick:ce,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>K(!0),readOnly:!0})]}),e.jsx(Y,{open:ot,onClose:()=>K(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:`${a.modal_container} ${l&&a.dark}`,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>K(!1),children:e.jsx(B,{})})]}),e.jsxs("div",{className:a.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{style:{border:ue?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${be?"text":"password"}`,value:x,onChange:t=>{P(""),Ge(t.target.value)},placeholder:"Enter Old Password",onKeyDown:V}),e.jsx("div",{onClick:()=>Xe(t=>!t),children:be?e.jsx(G,{}):e.jsx(F,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:ue})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{style:{border:_e?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${ge?"text":"password"}`,value:b,onChange:t=>{T(""),A(""),Fe(t.target.value)},placeholder:"Enter New Password",onKeyDown:V}),e.jsx("div",{onClick:()=>Qe(t=>!t),children:ge?e.jsx(G,{}):e.jsx(F,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:_e})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{style:{border:fe||pe?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${je?"text":"password"}`,value:v,onChange:t=>{T(""),L(""),Ye(t.target.value)},placeholder:"Enter Confirm Password",onKeyDown:V}),e.jsx("div",{onClick:()=>Ze(t=>!t),children:je?e.jsx(G,{}):e.jsx(F,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:fe||pe})]}),e.jsx("button",{className:a.edit_modal_btn,onClick:he,children:Je?e.jsx(Ee,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:`${a.admin_edit_mobile_container} ${l&&a.dark}`,style:{outline:le&&"0.1rem solid red"},children:[e.jsx("div",{onKeyDown:j,children:e.jsx(yt,{forceDialCode:!0,defaultCountry:tt,value:J,onChange:(t,r)=>rt(t,r)})}),e.jsx("button",{onClick:()=>se(),className:g?a.admin_verified_icon:a.admin_notverified_icon,title:g?"Verified":"NotVerified",style:{cursor:g?"not-allowed":"pointer"},children:g?e.jsx(ke,{}):e.jsx(B,{})})]}),e.jsx("p",{className:a.error_message,children:le})]}),e.jsx(Y,{open:st,onClose:()=>y(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:`${a.modal_common_container} ${l&&a.dark}`,children:[e.jsx("div",{children:e.jsx(jt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:m.map((t,r)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:r===0,ref:o=>z.current[r]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Ae(r,o.target.value)},onKeyDown:o=>Le(r,o)},r))}),e.jsxs("p",{children:["Didn't get the code ?",e.jsx("span",{onClick:()=>se(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>y(!1),children:"Cancel"}),e.jsx("button",{onClick:me,children:"Verify"})]})]})]})}),_t?e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:S,onChange:t=>k(t.target.value),onKeyDown:j,max:Dt(),style:{colorScheme:l?"dark":"light"}})]}):e.jsxs("div",{className:a.calender_container,children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"text",placeholder:"Select Date",value:S,onClick:()=>U(!0),readOnly:!0}),it&&e.jsx(De,{onClickAway:lt,children:e.jsx("div",{className:a.calender_drop_container,children:e.jsx(Mt,{onChange:ut,value:dt,maxDate:new Date})})})]}),e.jsxs("div",{className:`${a.admin_edit_gender_container} ${l&&a.dark}`,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${N?`${N}`:""}`,onClick:()=>Ke(),readOnly:!0,onKeyDown:j}),Te&&e.jsx(De,{onClickAway:()=>$(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>I("Male"),children:"Male"}),e.jsx("p",{onClick:()=>I("Female"),children:"Female"}),e.jsx("p",{onClick:()=>I("Other"),children:"Other"})]})})]}),e.jsx("button",{className:a.edit_profile_btn,onClick:de,children:He?e.jsx(Ee,{}):"Save"})]})]})};export{_n as default};
