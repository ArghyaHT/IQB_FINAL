import{b as p,u as pe,a as xe,r as i,d as ve,j as n,f as ge,C as G,M as je,_ as J}from"./index-DC23I7Q_.js";import{S as ye}from"./index-B0iQmoiR.js";import{g as fe,c as ke,a as $e,b as Ce,d as Ie,e as we}from"./BarberAction-C_vx6vhI.js";import{B as Q}from"./ButtonLoader-B3ZoPDtn.js";import{M as U}from"./Modal-DMFaHk-M.js";import"./index-CTLnQDG_.js";import"./clsx-B-dksMZM.js";import"./getReactElementRef-DLKzxl5X.js";const Se="_admin_barber_wrapper_lyuqw_1",Ne="_barber_send_btn_lyuqw_33",Ae="_create_barber_btn_lyuqw_71",Be="_admin_barber_content_wrapper_lyuqw_117",Ee="_admin_barber_content_body_lyuqw_128",Me="_admin_barber_content_body_item_lyuqw_239",qe="_barber_online_btn_active_lyuqw_330",Oe="_barber_clock_btn_active_lyuqw_331",De="_barber_online_btn_inactive_lyuqw_342",Ke="_barber_clock_btn_inactive_lyuqw_343",Le="_barber_approve_btn_active_lyuqw_368",He="_barber_approve_btn_inactive_lyuqw_379",Re="_modal_container_lyuqw_392",Pe="_modal_content_container_lyuqw_459",ze="_barber_content_body_error_lyuqw_568",t={admin_barber_wrapper:Se,barber_send_btn:Ne,create_barber_btn:Ae,admin_barber_content_wrapper:Be,admin_barber_content_body:Ee,admin_barber_content_body_item:Me,barber_online_btn_active:qe,barber_clock_btn_active:Oe,barber_online_btn_inactive:De,barber_clock_btn_inactive:Ke,barber_approve_btn_active:Le,barber_approve_btn_inactive:He,modal_container:Re,modal_content_container:Pe,barber_content_body_error:ze},en=()=>{const g=p(e=>e.AdminLoggedInMiddleware.adminSalonId),V=p(e=>e.getAdminBarberList),{loading:W,resolve:X,getAllBarbers:r}=V,u=pe(),q=xe(),Y=()=>{q("/admin-barber/createbarber")},Z=e=>{q(`/admin-barber/editbarber/${e.salonId}`,{state:e})};i.useEffect(()=>{if(r&&r.length>0){const e=new Map;r.forEach(a=>{const s=`${a.salonId}-${a.barberId}`;e.set(s,a.isOnline||!1)}),x(e);const o=new Map;r.forEach(a=>{const s=`${a.salonId}-${a.barberId}`;o.set(s,a.isClockedIn||!1)}),j(o)}},[r]);const[d,x]=i.useState(new Map),ee=e=>{x(a=>{const s=new Map(a),m=`${e.salonId}-${e.barberId}`,h=!s.get(m)||!1;return s.set(m,h),s});const o={barberId:e.barberId,salonId:e.salonId,isOnline:!(d!=null&&d.get(`${e.salonId}-${e.barberId}`))||!1};u(ke(o,x,e,d==null?void 0:d.get(`${e.salonId}-${e.barberId}`)))},[c,j]=i.useState(new Map),ne=e=>{j(a=>{const s=new Map(a),m=`${e.salonId}-${e.barberId}`,h=!s.get(m)||!1;return s.set(m,h),s});const o={barberId:e.barberId,salonId:e.salonId,isClockedIn:!(c!=null&&c.get(`${e.salonId}-${e.barberId}`))||!1};u($e(o,j,e,c==null?void 0:c.get(`${e.salonId}-${e.barberId}`),x))},w=i.useRef(new AbortController);i.useEffect(()=>{const e=new AbortController;return w.current=e,u(fe(g,e.signal)),()=>{w.current&&w.current.abort()}},[g,u]);const[_,S]=i.useState(new Map);i.useEffect(()=>{if(r){const e=new Map;r.forEach(o=>{const a=`${o.salonId}-${o.email}`;e.set(a,o.isApproved||!1)}),S(e)}},[r]);const ae=e=>{S(a=>{const s=new Map(a),m=`${e.salonId}-${e.email}`,h=!s.get(m)||!1;return s.set(m,h),s});const o={salonId:e.salonId,email:e.email,isApproved:!(_!=null&&_.get(`${e.salonId}-${e.email}`))||!1};u(Ce(o,S,e,_==null?void 0:_.get(`${e.salonId}-${e.email}`),x,j))},te=p(e=>e.adminApproveBarber),{loading:se,resolve:Fe,response:Te}=te;i.useState(!1);const b=p(ve)==="On",[re,N]=i.useState(!1),[O,A]=i.useState({}),[v,y]=i.useState([]),[D,f]=i.useState([]),[B,k]=i.useState([]),oe=e=>{const o=!O[e._id];A(a=>({...a,[e._id]:o})),o?(y(a=>[...a,e.email]),f(a=>[...a,+`${e==null?void 0:e.mobileCountryCode}${e==null?void 0:e.mobileNumber}`]),k(a=>[...a,e.name]),N(!1)):(y(a=>a.filter(s=>s!==e.email)),f(a=>a.filter(s=>s!==+`${e==null?void 0:e.mobileCountryCode}${e==null?void 0:e.mobileNumber}`)),k(a=>a.filter(s=>s!==e.name)),N(!1))},ie=e=>{N(o=>{if(o)y([]),f([]),k([]),A({});else{const a=r.map(l=>l.email),s=r.map(l=>+`${l==null?void 0:l.mobileCountryCode}${l==null?void 0:l.mobileNumber}`),m=r.map(l=>l.name),h=r.reduce((l,he)=>(l[he._id]=!0,l),{});y(a),f(s),k(m),A(h)}return!o})},[le,$]=i.useState(!1),de=()=>{v.length>0?$(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},[K,L]=i.useState(""),[H,E]=i.useState(""),R=()=>{u(Ie({subject:K,message:H,role:"Barber",recipientEmails:v},L,E,$))},C=e=>{e.key==="Enter"&&R()},ce=p(e=>e.adminSendBarberEmail),{loading:P}=ce,[_e,I]=i.useState(!1),[z,me]=i.useState(""),be=()=>{D.length>0?I(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},F=()=>{u(we({smsBody:z,numbers:D},E,I))},M=e=>{e.key==="Enter"&&F()},ue=p(e=>e.adminSendBarberMessage),{loading:T}=ue;return n.jsxs("div",{className:`${t.admin_barber_wrapper} ${b&&t.dark}`,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Barber List"}),n.jsxs("div",{children:[n.jsx("button",{className:`${t.barber_send_btn} ${b&&t.dark}`,onClick:de,title:"Email",children:n.jsx("div",{children:n.jsx(ge,{})})}),n.jsx(U,{open:le,onClose:()=>$(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:t.modal_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Email"}),n.jsx("button",{onClick:()=>$(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:t.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"support@iqueuebarbers.com",readOnly:!0,onKeyDown:C})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:v==null?void 0:v.map(e=>" "+e),onKeyDown:C})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Subject"}),n.jsx("input",{type:"text",placeholder:"Enter Subject",value:K,onChange:e=>L(e.target.value),onKeyDown:C})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:H,onChange:e=>E(e.target.value),onKeyDown:C})]}),P?n.jsx("button",{className:t.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:R,disabled:P,className:t.barber_send_btn,children:"Send"})]})]})}),n.jsx("button",{className:`${t.barber_send_btn} ${b&&t.dark}`,onClick:be,title:"Message",children:n.jsx("div",{children:n.jsx(je,{})})}),n.jsx(U,{open:_e,onClose:()=>I(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:t.modal_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Message"}),n.jsx("button",{onClick:()=>I(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:t.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"iqueuebarbers",readOnly:!0,onKeyDown:M})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:B==null?void 0:B.map(e=>" "+e),onKeyDown:M})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:z,onChange:e=>me(e.target.value),onKeyDown:M})]}),T?n.jsx("button",{className:t.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:F,disabled:T,className:t.barber_send_btn,children:"Send"})]})]})}),n.jsxs("button",{onClick:Y,className:`${t.create_barber_btn}`,disabled:g===0,style:{cursor:g===0?"not-allowed":"cursor"},children:[n.jsx("p",{children:"Create"}),n.jsx("div",{children:"+"})]})]})]}),n.jsx("div",{className:`${t.admin_barber_content_wrapper} ${b&&t.dark}`,children:W?n.jsx("div",{className:t.admin_barber_content_body,children:n.jsx(ye,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:b?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:b?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):X&&(r==null?void 0:r.length)>0?n.jsxs("div",{className:`${t.admin_barber_content_body} ${b&&t.dark}`,children:[n.jsxs("div",{children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",onChange:ie,checked:re})}),n.jsx("p",{children:"Name"}),n.jsx("p",{children:"Email"}),n.jsx("div",{children:n.jsx("p",{children:"isOnline"})}),n.jsx("div",{children:n.jsx("p",{children:"isClockIn"})}),n.jsx("div",{children:n.jsx("p",{children:"isApprove"})}),n.jsx("div",{children:n.jsx("p",{children:"Edit"})})]}),r==null?void 0:r.map((e,o)=>n.jsxs("div",{className:t.admin_barber_content_body_item,style:{borderBottom:(r==null?void 0:r.length)-1===o&&"none"},children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",checked:O[e._id]||!1,onChange:()=>oe(e)})}),n.jsx("p",{children:(e==null?void 0:e.name.length)>18?(e==null?void 0:e.name.slice(0,18))+"...":e==null?void 0:e.name}),n.jsx("p",{children:(e==null?void 0:e.email.length)>18?(e==null?void 0:e.email.slice(0,18))+"...":e==null?void 0:e.email}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ee(e),className:d!=null&&d.get(`${e.salonId}-${e.barberId}`)?t.barber_online_btn_active:t.barber_online_btn_inactive,children:d!=null&&d.get(`${e.salonId}-${e.barberId}`)?"Online":"Offline"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ne(e),className:c!=null&&c.get(`${e.salonId}-${e.barberId}`)?t.barber_clock_btn_active:t.barber_clock_btn_inactive,children:c!=null&&c.get(`${e.salonId}-${e.barberId}`)?"Clock-In":"Clock-Out"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ae(e),className:_!=null&&_.get(`${e.salonId}-${e.email}`)?t.barber_approve_btn_active:t.barber_approve_btn_inactive,disabled:!!se,children:_!=null&&_.get(`${e.salonId}-${e.email}`)?"Approved":"Approve"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>Z(e),children:"Edit"})})]},e._id))]}):n.jsx("div",{className:`${t.barber_content_body_error} ${b&&t.dark}`,children:n.jsx("p",{children:"Barbers not available"})})})]})};export{en as default};
