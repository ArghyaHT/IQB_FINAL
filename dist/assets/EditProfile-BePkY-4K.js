import{u as We,a as He,b as x,r as o,d as Te,j as e,a4 as Je,aF as oe,C as D,aG as Ye,E as V,N as I,aI as ie,aH as qe,_,p as re,ct as Qe}from"./index-C3TY6eP5.js";import{l as Xe,U as Ze}from"./libphonenumber-CYhqk7U_.js";import{B as le}from"./ButtonLoader-CnN44FQg.js";import{b as et,a as tt,c as nt,d as at,e as st,f as ot}from"./BarberProfileAction-DoTEpHgb.js";import{S as it}from"./Skeleton-BAC4omRO.js";import{M as R}from"./Modal-CEY2O6pz.js";import{C as rt}from"./ClickAwayListener-BObowlFx.js";import"./clsx-B-dksMZM.js";import"./index-Dc-okjhy.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-D3d6m9vV.js";const lt="_barber_edit_profile_container_hkyht_1",dt="_barber_edit_profile_container_left_hkyht_18",ct="_barber_edit_profile_content_left_hkyht_31",_t="_barber_edit_profile_container_right_hkyht_70",pt="_edit_profile_btn_hkyht_135",mt="_upload_image_container_hkyht_211",ht="_barber_profile_loader_hkyht_256",ut="_profile_skeleton_img_hkyht_266",ft="_barber_edit_email_container_hkyht_272",bt="_barber_verified_icon_hkyht_311",jt="_barber_notverified_icon_hkyht_328",xt="_barber_edit_mobile_container_hkyht_345",yt="_barber_edit_gender_container_hkyht_414",gt="_modal_container_hkyht_457",vt="_modal_content_container_hkyht_523",Ct="_edit_modal_btn_hkyht_568",kt="_modal_common_container_hkyht_603",i={barber_edit_profile_container:lt,barber_edit_profile_container_left:dt,barber_edit_profile_content_left:ct,barber_edit_profile_container_right:_t,edit_profile_btn:pt,upload_image_container:mt,barber_profile_loader:ht,profile_skeleton_img:ut,barber_edit_email_container:ft,barber_verified_icon:bt,barber_notverified_icon:jt,barber_edit_mobile_container:xt,barber_edit_gender_container:yt,modal_container:gt,modal_content_container:vt,edit_modal_btn:Ct,modal_common_container:kt},Kt=()=>{var X,Z,ee;const d=We(),B=He(),n=x(t=>t.BarberLoggedInMiddleware.entiredata.user[0]),[p,de]=o.useState(n==null?void 0:n.emailVerified),[m,ce]=o.useState(n==null?void 0:n.mobileVerified),[y,_e]=o.useState(n==null?void 0:n.name),[U,pe]=o.useState((X=n==null?void 0:n.dateOfBirth)==null?void 0:X.split("T")[0]),K=o.useRef(null),me=()=>{K.current.click()},[he,g]=o.useState(!1),ue=async t=>{var ne,ae,se;const a=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(a.type)){_.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const te=2*1024*1024;if(a.size>te){_.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const h=new FormData;h.append("email",n==null?void 0:n.email),h.append("profile",a),h.append("salonId",n==null?void 0:n.salonId);try{g(!0);const c=await re.post("/api/barber/uploadBarberProfilePicture",h,{headers:{"Content-Type":"multipart/form-data"}});g(!1);const{data:$e}=await re.get("/api/barber/barberloggedin");d({type:Qe,payload:$e}),_.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(c){if(g(!1),((ne=c==null?void 0:c.response)==null?void 0:ne.status)===500){_.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}_.error((se=(ae=c==null?void 0:c.response)==null?void 0:ae.data)==null?void 0:se.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},L=()=>{p||d(et(n==null?void 0:n.email,j))},[r,v]=o.useState(["","","",""]),C=o.useRef([]),fe=(t,a)=>{const s=[...r];s[t]=a,a&&t<r.length-1&&C.current[t+1].focus(),v(s)},be=(t,a)=>{if(a.key==="Backspace"&&t>0&&!r[t]){const s=[...r];s[t-1]="",C.current[t-1].focus(),v(s)}a.key==="Enter"&&P()},A=()=>{m||d(tt(n==null?void 0:n.email,b))},[l,k]=o.useState(["","","",""]),w=o.useRef([]),je=(t,a)=>{const s=[...l];s[t]=a,a&&t<l.length-1&&w.current[t+1].focus(),k(s)},xe=(t,a)=>{if(a.key==="Backspace"&&t>0&&!l[t]){const s=[...l];s[t-1]="",w.current[t-1].focus(),k(s)}a.key==="Enter"&&$()},[S,ye]=o.useState(n==null?void 0:n.gender),[ge,N]=o.useState(!1),ve=()=>{N(t=>!t)},E=t=>{ye(t),N(!1)},[F,Ce]=o.useState(`${n==null?void 0:n.mobileCountryCode}${(Z=n==null?void 0:n.mobileNumber)==null?void 0:Z.toString()}`),[ke,we]=o.useState(n==null?void 0:n.mobileCountryCode),[Se,z]=o.useState(!1),G=()=>{if(Se)_.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,dateOfBirth:U,mobileNumber:Number(F),countryCode:Number(ke),name:y,gender:S,password:f};d(nt(t,B))}},u=t=>{t.key==="Enter"&&G()},Ne=x(t=>t.barberUpdateProfile),{loading:Ee,resolve:wt}=Ne,P=()=>{const t=r==null?void 0:r.join("");d(at(n==null?void 0:n.email,t,j,v,de))},$=()=>{const t=l==null?void 0:l.join("");d(st(n==null?void 0:n.email,t,b,k,ce))},[W,Oe]=o.useState(""),[f,Me]=o.useState(""),[H,De]=o.useState("");o.useState(!1);const T=()=>{if(f!==H)_.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:f,oldPassword:W};d(ot(t,B))}},O=t=>{t.key==="Enter"&&T()},Ve=x(t=>t.barberUpdatePassword),{loading:Ie}=Ve;x(Te);const[J,Re]=o.useState(!1),[Y,Be]=o.useState(!1),[q,Ue]=o.useState(!1),Q=Xe.PhoneNumberUtil.getInstance(),Ke=t=>{try{return Q.isValidNumber(Q.parseAndKeepRawInput(t))}catch{return!1}},[Le,Ae]=o.useState("gb"),Fe=(t,a)=>{const{country:s,inputValue:te}=a;Ke(t)?(Ce(t),we(s==null?void 0:s.dialCode),Ae(s==null?void 0:s.iso2),z(!1)):z(!0)},[ze,M]=o.useState(!1),[Ge,b]=o.useState(!1),[Pe,j]=o.useState(!1);return e.jsxs("main",{className:i.barber_edit_profile_container,children:[e.jsxs("div",{className:i.barber_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:i.barber_edit_profile_content_left,children:[e.jsxs("div",{children:[he?e.jsx(it,{variant:"rectangular",className:i.barber_profile_loader}):e.jsx("img",{src:(ee=n==null?void 0:n.profile[0])==null?void 0:ee.url,alt:"profile"}),e.jsx("button",{className:i.upload_image_container,onClick:()=>me(),children:e.jsx(Je,{})}),e.jsx("input",{type:"file",ref:K,style:{display:"none"},onChange:ue})]}),e.jsx("p",{children:y}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:i.barber_edit_profile_container_right,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:y,onChange:t=>_e(t.target.value),onKeyDown:u})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:i.barber_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0,onKeyDown:u}),e.jsx("button",{onClick:()=>L(),className:p?i.barber_verified_icon:i.barber_notverified_icon,title:p?"Verified":"NotVerified",style:{cursor:p?"not-allowed":"pointer"},children:p?e.jsx(oe,{}):e.jsx(D,{})})]})]}),e.jsx(R,{open:Pe,onClose:()=>j(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Ye,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:r.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:s=>C.current[a]=s,onChange:s=>fe(a,s.target.value),onKeyDown:s=>be(a,s)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>L(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>j(!1),children:"Cancel"}),e.jsx("button",{onClick:P,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>M(!0),readOnly:!0})]}),e.jsx(R,{open:ze,onClose:()=>M(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>M(!1),children:e.jsx(D,{})})]}),e.jsxs("div",{className:i.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${Y?"text":"password"}`,value:W,onChange:t=>Oe(t.target.value),placeholder:"Enter Old Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Be(t=>!t),children:Y?e.jsx(V,{}):e.jsx(I,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${J?"text":"password"}`,value:f,onChange:t=>Me(t.target.value),placeholder:"Enter New Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Re(t=>!t),children:J?e.jsx(V,{}):e.jsx(I,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${q?"text":"password"}`,value:H,onChange:t=>De(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Ue(t=>!t),children:q?e.jsx(V,{}):e.jsx(I,{})})]})]}),e.jsx("button",{className:i.edit_modal_btn,onClick:T,children:Ie?e.jsx(le,{}):e.jsxs(e.Fragment,{children:[e.jsx("p",{style:{color:"#0866ff"},children:"Save"}),e.jsx("div",{children:e.jsx(ie,{})})]})})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:i.barber_edit_mobile_container,children:[e.jsx("div",{children:e.jsx(Ze,{forceDialCode:!0,defaultCountry:Le,value:F,onChange:(t,a)=>Fe(t,a)})}),e.jsx("button",{onClick:()=>A(),className:m?i.barber_verified_icon:i.barber_notverified_icon,title:m?"Verified":"NotVerified",style:{cursor:m?"not-allowed":"pointer"},children:m?e.jsx(oe,{}):e.jsx(D,{})})]})]}),e.jsx(R,{open:Ge,onClose:()=>b(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(qe,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:l.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:s=>w.current[a]=s,onChange:s=>je(a,s.target.value),onKeyDown:s=>xe(a,s)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>A(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>b(!1),children:"Cancel"}),e.jsx("button",{onClick:$,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:U,onChange:t=>pe(t.target.value),onKeyDown:u})]}),e.jsxs("div",{className:i.barber_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${S?`${S}`:""}`,onClick:()=>ve(),readOnly:!0,onKeyDown:u}),ge&&e.jsx(rt,{onClickAway:()=>N(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>E("Male"),children:"Male"}),e.jsx("p",{onClick:()=>E("Female"),children:"Female"}),e.jsx("p",{onClick:()=>E("Other"),children:"Other"})]})})]}),e.jsx("button",{className:i.edit_profile_btn,onClick:G,children:Ee?e.jsx(le,{}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Save"}),e.jsx("div",{children:e.jsx(ie,{})})]})})]})]})};export{Kt as default};
