import{u as $e,a as We,b as x,r as s,d as He,j as e,a4 as Te,aF as se,C as M,aG as Je,E as V,N as I,aH as Ye,_,p as ie,cs as qe}from"./index-DoPeqlwO.js";import{l as Qe,U as Xe}from"./libphonenumber-DD1OFVFq.js";import{B as re}from"./ButtonLoader-XkGrsuR2.js";import{b as Ze,a as et,c as tt,d as nt,e as at,f as ot}from"./BarberProfileAction-Bh2yKKlf.js";import{S as st}from"./Skeleton-BJCyXYAZ.js";import{M as R}from"./Modal-fN4Jvzzt.js";import{C as it}from"./ClickAwayListener-aiRbFj22.js";import"./clsx-B-dksMZM.js";import"./index-CMeGkAow.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-DHZxZ94R.js";const rt="_barber_edit_profile_container_wybdk_1",lt="_barber_edit_profile_container_left_wybdk_18",dt="_barber_edit_profile_content_left_wybdk_31",ct="_barber_edit_profile_container_right_wybdk_70",_t="_edit_profile_btn_wybdk_135",pt="_upload_image_container_wybdk_195",mt="_barber_profile_loader_wybdk_240",ut="_profile_skeleton_img_wybdk_250",ft="_barber_edit_email_container_wybdk_256",ht="_barber_verified_icon_wybdk_295",bt="_barber_notverified_icon_wybdk_312",jt="_barber_edit_mobile_container_wybdk_329",xt="_barber_edit_gender_container_wybdk_398",yt="_modal_container_wybdk_441",gt="_modal_content_container_wybdk_507",vt="_edit_modal_btn_wybdk_552",wt="_modal_common_container_wybdk_587",i={barber_edit_profile_container:rt,barber_edit_profile_container_left:lt,barber_edit_profile_content_left:dt,barber_edit_profile_container_right:ct,edit_profile_btn:_t,upload_image_container:pt,barber_profile_loader:mt,profile_skeleton_img:ut,barber_edit_email_container:ft,barber_verified_icon:ht,barber_notverified_icon:bt,barber_edit_mobile_container:jt,barber_edit_gender_container:xt,modal_container:yt,modal_content_container:gt,edit_modal_btn:vt,modal_common_container:wt},Kt=()=>{var X,Z,ee;const d=$e(),B=We(),n=x(t=>t.BarberLoggedInMiddleware.entiredata.user[0]),[p,le]=s.useState(n==null?void 0:n.emailVerified),[m,de]=s.useState(n==null?void 0:n.mobileVerified),[y,ce]=s.useState(n==null?void 0:n.name),[K,_e]=s.useState((X=n==null?void 0:n.dateOfBirth)==null?void 0:X.split("T")[0]),U=s.useRef(null),pe=()=>{U.current.click()},[me,g]=s.useState(!1),ue=async t=>{var ne,ae,oe;const a=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(a.type)){_.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const te=2*1024*1024;if(a.size>te){_.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const f=new FormData;f.append("email",n==null?void 0:n.email),f.append("profile",a),f.append("salonId",n==null?void 0:n.salonId);try{g(!0);const c=await ie.post("/api/barber/uploadBarberProfilePicture",f,{headers:{"Content-Type":"multipart/form-data"}});g(!1);const{data:Pe}=await ie.get("/api/barber/barberloggedin");d({type:qe,payload:Pe}),_.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(c){if(g(!1),((ne=c==null?void 0:c.response)==null?void 0:ne.status)===500){_.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}_.error((oe=(ae=c==null?void 0:c.response)==null?void 0:ae.data)==null?void 0:oe.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},L=()=>{p||d(Ze(n==null?void 0:n.email,j))},[r,v]=s.useState(["","","",""]),w=s.useRef([]),fe=(t,a)=>{const o=[...r];o[t]=a,a&&t<r.length-1&&w.current[t+1].focus(),v(o)},he=(t,a)=>{if(a.key==="Backspace"&&t>0&&!r[t]){const o=[...r];o[t-1]="",w.current[t-1].focus(),v(o)}a.key==="Enter"&&P()},A=()=>{m||d(et(n==null?void 0:n.email,b))},[l,C]=s.useState(["","","",""]),k=s.useRef([]),be=(t,a)=>{const o=[...l];o[t]=a,a&&t<l.length-1&&k.current[t+1].focus(),C(o)},je=(t,a)=>{if(a.key==="Backspace"&&t>0&&!l[t]){const o=[...l];o[t-1]="",k.current[t-1].focus(),C(o)}a.key==="Enter"&&$()},[S,xe]=s.useState(n==null?void 0:n.gender),[ye,N]=s.useState(!1),ge=()=>{N(t=>!t)},E=t=>{xe(t),N(!1)},[z,ve]=s.useState(`${n==null?void 0:n.mobileCountryCode}${(Z=n==null?void 0:n.mobileNumber)==null?void 0:Z.toString()}`),[we,Ce]=s.useState(n==null?void 0:n.mobileCountryCode),[ke,F]=s.useState(!1),G=()=>{if(ke)_.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,dateOfBirth:K,mobileNumber:Number(z),countryCode:Number(we),name:y,gender:S,password:h};d(tt(t,B))}},u=t=>{t.key==="Enter"&&G()},Se=x(t=>t.barberUpdateProfile),{loading:Ne,resolve:Ct}=Se,P=()=>{const t=r==null?void 0:r.join("");d(nt(n==null?void 0:n.email,t,j,v,le))},$=()=>{const t=l==null?void 0:l.join("");d(at(n==null?void 0:n.email,t,b,C,de))},[W,Ee]=s.useState(""),[h,Oe]=s.useState(""),[H,De]=s.useState("");s.useState(!1);const T=()=>{if(h!==H)_.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:h,oldPassword:W};d(ot(t,B))}},O=t=>{t.key==="Enter"&&T()},Me=x(t=>t.barberUpdatePassword),{loading:Ve}=Me;x(He);const[J,Ie]=s.useState(!1),[Y,Re]=s.useState(!1),[q,Be]=s.useState(!1),Q=Qe.PhoneNumberUtil.getInstance(),Ke=t=>{try{return Q.isValidNumber(Q.parseAndKeepRawInput(t))}catch{return!1}},[Ue,Le]=s.useState("gb"),Ae=(t,a)=>{const{country:o,inputValue:te}=a;Ke(t)?(ve(t),Ce(o==null?void 0:o.dialCode),Le(o==null?void 0:o.iso2),F(!1)):F(!0)},[ze,D]=s.useState(!1),[Fe,b]=s.useState(!1),[Ge,j]=s.useState(!1);return e.jsxs("main",{className:i.barber_edit_profile_container,children:[e.jsxs("div",{className:i.barber_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:i.barber_edit_profile_content_left,children:[e.jsxs("div",{children:[me?e.jsx(st,{variant:"rectangular",className:i.barber_profile_loader}):e.jsx("img",{src:(ee=n==null?void 0:n.profile[0])==null?void 0:ee.url,alt:"profile"}),e.jsx("button",{className:i.upload_image_container,onClick:()=>pe(),children:e.jsx(Te,{})}),e.jsx("input",{type:"file",ref:U,style:{display:"none"},onChange:ue})]}),e.jsx("p",{children:y}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:i.barber_edit_profile_container_right,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:y,onChange:t=>ce(t.target.value),onKeyDown:u})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:i.barber_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0,onKeyDown:u}),e.jsx("button",{onClick:()=>L(),className:p?i.barber_verified_icon:i.barber_notverified_icon,title:p?"Verified":"NotVerified",style:{cursor:p?"not-allowed":"pointer"},children:p?e.jsx(se,{}):e.jsx(M,{})})]})]}),e.jsx(R,{open:Ge,onClose:()=>j(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Je,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:r.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:o=>w.current[a]=o,onChange:o=>fe(a,o.target.value),onKeyDown:o=>he(a,o)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>L(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>j(!1),children:"Cancel"}),e.jsx("button",{onClick:P,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>D(!0),readOnly:!0})]}),e.jsx(R,{open:ze,onClose:()=>D(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>D(!1),children:e.jsx(M,{})})]}),e.jsxs("div",{className:i.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${Y?"text":"password"}`,value:W,onChange:t=>Ee(t.target.value),placeholder:"Enter Old Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Re(t=>!t),children:Y?e.jsx(V,{}):e.jsx(I,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${J?"text":"password"}`,value:h,onChange:t=>Oe(t.target.value),placeholder:"Enter New Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Ie(t=>!t),children:J?e.jsx(V,{}):e.jsx(I,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${q?"text":"password"}`,value:H,onChange:t=>De(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Be(t=>!t),children:q?e.jsx(V,{}):e.jsx(I,{})})]})]}),e.jsx("button",{className:i.edit_modal_btn,onClick:T,children:Ve?e.jsx(re,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:i.barber_edit_mobile_container,children:[e.jsx("div",{onKeyDown:u,children:e.jsx(Xe,{forceDialCode:!0,defaultCountry:Ue,value:z,onChange:(t,a)=>Ae(t,a)})}),e.jsx("button",{onClick:()=>A(),className:m?i.barber_verified_icon:i.barber_notverified_icon,title:m?"Verified":"NotVerified",style:{cursor:m?"not-allowed":"pointer"},children:m?e.jsx(se,{}):e.jsx(M,{})})]})]}),e.jsx(R,{open:Fe,onClose:()=>b(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Ye,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:l.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:o=>k.current[a]=o,onChange:o=>be(a,o.target.value),onKeyDown:o=>je(a,o)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>A(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>b(!1),children:"Cancel"}),e.jsx("button",{onClick:$,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:K,onChange:t=>_e(t.target.value),onKeyDown:u})]}),e.jsxs("div",{className:i.barber_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${S?`${S}`:""}`,onClick:()=>ge(),readOnly:!0,onKeyDown:u}),ye&&e.jsx(it,{onClickAway:()=>N(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>E("Male"),children:"Male"}),e.jsx("p",{onClick:()=>E("Female"),children:"Female"}),e.jsx("p",{onClick:()=>E("Other"),children:"Other"})]})})]}),e.jsx("button",{className:i.edit_profile_btn,onClick:G,children:Ne?e.jsx(re,{}):"Save"})]})]})};export{Kt as default};
