import{u as yt,a as wt,b as x,r as s,d as Ct,j as e,a1 as kt,C as N,a2 as St,p as Nt,a7 as Et,aB as Ve,aC as It,E as Y,N as q,aD as Rt,_ as c,q as Te,co as Mt}from"./index-LE4wwcdg.js";import{l as Ot,U as Vt}from"./libphonenumber-B8L-nP3C.js";import{B as J}from"./ButtonLoader-evyw5ydJ.js";import{b as Tt,a as Dt,c as Pt,d as Lt,e as $t,f as Kt}from"./BarberProfileAction-CLoPBDO1.js";import{a as zt}from"./BarberQueueAction-CTVpZBZU.js";import{g as At}from"./Date-Cuhd30XP.js";import{S as Q}from"./Skeleton-BjsL4Azr.js";import{M as E}from"./Modal-2aVE2EVH.js";import{C as Ut}from"./ClickAwayListener-BjWiiOUW.js";import"./clsx-B-dksMZM.js";import"./index-C8qIyj46.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-Difek1I8.js";const Wt="_barber_edit_profile_container_dlk9a_1",Gt="_barber_edit_profile_container_left_dlk9a_18",Bt="_barber_edit_profile_content_left_dlk9a_31",Ft="_barber_edit_profile_container_right_dlk9a_70",Ht="_edit_profile_btn_dlk9a_165",Yt="_upload_image_container_dlk9a_225",qt="_barber_profile_loader_dlk9a_270",Jt="_profile_skeleton_img_dlk9a_280",Qt="_barber_edit_email_container_dlk9a_286",Xt="_barber_verified_icon_dlk9a_325",Zt="_barber_notverified_icon_dlk9a_342",er="_barber_edit_mobile_container_dlk9a_359",tr="_barber_edit_gender_container_dlk9a_428",rr="_modal_container_dlk9a_471",or="_modal_content_container_dlk9a_537",nr="_edit_modal_btn_dlk9a_582",sr="_modal_common_container_dlk9a_617",ar="_edit_modal_container_dlk9a_752",ir="_edit_modal_content_container_dlk9a_817",dr="_service_item_dlk9a_824",lr="_service_add_icon_dlk9a_839",cr="_service_delete_icon_dlk9a_870",_r="_service_item_top_dlk9a_901",mr="_service_item_bottom_dlk9a_955",ur="_edit_modal_content_container_loading_dlk9a_1037",pr="_edit_modal_content_container_error_dlk9a_1051",fr="_error_message_dlk9a_1102",a={barber_edit_profile_container:Wt,barber_edit_profile_container_left:Gt,barber_edit_profile_content_left:Bt,barber_edit_profile_container_right:Ft,edit_profile_btn:Ht,upload_image_container:Yt,barber_profile_loader:qt,profile_skeleton_img:Jt,barber_edit_email_container:Qt,barber_verified_icon:Xt,barber_notverified_icon:Zt,barber_edit_mobile_container:er,barber_edit_gender_container:tr,modal_container:rr,modal_content_container:or,edit_modal_btn:nr,modal_common_container:sr,edit_modal_container:ar,edit_modal_content_container:ir,service_item:dr,service_add_icon:lr,service_delete_icon:cr,service_item_top:_r,service_item_bottom:mr,edit_modal_content_container_loading:ur,edit_modal_content_container_error:pr,error_message:fr},Mr=()=>{var Se,Ne,Ee,Ie,Re;const m=yt(),X=wt(),I=x(t=>t.BarberLoggedInMiddleware.barberSalonId),r=x(t=>t.BarberLoggedInMiddleware.entiredata.user[0]),[g,De]=s.useState(r==null?void 0:r.emailVerified),[y,Pe]=s.useState(r==null?void 0:r.mobileVerified),[u,Le]=s.useState(r==null?void 0:r.name),[Z,$e]=s.useState((Se=r==null?void 0:r.dateOfBirth)==null?void 0:Se.split("T")[0]),ee=s.useRef(null),Ke=()=>{ee.current.click()},[ze,R]=s.useState(!1),Ae=async t=>{var _,Me,Oe;const o=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(o.type)){c.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const i=2*1024*1024;if(o.size>i){c.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const h=new FormData;h.append("email",r==null?void 0:r.email),h.append("profile",o),h.append("salonId",r==null?void 0:r.salonId);try{R(!0);const v=await Te.post("/api/barber/uploadBarberProfilePicture",h,{headers:{"Content-Type":"multipart/form-data"}});R(!1);const{data:gt}=await Te.get("/api/barber/barberloggedin");m({type:Mt,payload:gt}),c.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(v){if(R(!1),((_=v==null?void 0:v.response)==null?void 0:_.status)===500){c.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}c.error((Oe=(Me=v==null?void 0:v.response)==null?void 0:Me.data)==null?void 0:Oe.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},te=s.useRef(30),re="lastEmailVerificationTime",oe=()=>{if(!g){const t=localStorage.getItem(re),o=Math.floor(Date.now()/1e3);if(t&&o-t<te.current){const n=te.current-(o-t);alert(`Please wait ${n} seconds before resending.`);return}localStorage.setItem(re,o),m(Tt(r==null?void 0:r.email,S))}},[p,M]=s.useState(["","","",""]),O=s.useRef([]),Ue=(t,o)=>{const n=[...p];n[t]=o,o&&t<p.length-1&&O.current[t+1].focus(),M(n)},We=(t,o)=>{if(o.key==="Backspace"&&t>0&&!p[t]){const n=[...p];n[t-1]="",O.current[t-1].focus(),M(n)}o.key==="Enter"&&pe()},ne=s.useRef(30),se="lastMobileVerificationTime",ae=()=>{if(!y){const t=localStorage.getItem(se),o=Math.floor(Date.now()/1e3);if(t&&o-t<ne.current){const n=ne.current-(o-t);alert(`Please wait ${n} seconds before resending.`);return}localStorage.setItem(se,o),m(Dt(r==null?void 0:r.email,k))}},[f,V]=s.useState(["","","",""]),T=s.useRef([]),Ge=(t,o)=>{const n=[...f];n[t]=o,o&&t<f.length-1&&T.current[t+1].focus(),V(n)},Be=(t,o)=>{if(o.key==="Backspace"&&t>0&&!f[t]){const n=[...f];n[t-1]="",T.current[t-1].focus(),V(n)}o.key==="Enter"&&fe()},[D,Fe]=s.useState(r==null?void 0:r.gender),[He,P]=s.useState(!1),Ye=()=>{P(t=>!t)},L=t=>{Fe(t),P(!1)},[ie,qe]=s.useState(`${r==null?void 0:r.mobileCountryCode}${(Ne=r==null?void 0:r.mobileNumber)==null?void 0:Ne.toString()}`),[Je,Qe]=s.useState(r==null?void 0:r.mobileCountryCode),[Xe,de]=s.useState(!1),[le,ce]=s.useState(""),[_e,me]=s.useState(""),$=()=>{if(u.length===0||u.length>20)return c.error("Name must be between 1 to 20 characters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),ce("Name must be between 1 to 20 characters");if(Xe)return c.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),me("Invalid Number");const t={email:r==null?void 0:r.email,dateOfBirth:Z,mobileNumber:Number(ie),countryCode:Number(Je),name:u,gender:D,password:j,barberServices:l};m(Pt(t,X))},b=t=>{t.key==="Enter"&&$()},Ze=x(t=>t.barberUpdateProfile),{loading:ue,resolve:hr}=Ze,pe=()=>{const t=p==null?void 0:p.join("");m(Lt(r==null?void 0:r.email,t,S,M,De))},fe=()=>{const t=f==null?void 0:f.join("");m($t(r==null?void 0:r.email,t,k,V,Pe))},[w,et]=s.useState(""),[j,tt]=s.useState(""),[C,rt]=s.useState(""),[he,K]=s.useState(""),[ve,z]=s.useState(""),[be,A]=s.useState(""),[je,U]=s.useState(""),xe=()=>{if(!w)return c.error("Please enter password",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),K("Please enter old password");if(w.length<8)return c.error("Password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),K("Old password length must be 8 charecters");if(!j)return c.error("Please enter password",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),z("Please enter new password");if(j.length<8)return c.error("Password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),z("New password length must be 8 charecters");if(!C)return c.error("Please enter confirm password",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),A("Please enter confirm password");if(C.length<8)return c.error("Confirm password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),A("Confirm password length must be 8 charecters");if(j!==C)return c.error("Password and confirm password do not match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),U("Password and confirm password do not match");const t={email:r==null?void 0:r.email,password:j,oldPassword:w};m(Kt(t,X))},W=t=>{t.key==="Enter"&&xe()},ot=x(t=>t.barberUpdatePassword),{loading:nt}=ot;x(Ct);const[ge,st]=s.useState(!1),[ye,at]=s.useState(!1),[we,it]=s.useState(!1),Ce=Ot.PhoneNumberUtil.getInstance(),dt=t=>{try{return Ce.isValidNumber(Ce.parseAndKeepRawInput(t))}catch{return!1}},[lt,ct]=s.useState("gb"),_t=(t,o)=>{me("");const{country:n,inputValue:i}=o;dt(t)?(qe(t),Qe(n==null?void 0:n.dialCode),ct(n==null?void 0:n.iso2),de(!1)):de(!0)},[mt,G]=s.useState(!1),[ut,k]=s.useState(!1),[pt,S]=s.useState(!1),[ft,B]=s.useState(!1);s.useEffect(()=>{r&&I!==0&&m(zt(r==null?void 0:r.salonId))},[r,I,m]);const ht=x(t=>t.getAllSalonServicesBarber),{loading:vt,resolve:vr,response:d}=ht;s.useEffect(()=>{var t;d&&F((t=d==null?void 0:d.response)==null?void 0:t.services)},[d]);const[ke,F]=s.useState([]),[l,H]=s.useState(r==null?void 0:r.barberServices),bt=t=>{l.includes(t)||H([...l,{...t,barberServiceEWT:t.serviceEWT}])},jt=t=>{var n;const o=(n=d==null?void 0:d.response)==null?void 0:n.services.find(i=>i.serviceId===t.serviceId);o&&(H(l.filter(i=>i.serviceId!==t.serviceId)),F(ke.map(i=>i.serviceId===t.serviceId?{...i,serviceEWT:o.serviceEWT}:i)))},xt=(t,o)=>{var h;const n=t.target.value.replace(/[^0-9]/g,""),i=n===""?"":Number(n);l.find(_=>_.serviceId===o.serviceId)?H(l.map(_=>_.serviceId===o.serviceId?{..._,barberServiceEWT:i}:_)):F((h=d==null?void 0:d.response)==null?void 0:h.services.map(_=>_.serviceId===o.serviceId?{..._,serviceEWT:i}:_))};return e.jsxs("main",{className:a.barber_edit_profile_container,children:[e.jsxs("div",{className:a.barber_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:a.barber_edit_profile_content_left,children:[e.jsxs("div",{children:[ze?e.jsx(Q,{variant:"rectangular",className:a.barber_profile_loader}):e.jsx("img",{src:(Ee=r==null?void 0:r.profile[0])==null?void 0:Ee.url,alt:"profile"}),e.jsx("button",{className:a.upload_image_container,onClick:()=>Ke(),children:e.jsx(kt,{})}),e.jsx("input",{type:"file",ref:ee,style:{display:"none"},onChange:Ae})]}),e.jsx("p",{children:(u==null?void 0:u.length)>20?`${u.slice(0,20)}...`:u}),e.jsx("p",{children:r==null?void 0:r.email})]})]}),e.jsxs("div",{className:a.barber_edit_profile_container_right,children:[I===0?e.jsx("div",{}):e.jsx("button",{onClick:()=>B(!0),children:"Edit services"}),e.jsx(E,{open:ft,onClose:()=>B(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.edit_modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Edit Services"}),e.jsx("button",{onClick:()=>B(!1),children:e.jsx(N,{})})]}),vt?e.jsxs("main",{className:`${a.edit_modal_content_container_loading}`,children:[e.jsx(Q,{variant:"rectangular",width:"100%",height:"16rem",style:{borderRadius:"var(--list-wrapper-border-radius)"}}),e.jsx(Q,{variant:"rectangular",width:"100%",height:"16rem",style:{borderRadius:"var(--list-wrapper-border-radius)"}})]}):((Re=(Ie=d==null?void 0:d.response)==null?void 0:Ie.services)==null?void 0:Re.length)>0?e.jsx("main",{className:a.edit_modal_content_container,children:ke.map(t=>{var o,n;return e.jsxs("div",{className:`${a.service_item}`,children:[e.jsxs("div",{className:`${a.service_item_top}`,children:[e.jsx("div",{children:e.jsx("img",{src:(o=t==null?void 0:t.serviceIcon)==null?void 0:o.url,alt:"service icon"})}),e.jsxs("div",{children:[e.jsx("p",{children:t==null?void 0:t.serviceName}),e.jsx("p",{children:t!=null&&t.vipService?"VIP":"Regular"}),e.jsx("p",{children:t==null?void 0:t.serviceDesc})]})]}),e.jsxs("div",{className:`${a.service_item_bottom}`,children:[e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("p",{children:"Service Price"}),e.jsxs("p",{children:[(n=d==null?void 0:d.response)==null?void 0:n.currency,t==null?void 0:t.servicePrice]})]})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("p",{children:"Est Wait Time"}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(St,{})}),e.jsx("input",{type:"text",value:l!=null&&l.find(i=>i.serviceId===t.serviceId)?l==null?void 0:l.find(i=>i.serviceId===t.serviceId).barberServiceEWT:t.serviceEWT,onChange:i=>xt(i,t)}),e.jsx("p",{children:"mins"})]})]})})]}),l.find(i=>i.serviceId===t.serviceId)?e.jsx("button",{className:`${a.service_delete_icon}`,onClick:()=>jt(t),children:e.jsx(Nt,{})}):e.jsx("button",{className:`${a.service_add_icon}`,onClick:()=>bt(t),children:e.jsx(Et,{})})]},t==null?void 0:t._id)})}):e.jsx("main",{className:`${a.edit_modal_content_container_error}`,children:e.jsx("p",{children:"No services available"})}),e.jsx("button",{onClick:$,children:ue?e.jsx(J,{}):"Save"})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:u,onChange:t=>{ce(""),Le(t.target.value)},onKeyDown:b,style:{border:le?"0.1rem solid red":"none"}}),e.jsx("p",{className:a.error_message,children:le})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:a.barber_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:r==null?void 0:r.email,readOnly:!0,onKeyDown:b}),e.jsx("button",{onClick:()=>oe(),className:g?a.barber_verified_icon:a.barber_notverified_icon,title:g?"Verified":"NotVerified",style:{cursor:g?"not-allowed":"pointer"},children:g?e.jsx(Ve,{}):e.jsx(N,{})})]})]}),e.jsx(E,{open:pt,onClose:()=>S(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.modal_common_container,children:[e.jsx("div",{children:e.jsx(It,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:r==null?void 0:r.email})]}),e.jsx("div",{children:p.map((t,o)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:o===0,ref:n=>O.current[o]=n,onChange:n=>{/^\d*$/.test(n.target.value)&&Ue(o,n.target.value)},onKeyDown:n=>We(o,n)},o))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>oe(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>S(!1),children:"Cancel"}),e.jsx("button",{onClick:pe,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>G(!0),readOnly:!0})]}),e.jsx(E,{open:mt,onClose:()=>G(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>G(!1),children:e.jsx(N,{})})]}),e.jsxs("div",{className:a.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{style:{border:he?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${ye?"text":"password"}`,value:w,onChange:t=>{K(""),et(t.target.value)},placeholder:"Enter Old Password",onKeyDown:W}),e.jsx("div",{onClick:()=>at(t=>!t),children:ye?e.jsx(Y,{}):e.jsx(q,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:he})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{style:{border:ve?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${ge?"text":"password"}`,value:j,onChange:t=>{U(""),z(""),tt(t.target.value)},placeholder:"Enter New Password",onKeyDown:W}),e.jsx("div",{onClick:()=>st(t=>!t),children:ge?e.jsx(Y,{}):e.jsx(q,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:ve})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{style:{border:be||je?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${we?"text":"password"}`,value:C,onChange:t=>{U(""),A(""),rt(t.target.value)},placeholder:"Enter Confirm Password",onKeyDown:W}),e.jsx("div",{onClick:()=>it(t=>!t),children:we?e.jsx(Y,{}):e.jsx(q,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:be||je})]}),e.jsx("button",{className:a.edit_modal_btn,onClick:xe,children:nt?e.jsx(J,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:a.barber_edit_mobile_container,style:{outline:_e&&"0.1rem solid red"},children:[e.jsx("div",{onKeyDown:b,children:e.jsx(Vt,{forceDialCode:!0,defaultCountry:lt,value:ie,onChange:(t,o)=>_t(t,o)})}),e.jsx("button",{onClick:()=>ae(),className:y?a.barber_verified_icon:a.barber_notverified_icon,title:y?"Verified":"NotVerified",style:{cursor:y?"not-allowed":"pointer"},children:y?e.jsx(Ve,{}):e.jsx(N,{})})]}),e.jsx("p",{className:a.error_message,children:_e})]}),e.jsx(E,{open:ut,onClose:()=>k(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.modal_common_container,children:[e.jsx("div",{children:e.jsx(Rt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:r==null?void 0:r.mobileNumber})]}),e.jsx("div",{children:f.map((t,o)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:o===0,ref:n=>T.current[o]=n,onChange:n=>{/^\d*$/.test(n.target.value)&&Ge(o,n.target.value)},onKeyDown:n=>Be(o,n)},o))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>ae(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>k(!1),children:"Cancel"}),e.jsx("button",{onClick:fe,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:Z,onChange:t=>$e(t.target.value),onKeyDown:b,max:At()})]}),e.jsxs("div",{className:a.barber_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${D?`${D}`:""}`,onClick:()=>Ye(),readOnly:!0,onKeyDown:b}),He&&e.jsx(Ut,{onClickAway:()=>P(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>L("Male"),children:"Male"}),e.jsx("p",{onClick:()=>L("Female"),children:"Female"}),e.jsx("p",{onClick:()=>L("Other"),children:"Other"})]})})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Selected Services"}),e.jsx("input",{type:"text",value:l==null?void 0:l.map(t=>" "+t.serviceName),placeholder:"Your Services",onKeyDown:b})]}),e.jsx("button",{className:a.edit_profile_btn,onClick:$,children:ue?e.jsx(J,{}):"Save"})]})]})};export{Mr as default};
