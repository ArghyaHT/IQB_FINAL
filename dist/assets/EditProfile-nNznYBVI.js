import{u as pt,a as ht,b as j,r as s,d as ft,j as e,a0 as vt,C as S,a1 as bt,o as jt,a6 as xt,aA as Se,aB as gt,E as W,N as G,aC as wt,_ as f,p as Ne,cn as yt}from"./index-DDukCDKF.js";import{l as Ct,U as St}from"./libphonenumber-CW8Dqfi3.js";import{B}from"./ButtonLoader-BzxIs721.js";import{b as Nt,a as kt,c as Et,d as It,e as zt,f as Mt}from"./BarberProfileAction-DHQzPsXT.js";import{a as Ot}from"./BarberQueueAction-DyJChqny.js";import{g as Rt}from"./Date-D5SsnKrL.js";import{S as P}from"./Skeleton-CQlEIIZS.js";import{M as N}from"./Modal-BsbO3dsX.js";import{C as Vt}from"./ClickAwayListener-DJIZgf83.js";import"./clsx-B-dksMZM.js";import"./index-BkCjIGOe.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-CL-l-k-U.js";const Dt="_barber_edit_profile_container_hwluz_1",Tt="_barber_edit_profile_container_left_hwluz_18",Lt="_barber_edit_profile_content_left_hwluz_31",$t="_barber_edit_profile_container_right_hwluz_70",Kt="_edit_profile_btn_hwluz_165",At="_upload_image_container_hwluz_225",Ut="_barber_profile_loader_hwluz_270",Wt="_profile_skeleton_img_hwluz_280",Gt="_barber_edit_email_container_hwluz_286",Bt="_barber_verified_icon_hwluz_325",Pt="_barber_notverified_icon_hwluz_342",Ft="_barber_edit_mobile_container_hwluz_359",Ht="_barber_edit_gender_container_hwluz_428",Yt="_modal_container_hwluz_471",Jt="_modal_content_container_hwluz_537",qt="_edit_modal_btn_hwluz_582",Qt="_modal_common_container_hwluz_617",Xt="_edit_modal_container_hwluz_752",Zt="_edit_modal_content_container_hwluz_817",en="_service_item_hwluz_824",tn="_service_add_icon_hwluz_839",nn="_service_delete_icon_hwluz_870",on="_service_item_top_hwluz_901",sn="_service_item_bottom_hwluz_955",rn="_edit_modal_content_container_loading_hwluz_1037",an="_edit_modal_content_container_error_hwluz_1051",ln="_error_message_hwluz_1102",r={barber_edit_profile_container:Dt,barber_edit_profile_container_left:Tt,barber_edit_profile_content_left:Lt,barber_edit_profile_container_right:$t,edit_profile_btn:Kt,upload_image_container:At,barber_profile_loader:Ut,profile_skeleton_img:Wt,barber_edit_email_container:Gt,barber_verified_icon:Bt,barber_notverified_icon:Pt,barber_edit_mobile_container:Ft,barber_edit_gender_container:Ht,modal_container:Yt,modal_content_container:Jt,edit_modal_btn:qt,modal_common_container:Qt,edit_modal_container:Xt,edit_modal_content_container:Zt,service_item:en,service_add_icon:tn,service_delete_icon:nn,service_item_top:on,service_item_bottom:sn,edit_modal_content_container_loading:rn,edit_modal_content_container_error:an,error_message:ln},Cn=()=>{var be,je,xe,ge,we;const _=pt(),F=ht(),k=j(t=>t.BarberLoggedInMiddleware.barberSalonId),n=j(t=>t.BarberLoggedInMiddleware.entiredata.user[0]),[x,ke]=s.useState(n==null?void 0:n.emailVerified),[g,Ee]=s.useState(n==null?void 0:n.mobileVerified),[m,Ie]=s.useState(n==null?void 0:n.name),[H,ze]=s.useState((be=n==null?void 0:n.dateOfBirth)==null?void 0:be.split("T")[0]),Y=s.useRef(null),Me=()=>{Y.current.click()},[Oe,E]=s.useState(!1),Re=async t=>{var c,ye,Ce;const i=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(i.type)){f.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const a=2*1024*1024;if(i.size>a){f.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const h=new FormData;h.append("email",n==null?void 0:n.email),h.append("profile",i),h.append("salonId",n==null?void 0:n.salonId);try{E(!0);const v=await Ne.post("/api/barber/uploadBarberProfilePicture",h,{headers:{"Content-Type":"multipart/form-data"}});E(!1);const{data:ut}=await Ne.get("/api/barber/barberloggedin");_({type:yt,payload:ut}),f.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(v){if(E(!1),((c=v==null?void 0:v.response)==null?void 0:c.status)===500){f.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}f.error((Ce=(ye=v==null?void 0:v.response)==null?void 0:ye.data)==null?void 0:Ce.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},J=s.useRef(30),q="lastEmailVerificationTime",Q=()=>{if(!x){const t=localStorage.getItem(q),i=Math.floor(Date.now()/1e3);if(t&&i-t<J.current){const o=J.current-(i-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(q,i),_(Nt(n==null?void 0:n.email,C))}},[u,I]=s.useState(["","","",""]),z=s.useRef([]),Ve=(t,i)=>{const o=[...u];o[t]=i,i&&t<u.length-1&&z.current[t+1].focus(),I(o)},De=(t,i)=>{if(i.key==="Backspace"&&t>0&&!u[t]){const o=[...u];o[t-1]="",z.current[t-1].focus(),I(o)}i.key==="Enter"&&le()},X=s.useRef(30),Z="lastMobileVerificationTime",ee=()=>{if(!g){const t=localStorage.getItem(Z),i=Math.floor(Date.now()/1e3);if(t&&i-t<X.current){const o=X.current-(i-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(Z,i),_(kt(n==null?void 0:n.email,y))}},[p,M]=s.useState(["","","",""]),O=s.useRef([]),Te=(t,i)=>{const o=[...p];o[t]=i,i&&t<p.length-1&&O.current[t+1].focus(),M(o)},Le=(t,i)=>{if(i.key==="Backspace"&&t>0&&!p[t]){const o=[...p];o[t-1]="",O.current[t-1].focus(),M(o)}i.key==="Enter"&&de()},[R,$e]=s.useState(n==null?void 0:n.gender),[Ke,V]=s.useState(!1),Ae=()=>{V(t=>!t)},D=t=>{$e(t),V(!1)},[te,Ue]=s.useState(`${n==null?void 0:n.mobileCountryCode}${(je=n==null?void 0:n.mobileNumber)==null?void 0:je.toString()}`),[We,Ge]=s.useState(n==null?void 0:n.mobileCountryCode),[Be,ne]=s.useState(!1),[ie,oe]=s.useState(""),[se,re]=s.useState(""),T=()=>{if(m.length===0||m.length>20)return f.error("Name must be between 1 to 20 characters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),oe("Name must be between 1 to 20 characters");if(Be)return f.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),re("Invalid Number");const t={email:n==null?void 0:n.email,dateOfBirth:H,mobileNumber:Number(te),countryCode:Number(We),name:m,gender:R,password:w,barberServices:d};_(Et(t,F))},b=t=>{t.key==="Enter"&&T()},Pe=j(t=>t.barberUpdateProfile),{loading:ae,resolve:dn}=Pe,le=()=>{const t=u==null?void 0:u.join("");_(It(n==null?void 0:n.email,t,C,I,ke))},de=()=>{const t=p==null?void 0:p.join("");_(zt(n==null?void 0:n.email,t,y,M,Ee))},[ce,Fe]=s.useState(""),[w,He]=s.useState(""),[_e,Ye]=s.useState("");s.useState(!1);const me=()=>{if(w!==_e)f.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:w,oldPassword:ce};_(Mt(t,F))}},L=t=>{t.key==="Enter"&&me()},Je=j(t=>t.barberUpdatePassword),{loading:qe}=Je;j(ft);const[ue,Qe]=s.useState(!1),[pe,Xe]=s.useState(!1),[he,Ze]=s.useState(!1),fe=Ct.PhoneNumberUtil.getInstance(),et=t=>{try{return fe.isValidNumber(fe.parseAndKeepRawInput(t))}catch{return!1}},[tt,nt]=s.useState("gb"),it=(t,i)=>{re("");const{country:o,inputValue:a}=i;et(t)?(Ue(t),Ge(o==null?void 0:o.dialCode),nt(o==null?void 0:o.iso2),ne(!1)):ne(!0)},[ot,$]=s.useState(!1),[st,y]=s.useState(!1),[rt,C]=s.useState(!1),[at,K]=s.useState(!1);s.useEffect(()=>{n&&k!==0&&_(Ot(n==null?void 0:n.salonId))},[n,k,_]);const lt=j(t=>t.getAllSalonServicesBarber),{loading:dt,resolve:cn,response:l}=lt;s.useEffect(()=>{var t;l&&A((t=l==null?void 0:l.response)==null?void 0:t.services)},[l]);const[ve,A]=s.useState([]),[d,U]=s.useState(n==null?void 0:n.barberServices),ct=t=>{d.includes(t)||U([...d,{...t,barberServiceEWT:t.serviceEWT}])},_t=t=>{var o;const i=(o=l==null?void 0:l.response)==null?void 0:o.services.find(a=>a.serviceId===t.serviceId);i&&(U(d.filter(a=>a.serviceId!==t.serviceId)),A(ve.map(a=>a.serviceId===t.serviceId?{...a,serviceEWT:i.serviceEWT}:a)))},mt=(t,i)=>{var h;const o=t.target.value.replace(/[^0-9]/g,""),a=o===""?"":Number(o);d.find(c=>c.serviceId===i.serviceId)?U(d.map(c=>c.serviceId===i.serviceId?{...c,barberServiceEWT:a}:c)):A((h=l==null?void 0:l.response)==null?void 0:h.services.map(c=>c.serviceId===i.serviceId?{...c,serviceEWT:a}:c))};return e.jsxs("main",{className:r.barber_edit_profile_container,children:[e.jsxs("div",{className:r.barber_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:r.barber_edit_profile_content_left,children:[e.jsxs("div",{children:[Oe?e.jsx(P,{variant:"rectangular",className:r.barber_profile_loader}):e.jsx("img",{src:(xe=n==null?void 0:n.profile[0])==null?void 0:xe.url,alt:"profile"}),e.jsx("button",{className:r.upload_image_container,onClick:()=>Me(),children:e.jsx(vt,{})}),e.jsx("input",{type:"file",ref:Y,style:{display:"none"},onChange:Re})]}),e.jsx("p",{children:(m==null?void 0:m.length)>20?`${m.slice(0,20)}...`:m}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:r.barber_edit_profile_container_right,children:[k===0?e.jsx("div",{}):e.jsx("button",{onClick:()=>K(!0),children:"Edit services"}),e.jsx(N,{open:at,onClose:()=>K(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:r.edit_modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Edit Services"}),e.jsx("button",{onClick:()=>K(!1),children:e.jsx(S,{})})]}),dt?e.jsxs("main",{className:`${r.edit_modal_content_container_loading}`,children:[e.jsx(P,{variant:"rectangular",width:"100%",height:"16rem",style:{borderRadius:"var(--list-wrapper-border-radius)"}}),e.jsx(P,{variant:"rectangular",width:"100%",height:"16rem",style:{borderRadius:"var(--list-wrapper-border-radius)"}})]}):((we=(ge=l==null?void 0:l.response)==null?void 0:ge.services)==null?void 0:we.length)>0?e.jsx("main",{className:r.edit_modal_content_container,children:ve.map(t=>{var i,o;return e.jsxs("div",{className:`${r.service_item}`,children:[e.jsxs("div",{className:`${r.service_item_top}`,children:[e.jsx("div",{children:e.jsx("img",{src:(i=t==null?void 0:t.serviceIcon)==null?void 0:i.url,alt:"service icon"})}),e.jsxs("div",{children:[e.jsx("p",{children:t==null?void 0:t.serviceName}),e.jsx("p",{children:t!=null&&t.vipService?"VIP":"Regular"}),e.jsx("p",{children:t==null?void 0:t.serviceDesc})]})]}),e.jsxs("div",{className:`${r.service_item_bottom}`,children:[e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("p",{children:"Service Price"}),e.jsxs("p",{children:[(o=l==null?void 0:l.response)==null?void 0:o.currency,t==null?void 0:t.servicePrice]})]})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("p",{children:"Est Wait Time"}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(bt,{})}),e.jsx("input",{type:"text",value:d!=null&&d.find(a=>a.serviceId===t.serviceId)?d==null?void 0:d.find(a=>a.serviceId===t.serviceId).barberServiceEWT:t.serviceEWT,onChange:a=>mt(a,t)}),e.jsx("p",{children:"mins"})]})]})})]}),d.find(a=>a.serviceId===t.serviceId)?e.jsx("button",{className:`${r.service_delete_icon}`,onClick:()=>_t(t),children:e.jsx(jt,{})}):e.jsx("button",{className:`${r.service_add_icon}`,onClick:()=>ct(t),children:e.jsx(xt,{})})]},t==null?void 0:t._id)})}):e.jsx("main",{className:`${r.edit_modal_content_container_error}`,children:e.jsx("p",{children:"No services available"})}),e.jsx("button",{onClick:T,children:ae?e.jsx(B,{}):"Save"})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:m,onChange:t=>{oe(""),Ie(t.target.value)},onKeyDown:b,style:{border:ie?"0.1rem solid red":"none"}}),e.jsx("p",{className:r.error_message,children:ie})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:r.barber_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0,onKeyDown:b}),e.jsx("button",{onClick:()=>Q(),className:x?r.barber_verified_icon:r.barber_notverified_icon,title:x?"Verified":"NotVerified",style:{cursor:x?"not-allowed":"pointer"},children:x?e.jsx(Se,{}):e.jsx(S,{})})]})]}),e.jsx(N,{open:rt,onClose:()=>C(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:r.modal_common_container,children:[e.jsx("div",{children:e.jsx(gt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:u.map((t,i)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:i===0,ref:o=>z.current[i]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Ve(i,o.target.value)},onKeyDown:o=>De(i,o)},i))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>Q(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>C(!1),children:"Cancel"}),e.jsx("button",{onClick:le,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>$(!0),readOnly:!0})]}),e.jsx(N,{open:ot,onClose:()=>$(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:r.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>$(!1),children:e.jsx(S,{})})]}),e.jsxs("div",{className:r.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${pe?"text":"password"}`,value:ce,onChange:t=>Fe(t.target.value),placeholder:"Enter Old Password",onKeyDown:L}),e.jsx("div",{onClick:()=>Xe(t=>!t),children:pe?e.jsx(W,{}):e.jsx(G,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${ue?"text":"password"}`,value:w,onChange:t=>He(t.target.value),placeholder:"Enter New Password",onKeyDown:L}),e.jsx("div",{onClick:()=>Qe(t=>!t),children:ue?e.jsx(W,{}):e.jsx(G,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${he?"text":"password"}`,value:_e,onChange:t=>Ye(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:L}),e.jsx("div",{onClick:()=>Ze(t=>!t),children:he?e.jsx(W,{}):e.jsx(G,{})})]})]}),e.jsx("button",{className:r.edit_modal_btn,onClick:me,children:qe?e.jsx(B,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:r.barber_edit_mobile_container,style:{outline:se&&"0.1rem solid red"},children:[e.jsx("div",{onKeyDown:b,children:e.jsx(St,{forceDialCode:!0,defaultCountry:tt,value:te,onChange:(t,i)=>it(t,i)})}),e.jsx("button",{onClick:()=>ee(),className:g?r.barber_verified_icon:r.barber_notverified_icon,title:g?"Verified":"NotVerified",style:{cursor:g?"not-allowed":"pointer"},children:g?e.jsx(Se,{}):e.jsx(S,{})})]}),e.jsx("p",{className:r.error_message,children:se})]}),e.jsx(N,{open:st,onClose:()=>y(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:r.modal_common_container,children:[e.jsx("div",{children:e.jsx(wt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:p.map((t,i)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:i===0,ref:o=>O.current[i]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Te(i,o.target.value)},onKeyDown:o=>Le(i,o)},i))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>ee(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>y(!1),children:"Cancel"}),e.jsx("button",{onClick:de,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:H,onChange:t=>ze(t.target.value),onKeyDown:b,max:Rt()})]}),e.jsxs("div",{className:r.barber_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${R?`${R}`:""}`,onClick:()=>Ae(),readOnly:!0,onKeyDown:b}),Ke&&e.jsx(Vt,{onClickAway:()=>V(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>D("Male"),children:"Male"}),e.jsx("p",{onClick:()=>D("Female"),children:"Female"}),e.jsx("p",{onClick:()=>D("Other"),children:"Other"})]})})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Selected Services"}),e.jsx("input",{type:"text",value:d==null?void 0:d.map(t=>" "+t.serviceName),placeholder:"Your Services",onKeyDown:b})]}),e.jsx("button",{className:r.edit_profile_btn,onClick:T,children:ae?e.jsx(B,{}):"Save"})]})]})};export{Cn as default};
