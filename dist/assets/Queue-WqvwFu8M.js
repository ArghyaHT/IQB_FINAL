import{A,p as h,q as k,t as S,v as f,_ as y,w as C,x as I,y as b,b as _,u as L,r as E,d as N,j as a,z as R}from"./index-DswqzyJH.js";import{S as U}from"./index-CoQheMi3.js";import{a as $}from"./DashboardAction-BOJ70Qql.js";const D="_admin_queue_wrapper_1qkef_1",B="_admin_queue_content_wrapper_1qkef_29",M="_admin_queue_content_body_1qkef_39",z="_admin_queue_content_body_item_1qkef_129",T="_admin_queue_content_body_error_1qkef_208",V="_modal_container_1qkef_221",t={admin_queue_wrapper:D,admin_queue_content_wrapper:B,admin_queue_content_body:M,admin_queue_content_body_item:z,admin_queue_content_body_error:T,modal_container:V},F=(r,u)=>async o=>{var s,c,d,i;try{o({type:A});const{data:e}=await h.post("/api/queue/barberServedQueue",r);o({type:k,payload:e});const{data:g}=await h.get(`/api/queue/getQListBySalonId?salonId=${u}`);o({type:S,payload:g})}catch(e){if(((s=e==null?void 0:e.response)==null?void 0:s.status)===500){o({type:f,payload:"Something went wrong !"}),y.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}o({type:f,payload:(c=e==null?void 0:e.response)==null?void 0:c.data}),y.error((i=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:i.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},P=(r,u)=>async o=>{var s,c,d,i;try{o({type:C});const{data:e}=await h.post("/api/queue/cancelQ",r);o({type:I,payload:e});const{data:g}=await h.get(`/api/queue/getQListBySalonId?salonId=${u}`);o({type:S,payload:g})}catch(e){if(((s=e==null?void 0:e.response)==null?void 0:s.status)===500){o({type:b,payload:"Something went wrong !"}),y.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}o({type:b,payload:(c=e==null?void 0:e.response)==null?void 0:c.data}),y.error((i=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:i.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},G=()=>{const r=_(n=>n.AdminLoggedInMiddleware.adminSalonId),u=_(n=>n.AdminLoggedInMiddleware.adminEmail),o=L(),s=E.useRef(new AbortController);E.useEffect(()=>{const n=new AbortController;return s.current=n,o($(r,n.signal)),()=>{s.current&&s.current.abort()}},[r,o]);const c=_(n=>n.getAllQueueList),{loading:d,resolve:i,queueList:e}=c,l=_(N)==="On",v=n=>{const m=window.confirm("Are you Sure ?"),p={adminEmail:u,barberId:n.barberId,salonId:r,services:n.services,_id:n._id};m&&(console.log(p),o(F(p,r)))},x=n=>{const m=window.confirm("Are you Sure ?"),p={adminEmail:u,barberId:n.barberId,salonId:r,_id:n._id};m&&(console.log(p),o(P(p,r)))},q=_(n=>n.adminServeQueue),{loading:Q}=q,j=_(n=>n.adminCancelQueue),{loading:w}=j;return a.jsxs("div",{className:`${t.admin_queue_wrapper} ${l&&t.dark}`,children:[a.jsx("div",{children:a.jsx("p",{children:"Queue List"})}),a.jsx("div",{className:`${t.admin_queue_content_wrapper} ${l&&t.dark}`,children:d&&!i?a.jsx("div",{className:t.admin_queue_content_body,children:a.jsx(U,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:l?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:l?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):!d&&i&&(e==null?void 0:e.length)>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${t.admin_queue_content_body} ${l&&t.dark}`,children:[a.jsxs("div",{children:[a.jsx("p",{children:"Name"}),a.jsx("p",{children:"Time Joined Q"}),a.jsx("p",{children:"Barber Name"}),a.jsx("p",{children:"Q Postion"}),a.jsx("p",{children:"Type"}),a.jsx("p",{children:"Serve"}),a.jsx("p",{children:"Cancel"})]}),e==null?void 0:e.map((n,m)=>a.jsxs("div",{className:`${t.admin_queue_content_body_item} ${l&&t.dark}`,style:{borderBottom:e.length-1===m&&"none"},children:[a.jsx("p",{children:n.name.length>18?n.name.slice(0,18)+"...":n.name}),a.jsx("p",{children:n.timeJoinedQ}),a.jsx("p",{children:n.barberName.length>18?n.barberName.slice(0,18)+"...":n.barberName}),a.jsx("p",{children:n.qPosition}),a.jsx("div",{children:n.serviceType==="VIP"?a.jsx(R,{}):"-"}),a.jsx("div",{children:a.jsx("button",{onClick:()=>v(n),disabled:Q,children:"Serve"})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>x(n),disabled:w,children:"Cancel"})})]},n._id))]})}):!d&&i&&(e==null?void 0:e.length)==0?a.jsx("div",{className:`${t.admin_queue_content_body_error} ${l&&t.dark}`,children:a.jsx("p",{children:"Queue not available"})}):!d&&!i&&a.jsx("div",{className:`${t.admin_queue_content_body_error} ${l&&t.dark}`,children:a.jsx("p",{children:"Queue not available"})})})]})};export{G as default};
