import{u as $e,a as We,b as j,r as s,d as He,j as e,a4 as Ye,aF as me,C as I,aG as Je,E as V,N as R,aH as qe,_,p as pe,aI as Qe}from"./index-CIJl-UZQ.js";import{l as Xe,U as Ze}from"./libphonenumber-CDMNAZ3y.js";import{a as et,b as tt,c as nt,d as at,e as ot,f as st}from"./AdminProfileAction-DFuVNZI0.js";import{B as ue}from"./ButtonLoader-Bl_AOGZC.js";import{S as it}from"./Skeleton-s6t77R9Y.js";import{M as A}from"./Modal-rrrW61NF.js";import{C as rt}from"./ClickAwayListener-DD5M7gx7.js";import"./clsx-B-dksMZM.js";import"./index-RTiQy-ZE.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-CXs34_Mj.js";const lt="_admin_edit_profile_container_1cabx_1",dt="_admin_edit_profile_container_left_1cabx_18",ct="_admin_edit_profile_content_left_1cabx_31",_t="_admin_edit_profile_container_right_1cabx_70",mt="_edit_profile_btn_1cabx_135",pt="_upload_image_container_1cabx_195",ut="_admin_profile_loader_1cabx_240",ft="_profile_skeleton_img_1cabx_250",ht="_admin_edit_email_container_1cabx_256",xt="_admin_verified_icon_1cabx_295",bt="_admin_notverified_icon_1cabx_312",jt="_admin_edit_mobile_container_1cabx_329",gt="_admin_edit_gender_container_1cabx_398",yt="_modal_container_1cabx_441",vt="_modal_content_container_1cabx_507",Ct="_edit_modal_btn_1cabx_552",wt="_modal_common_container_1cabx_587",i={admin_edit_profile_container:lt,admin_edit_profile_container_left:dt,admin_edit_profile_content_left:ct,admin_edit_profile_container_right:_t,edit_profile_btn:mt,upload_image_container:pt,admin_profile_loader:ut,profile_skeleton_img:ft,admin_edit_email_container:ht,admin_verified_icon:xt,admin_notverified_icon:bt,admin_edit_mobile_container:jt,admin_edit_gender_container:gt,modal_container:yt,modal_content_container:vt,edit_modal_btn:Ct,modal_common_container:wt},Lt=()=>{var le;const c=$e(),L=We(),n=j(t=>t.AdminLoggedInMiddleware.entiredata.user[0]),[m,fe]=s.useState(n==null?void 0:n.emailVerified),[p,he]=s.useState(n==null?void 0:n.mobileVerified),[g,K]=s.useState(""),[T,U]=s.useState(""),[y,G]=s.useState(""),[z,B]=s.useState(""),[xe,F]=s.useState("");s.useEffect(()=>{var t,a,o,u;n&&(B(`${(t=n==null?void 0:n.mobileCountryCode)==null?void 0:t.toString()}${(a=n==null?void 0:n.mobileNumber)==null?void 0:a.toString()}`),K(n==null?void 0:n.name),U((o=n==null?void 0:n.dateOfBirth)==null?void 0:o.split("T")[0]),G(n==null?void 0:n.gender),F((u=n==null?void 0:n.mobileCountryCode)==null?void 0:u.toString()))},[n]);const P=s.useRef(null),be=()=>{P.current.click()},[je,v]=s.useState(!1),ge=async t=>{var de,ce,_e;const a=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(a.type)){_.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const u=2*1024*1024;if(a.size>u){_.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const f=new FormData;f.append("email",n==null?void 0:n.email),f.append("profile",a),f.append("salonId",n==null?void 0:n.salonId);try{v(!0),await pe.post("/api/admin/uploadAdminProfilePicture",f,{headers:{"Content-Type":"multipart/form-data"}}),v(!1);const{data:d}=await pe.get("/api/admin/adminloggedin");c({type:Qe,payload:d}),_.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(d){if(v(!1),((de=d==null?void 0:d.response)==null?void 0:de.status)===500){_.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}_.error((_e=(ce=d==null?void 0:d.response)==null?void 0:ce.data)==null?void 0:_e.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},$=s.useRef(30),W="lastEmailVerificationTime",H=()=>{if(!m){const t=localStorage.getItem(W),a=Math.floor(Date.now()/1e3);if(t&&a-t<$.current){const o=$.current-(a-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(W,a),c(et(n==null?void 0:n.email,b))}},[r,C]=s.useState(["","","",""]),w=s.useRef([]),ye=(t,a)=>{const o=[...r];o[t]=a,a&&t<r.length-1&&w.current[t+1].focus(),C(o)},ve=(t,a)=>{if(a.key==="Backspace"&&t>0&&!r[t]){const o=[...r];o[t-1]="",w.current[t-1].focus(),C(o)}a.key==="Enter"&&Z()},Y=s.useRef(30),J="lastMobileVerificationTime",q=()=>{if(!p){const t=localStorage.getItem(J),a=Math.floor(Date.now()/1e3);if(t&&a-t<Y.current){const o=Y.current-(a-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(J,a),c(tt(n==null?void 0:n.email,x))}},[l,S]=s.useState(["","","",""]),k=s.useRef([]),Ce=(t,a)=>{const o=[...l];o[t]=a,a&&t<l.length-1&&k.current[t+1].focus(),S(o)},we=(t,a)=>{if(a.key==="Backspace"&&t>0&&!l[t]){const o=[...l];o[t-1]="",k.current[t-1].focus(),S(o)}a.key==="Enter"&&ee()},[Se,N]=s.useState(!1),ke=()=>{N(t=>!t)},E=t=>{G(t),N(!1)},[Ne,Q]=s.useState(!1),X=()=>{if(Ne)_.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,dateOfBirth:T,mobileNumber:Number(z),countryCode:Number(xe),name:g,gender:y};c(nt(t,L))}},h=t=>{t.key==="Enter"&&X()},O=t=>{t.key==="Enter"&&ae()},Z=()=>{const t=r==null?void 0:r.join("");c(at(n==null?void 0:n.email,t,b,C,fe))},ee=()=>{const t=l==null?void 0:l.join("");c(ot(n==null?void 0:n.email,t,x,S,he))},[te,Ee]=s.useState(""),[M,Oe]=s.useState(""),[ne,Me]=s.useState(""),De=j(t=>t.adminUpdateProfile),{loading:Ie}=De,ae=()=>{if(M!==ne)_.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:M,oldPassword:te};c(st(t,L))}},Ve=j(t=>t.adminUpdatePassword),{loading:Re}=Ve;j(He);const[oe,Ae]=s.useState(!1),[se,Le]=s.useState(!1),[ie,Ke]=s.useState(!1),re=Xe.PhoneNumberUtil.getInstance(),Te=t=>{try{return re.isValidNumber(re.parseAndKeepRawInput(t))}catch{return!1}},[Ue,Ge]=s.useState("gb"),ze=(t,a)=>{const{country:o,inputValue:u}=a;Te(t)?(B(t),F(o==null?void 0:o.dialCode),Ge(o==null?void 0:o.iso2),Q(!1)):Q(!0)},[Be,D]=s.useState(!1),[Fe,x]=s.useState(!1),[Pe,b]=s.useState(!1);return e.jsxs("main",{className:i.admin_edit_profile_container,children:[e.jsxs("div",{className:i.admin_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:i.admin_edit_profile_content_left,children:[e.jsxs("div",{children:[je?e.jsx(it,{variant:"rectangular",className:i.admin_profile_loader,style:{backgroundColor:!1}}):e.jsx("img",{src:(le=n==null?void 0:n.profile[0])==null?void 0:le.url,alt:"profile"}),e.jsx("button",{className:i.upload_image_container,onClick:()=>be(),children:e.jsx(Ye,{})}),e.jsx("input",{type:"file",ref:P,style:{display:"none"},onChange:ge})]}),e.jsx("p",{children:g}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:i.admin_edit_profile_container_right,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:g,onChange:t=>K(t.target.value),onKeyDown:h})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:i.admin_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0}),e.jsx("button",{onClick:()=>H(),className:m?i.admin_verified_icon:i.admin_notverified_icon,title:m?"Verified":"NotVerified",style:{cursor:m?"not-allowed":"pointer"},children:m?e.jsx(me,{}):e.jsx(I,{})})]})]}),e.jsx(A,{open:Pe,onClose:()=>b(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Je,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:r.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:o=>w.current[a]=o,onChange:o=>ye(a,o.target.value),onKeyDown:o=>ve(a,o)},a))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>H(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>b(!1),children:"Cancel"}),e.jsx("button",{onClick:Z,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>D(!0),readOnly:!0})]}),e.jsx(A,{open:Be,onClose:()=>D(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>D(!1),children:e.jsx(I,{})})]}),e.jsxs("div",{className:i.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${se?"text":"password"}`,value:te,onChange:t=>Ee(t.target.value),placeholder:"Enter Old Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Le(t=>!t),children:se?e.jsx(V,{}):e.jsx(R,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${oe?"text":"password"}`,value:M,onChange:t=>Oe(t.target.value),placeholder:"Enter New Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Ae(t=>!t),children:oe?e.jsx(V,{}):e.jsx(R,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${ie?"text":"password"}`,value:ne,onChange:t=>Me(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:O}),e.jsx("div",{onClick:()=>Ke(t=>!t),children:ie?e.jsx(V,{}):e.jsx(R,{})})]})]}),e.jsx("button",{className:i.edit_modal_btn,onClick:ae,children:Re?e.jsx(ue,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:i.admin_edit_mobile_container,children:[e.jsx("div",{onKeyDown:h,children:e.jsx(Ze,{forceDialCode:!0,defaultCountry:Ue,value:z,onChange:(t,a)=>ze(t,a)})}),e.jsx("button",{onClick:()=>q(),className:p?i.admin_verified_icon:i.admin_notverified_icon,title:p?"Verified":"NotVerified",style:{cursor:p?"not-allowed":"pointer"},children:p?e.jsx(me,{}):e.jsx(I,{})})]})]}),e.jsx(A,{open:Fe,onClose:()=>x(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(qe,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#0866ff"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:l.map((t,a)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:a===0,ref:o=>k.current[a]=o,onChange:o=>Ce(a,o.target.value),onKeyDown:o=>we(a,o)},a))}),e.jsxs("p",{children:["Didn't get the code ?",e.jsx("span",{onClick:()=>q(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>x(!1),children:"Cancel"}),e.jsx("button",{onClick:ee,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:T,onChange:t=>U(t.target.value),onKeyDown:h})]}),e.jsxs("div",{className:i.admin_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${y?`${y}`:""}`,onClick:()=>ke(),readOnly:!0,onKeyDown:h}),Se&&e.jsx(rt,{onClickAway:()=>N(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>E("Male"),children:"Male"}),e.jsx("p",{onClick:()=>E("Female"),children:"Female"}),e.jsx("p",{onClick:()=>E("Other"),children:"Other"})]})})]}),e.jsx("button",{className:i.edit_profile_btn,onClick:X,children:Ie?e.jsx(ue,{}):"Save"})]})]})};export{Lt as default};
