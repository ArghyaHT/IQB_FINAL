import{u as c,a as W,r as t,d as D,j as r,B as J,G as V,C as F,_ as G}from"./index-smej7xwq.js";import{S as y}from"./index-BfDBZXgS.js";import{a as K}from"./DashboardAction-GMMXnGT7.js";import{a as U,b as X}from"./QueueAction-CGucpbmL.js";import{g as Y}from"./BarberAction-B1rG4jqV.js";import{B as Z}from"./ButtonLoader-BLdiC7PJ.js";import{M as ee}from"./Modal-CbCgZbhR.js";import"./index-CtLL9ryC.js";import"./clsx-B-dksMZM.js";import"./getReactElementRef-CSb6vkGd.js";const re="_admin_queue_wrapper_6vpzq_1",oe="_customer_search_6vpzq_27",ne="_admin_queue_content_wrapper_6vpzq_65",ae="_admin_queue_content_body_6vpzq_75",te="_admin_queue_content_body_item_6vpzq_140",se="_admin_queue_content_body_error_6vpzq_223",de="_modal_container_6vpzq_236",ie="_modal_content_container_6vpzq_302",le="_barber_dropdown_loading_6vpzq_318",ce="_barber_dropdown_6vpzq_318",_e="_barber_dropdown_error_6vpzq_345",me="_choose_barber_dropdown_item_6vpzq_398",ue="_barber_online_dot_6vpzq_427",he="_barber_select_6vpzq_458",pe="_dark_6vpzq_464",o={admin_queue_wrapper:re,customer_search:oe,admin_queue_content_wrapper:ne,admin_queue_content_body:ae,admin_queue_content_body_item:te,admin_queue_content_body_error:se,modal_container:de,modal_content_container:ie,barber_dropdown_loading:le,barber_dropdown:ce,barber_dropdown_error:_e,choose_barber_dropdown_item:me,barber_online_dot:ue,barber_select:he,dark:pe},Se=()=>{const s=c(e=>e.AdminLoggedInMiddleware.adminSalonId),x=c(e=>e.AdminLoggedInMiddleware.adminEmail),_=W(),p=t.useRef(new AbortController);t.useEffect(()=>{const e=new AbortController;return p.current=e,_(K(s,e.signal)),()=>{p.current&&p.current.abort()}},[s,_]);const A=c(e=>e.getAllQueueList),{loading:S,resolve:N,queueList:d}=A,[i,b]=t.useState([]);t.useEffect(()=>{d&&b(d)},[d]);const[g,Q]=t.useState(""),L=e=>{Q(e);const a=e.toLowerCase().trim();b(g?l=>d==null?void 0:d.filter(k=>k.name.toLowerCase().includes(a)||k.barberName.toLowerCase().includes(a)):d)},n=c(D)==="On",$=e=>{if(e.qPosition!==1)return G.error("Queue position is not 1",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const a=window.confirm("Are you Sure ?"),l={adminEmail:x,barberId:e.barberId,salonId:s,services:e.services,_id:e._id};a&&(q(e==null?void 0:e.barberName),w(e==null?void 0:e.barberEmail),h({open:!0,data:l}))},z=e=>{const a=window.confirm("Are you Sure ?"),l={adminEmail:x,barberId:e.barberId,salonId:s,_id:e._id};a&&_(U(l,s))},B=c(e=>e.adminServeQueue),{loading:j}=B,E=c(e=>e.adminCancelQueue),{loading:I}=E,[f,h]=t.useState({open:!1,data:{}}),[R,q]=t.useState(""),[C,w]=t.useState(""),v=t.useRef(new AbortController);t.useEffect(()=>{const e=new AbortController;return v.current=e,_(Y(s,e.signal)),()=>{v.current&&v.current.abort()}},[s,_]);const T=c(e=>e.getAdminBarberList),{loading:M,resolve:O,getAllBarbers:u}=T,[m,H]=t.useState([]);t.useEffect(()=>{if(u){const e=u==null?void 0:u.filter(a=>a.isClockedIn);H(e)}},[u]);const P=()=>{const e={...f.data,servedByEmail:C};_(X(e,s,h))};return r.jsxs("div",{className:`${o.admin_queue_wrapper} ${n&&o.dark}`,children:[r.jsxs("div",{children:[r.jsx("p",{children:"Queue List"}),r.jsxs("div",{className:`${o.customer_search} ${n&&o.dark}`,children:[r.jsx("input",{type:"text",placeholder:"Search Queue",value:g,onChange:e=>L(e.target.value)}),r.jsx("div",{children:r.jsx(J,{})})]})]}),r.jsx("div",{className:`${o.admin_queue_content_wrapper} ${n&&o.dark}`,children:S?r.jsx("div",{className:o.admin_queue_content_body,children:r.jsx(y,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:n?"var(--dark-loader-bg-color)":"var(--light-loader-bg-color)",highlightColor:n?"var(--dark-loader-highlight-color)":"var(--light-loader-highlight-color)"})}):N&&(i==null?void 0:i.length)>0?r.jsx(r.Fragment,{children:r.jsxs("div",{className:`${o.admin_queue_content_body} ${n&&o.dark}`,children:[r.jsxs("div",{children:[r.jsx("p",{children:"#"}),r.jsx("p",{children:"Name"}),r.jsx("p",{children:"Barber Name"}),r.jsx("p",{children:"Time Joined Q"}),r.jsx("div",{children:r.jsx("p",{children:"Qg Code"})}),r.jsx("div",{children:r.jsx("p",{children:"EWT"})}),r.jsx("div",{children:r.jsx("p",{children:"Type"})}),r.jsx("div",{children:r.jsx("p",{children:"Serve"})}),r.jsx("div",{children:r.jsx("p",{children:"Cancel"})})]}),i==null?void 0:i.map((e,a)=>r.jsxs("div",{className:`${o.admin_queue_content_body_item} ${n&&o.dark}`,style:{borderBottom:i.length-1===a&&"none"},children:[r.jsx("p",{children:e.qPosition===1?"Next":e.qPosition}),r.jsx("p",{children:e.name.length>18?e.name.slice(0,18)+"...":e.name}),r.jsx("p",{children:e.barberName.length>18?e.barberName.slice(0,18)+"...":e.barberName}),r.jsx("p",{children:e.timeJoinedQ}),r.jsx("p",{children:e==null?void 0:e.qgCode}),r.jsxs("p",{children:[e==null?void 0:e.customerEWT," mins"]}),r.jsx("div",{children:e.serviceType==="VIP"?r.jsx(V,{}):"-"}),r.jsx("div",{children:r.jsx("button",{onClick:()=>$(e),disabled:j,children:"Serve"})}),r.jsx("div",{children:r.jsx("button",{onClick:()=>z(e),disabled:I,children:"Cancel"})})]},e._id))]})}):r.jsx("div",{className:`${o.admin_queue_content_body_error} ${n&&o.dark}`,children:r.jsx("p",{children:"Queue not available"})})}),r.jsx(ee,{open:f.open,onClose:()=>h({open:!1,data:{}}),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:r.jsxs("div",{className:`${o.modal_container} ${n&&o.dark}`,children:[r.jsxs("div",{children:[r.jsx("p",{children:"Choose Barber"}),r.jsx("button",{onClick:()=>h({open:!1,data:{}}),children:r.jsx(F,{})})]}),r.jsxs("div",{className:`${o.modal_content_container} ${n&&o.dark}`,children:[r.jsx("input",{type:"text",value:R,placeholder:"Choose Barber",readOnly:!0}),M?r.jsx("div",{className:o.barber_dropdown_loading,children:r.jsx(y,{count:3,height:"6rem",style:{marginBottom:"1rem"},baseColor:n?"var(--dark-loader-bg-color)":"var(--light-loader-bg-color)",highlightColor:n?"var(--dark-loader-highlight-color)":"var(--light-loader-highlight-color)"})}):O&&(m==null?void 0:m.length)>0?r.jsx("div",{className:o.barber_dropdown,children:m==null?void 0:m.map(e=>{var a,l;return r.jsxs("div",{className:`${o.choose_barber_dropdown_item} ${C===(e==null?void 0:e.email)&&o.barber_select} ${n&&o.dark}`,onClick:()=>{w(e==null?void 0:e.email),q(e==null?void 0:e.name)},style:{borderLeft:e.isOnline?"0.5rem solid limegreen":"0.5rem solid red"},children:[r.jsxs("div",{children:[r.jsx("img",{src:(l=(a=e==null?void 0:e.profile)==null?void 0:a[0])==null?void 0:l.url,alt:"img"}),r.jsx("div",{className:o.barber_online_dot,style:{backgroundColor:e.isOnline?"limegreen":"red"}})]}),r.jsxs("div",{children:[r.jsx("p",{children:e.name}),r.jsxs("p",{children:["Queue Count : ",e.queueCount]}),r.jsxs("p",{children:["EWT : ",e.barberEWT," mins"]})]})]},e._id)})}):r.jsx("div",{className:o.barber_dropdown_error,children:r.jsx("p",{children:"No barbers available"})})]}),j?r.jsx("button",{style:{display:"grid",placeItems:"center"},children:r.jsx(Z,{})}):r.jsx("button",{onClick:P,children:"Serve"})]})})]})};export{Se as default};
