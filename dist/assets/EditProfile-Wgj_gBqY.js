import{a as ot,b as nt,u as C,r as n,d as at,j as e,a5 as it,aF as Ce,C as T,aG as dt,E as K,N as U,aH as lt,_ as i,x as Se,aI as ct}from"./index-DFA1I3My.js";import{l as mt,U as ut}from"./libphonenumber-CeUCoWG7.js";import{a as _t,b as ft,c as pt,d as ht,e as gt,f as bt}from"./AdminProfileAction-DPOJbcg9.js";import{B as ke}from"./ButtonLoader-CqmVXasV.js";import{g as jt}from"./Date-DmpXR4AF.js";import{S as xt}from"./Skeleton-owwBF5T7.js";import{M as G}from"./Modal-BLjR6DhA.js";import{C as yt}from"./ClickAwayListener-BdfX5FXh.js";import"./clsx-B-dksMZM.js";import"./index-Bbe9fXw9.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-BUcxukNm.js";const vt="_admin_edit_profile_container_1secg_1",wt="_admin_edit_profile_container_left_1secg_18",Ct="_admin_edit_profile_content_left_1secg_31",St="_admin_edit_profile_container_right_1secg_37",kt="_edit_profile_btn_1secg_72",Nt="_upload_image_container_1secg_132",Et="_admin_profile_loader_1secg_172",Ot="_profile_skeleton_img_1secg_182",Mt="_admin_edit_email_container_1secg_188",zt="_admin_verified_icon_1secg_227",It="_admin_notverified_icon_1secg_244",$t="_admin_edit_mobile_container_1secg_261",Dt="_admin_edit_gender_container_1secg_330",Rt="_modal_container_1secg_373",Vt="_modal_content_container_1secg_439",Pt="_edit_modal_btn_1secg_484",At="_modal_common_container_1secg_519",Lt="_error_message_1secg_652",Tt="_dark_1secg_660",a={admin_edit_profile_container:vt,admin_edit_profile_container_left:wt,admin_edit_profile_content_left:Ct,admin_edit_profile_container_right:St,edit_profile_btn:kt,upload_image_container:Nt,admin_profile_loader:Et,profile_skeleton_img:Ot,admin_edit_email_container:Mt,admin_verified_icon:zt,admin_notverified_icon:It,admin_edit_mobile_container:$t,admin_edit_gender_container:Dt,modal_container:Rt,modal_content_container:Vt,edit_modal_btn:Pt,modal_common_container:At,error_message:Lt,dark:Tt},es=()=>{var xe;const _=ot(),B=nt(),s=C(t=>t.AdminLoggedInMiddleware.entiredata.user[0]),[f,Ne]=n.useState(s==null?void 0:s.emailVerified),[p,Ee]=n.useState(s==null?void 0:s.mobileVerified),[l,F]=n.useState(""),[W,H]=n.useState(""),[S,Y]=n.useState(""),[q,J]=n.useState(""),[Oe,Q]=n.useState("");n.useEffect(()=>{var t,r,o,g;s&&(J(`${(t=s==null?void 0:s.mobileCountryCode)==null?void 0:t.toString()}${(r=s==null?void 0:s.mobileNumber)==null?void 0:r.toString()}`),F(s==null?void 0:s.name),H((o=s==null?void 0:s.dateOfBirth)==null?void 0:o.split("T")[0]),Y(s==null?void 0:s.gender),Q((g=s==null?void 0:s.mobileCountryCode)==null?void 0:g.toString()))},[s]);const X=n.useRef(null),Me=()=>{X.current.click()},[ze,k]=n.useState(!1),Ie=async t=>{var ye,ve,we;const r=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(r.type)){i.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const g=2*1024*1024;if(r.size>g){i.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const b=new FormData;b.append("email",s==null?void 0:s.email),b.append("profile",r),b.append("salonId",s==null?void 0:s.salonId);try{k(!0),await Se.post("/api/admin/uploadAdminProfilePicture",b,{headers:{"Content-Type":"multipart/form-data"}}),k(!1);const{data:u}=await Se.get("/api/admin/adminloggedin");_({type:ct,payload:u}),i.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(u){if(k(!1),((ye=u==null?void 0:u.response)==null?void 0:ye.status)===500){i.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}i.error((we=(ve=u==null?void 0:u.response)==null?void 0:ve.data)==null?void 0:we.message,{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},Z=n.useRef(30),ee="lastEmailVerificationTime",te=()=>{if(!f){const t=localStorage.getItem(ee),r=Math.floor(Date.now()/1e3);if(t&&r-t<Z.current){const o=Z.current-(r-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(ee,r),_(_t(s==null?void 0:s.email,w))}},[c,N]=n.useState(["","","",""]),E=n.useRef([]),$e=(t,r)=>{const o=[...c];o[t]=r,r&&t<c.length-1&&E.current[t+1].focus(),N(o)},De=(t,r)=>{if(r.key==="Backspace"&&t>0&&!c[t]){const o=[...c];o[t-1]="",E.current[t-1].focus(),N(o)}r.key==="Enter"&&le()},se=n.useRef(30),re="lastMobileVerificationTime",oe=()=>{if(!p){const t=localStorage.getItem(re),r=Math.floor(Date.now()/1e3);if(t&&r-t<se.current){const o=se.current-(r-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(re,r),_(ft(s==null?void 0:s.email,v))}},[m,O]=n.useState(["","","",""]),M=n.useRef([]),Re=(t,r)=>{const o=[...m];o[t]=r,r&&t<m.length-1&&M.current[t+1].focus(),O(o)},Ve=(t,r)=>{if(r.key==="Backspace"&&t>0&&!m[t]){const o=[...m];o[t-1]="",M.current[t-1].focus(),O(o)}r.key==="Enter"&&ce()},[Pe,z]=n.useState(!1),Ae=()=>{z(t=>!t)},I=t=>{Y(t),z(!1)},[Le,$]=n.useState(!1),[ne,ae]=n.useState(""),[ie,Te]=n.useState(""),de=()=>{if(l.length===0||l.length>20)return i.error("Name must be between 1 to 20 characters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),ae("Name must be between 1 to 20 characters");if(Le)return i.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),Te("Invalid Number");const t={email:s==null?void 0:s.email,dateOfBirth:W,mobileNumber:Number(q),countryCode:Number(Oe),name:l,gender:S};_(pt(t,B))},j=t=>{t.key==="Enter"&&de()},D=t=>{t.key==="Enter"&&pe()},le=()=>{const t=c==null?void 0:c.join("");_(ht(s==null?void 0:s.email,t,w,N,Ne))},ce=()=>{const t=m==null?void 0:m.join("");_(gt(s==null?void 0:s.email,t,v,O,Ee))},[x,Ke]=n.useState(""),[h,Ue]=n.useState(""),[y,Ge]=n.useState(""),Be=C(t=>t.adminUpdateProfile),{loading:Fe}=Be,[me,R]=n.useState(""),[ue,V]=n.useState(""),[_e,P]=n.useState(""),[fe,A]=n.useState(""),pe=()=>{if(!x)return i.error("Please enter password",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),R("Please enter old password");if(x.length<8)return i.error("Password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),R("Old password length must be 8 charecters");if(!h)return i.error("Please enter password",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),V("Please enter new password");if(h.length<8)return i.error("Password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),V("New password length must be 8 charecters");if(!y)return i.error("Please enter confirm password",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),P("Please enter confirm password");if(y.length<8)return i.error("Confirm password length must be 8 charecters",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),P("Confirm password length must be 8 charecters");if(h!==y)return i.error("Password and confirm password do not match",{duration:3e3,style:{fontSize:"var(--font-size-2)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),A("Password and confirm password do not match");const t={email:s==null?void 0:s.email,password:h,oldPassword:x};_(bt(t,B))},We=C(t=>t.adminUpdatePassword),{loading:He}=We,d=C(at)==="On",[he,Ye]=n.useState(!1),[ge,qe]=n.useState(!1),[be,Je]=n.useState(!1),je=mt.PhoneNumberUtil.getInstance(),Qe=t=>{try{return je.isValidNumber(je.parseAndKeepRawInput(t))}catch{return!1}},[Xe,Ze]=n.useState("gb"),et=(t,r)=>{$("");const{country:o,inputValue:g}=r;Qe(t)?(J(t),Q(o==null?void 0:o.dialCode),Ze(o==null?void 0:o.iso2),$(!1)):$(!0)},[tt,L]=n.useState(!1),[st,v]=n.useState(!1),[rt,w]=n.useState(!1);return n.useEffect(()=>{const t=document.querySelector(".react-international-phone-input-container .react-international-phone-input");t&&(t.style.color=d?"var(--light-color-4)":"var(--light-color-2)")},[d]),e.jsxs("main",{className:`${a.admin_edit_profile_container} ${d&&a.dark}`,children:[e.jsxs("div",{className:a.admin_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:`${a.admin_edit_profile_content_left} ${d&&a.dark}`,children:[e.jsxs("div",{children:[ze?e.jsx(xt,{variant:"rectangular",className:a.admin_profile_loader,style:{backgroundColor:!1}}):e.jsx("img",{src:(xe=s==null?void 0:s.profile[0])==null?void 0:xe.url,alt:"profile"}),e.jsx("button",{className:a.upload_image_container,onClick:()=>Me(),children:e.jsx(it,{})}),e.jsx("input",{type:"file",ref:X,style:{display:"none"},onChange:Ie})]}),e.jsx("p",{children:(l==null?void 0:l.length)>20?`${l.slice(0,20)}...`:l}),e.jsx("p",{children:s==null?void 0:s.email})]})]}),e.jsxs("div",{className:`${a.admin_edit_profile_container_right}  ${d&&a.dark}`,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:l,onChange:t=>{ae(""),F(t.target.value)},onKeyDown:j,style:{border:ne?"0.1rem solid red":"none"}}),e.jsx("p",{className:a.error_message,children:ne})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:`${a.admin_edit_email_container} ${d&&a.dark}`,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:s==null?void 0:s.email,readOnly:!0}),e.jsx("button",{onClick:()=>te(),className:f?a.admin_verified_icon:a.admin_notverified_icon,title:f?"Verified":"NotVerified",style:{cursor:f?"not-allowed":"pointer"},children:f?e.jsx(Ce,{}):e.jsx(T,{})})]})]}),e.jsx(G,{open:rt,onClose:()=>w(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:`${a.modal_common_container} ${d&&a.dark}`,children:[e.jsx("div",{children:e.jsx(dt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600"},children:s==null?void 0:s.email})]}),e.jsx("div",{children:c.map((t,r)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:r===0,ref:o=>E.current[r]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&$e(r,o.target.value)},onKeyDown:o=>De(r,o)},r))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>te(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>w(!1),children:"Cancel"}),e.jsx("button",{onClick:le,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>L(!0),readOnly:!0})]}),e.jsx(G,{open:tt,onClose:()=>L(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:`${a.modal_container} ${d&&a.dark}`,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>L(!1),children:e.jsx(T,{})})]}),e.jsxs("div",{className:a.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{style:{border:me?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${ge?"text":"password"}`,value:x,onChange:t=>{R(""),Ke(t.target.value)},placeholder:"Enter Old Password",onKeyDown:D}),e.jsx("div",{onClick:()=>qe(t=>!t),children:ge?e.jsx(K,{}):e.jsx(U,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:me})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{style:{border:ue?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${he?"text":"password"}`,value:h,onChange:t=>{A(""),V(""),Ue(t.target.value)},placeholder:"Enter New Password",onKeyDown:D}),e.jsx("div",{onClick:()=>Ye(t=>!t),children:he?e.jsx(K,{}):e.jsx(U,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:ue})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{style:{border:_e||fe?"0.1rem solid red":void 0},children:[e.jsx("input",{type:`${be?"text":"password"}`,value:y,onChange:t=>{A(""),P(""),Ge(t.target.value)},placeholder:"Enter Confirm Password",onKeyDown:D}),e.jsx("div",{onClick:()=>Je(t=>!t),children:be?e.jsx(K,{}):e.jsx(U,{})})]}),e.jsx("p",{className:a.error_message,style:{marginTop:"1rem"},children:_e||fe})]}),e.jsx("button",{className:a.edit_modal_btn,onClick:pe,children:He?e.jsx(ke,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:`${a.admin_edit_mobile_container} ${d&&a.dark}`,style:{outline:ie&&"0.1rem solid red"},children:[e.jsx("div",{onKeyDown:j,children:e.jsx(ut,{forceDialCode:!0,defaultCountry:Xe,value:q,onChange:(t,r)=>et(t,r)})}),e.jsx("button",{onClick:()=>oe(),className:p?a.admin_verified_icon:a.admin_notverified_icon,title:p?"Verified":"NotVerified",style:{cursor:p?"not-allowed":"pointer"},children:p?e.jsx(Ce,{}):e.jsx(T,{})})]}),e.jsx("p",{className:a.error_message,children:ie})]}),e.jsx(G,{open:st,onClose:()=>v(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:`${a.modal_common_container} ${d&&a.dark}`,children:[e.jsx("div",{children:e.jsx(lt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600"},children:s==null?void 0:s.mobileNumber})]}),e.jsx("div",{children:m.map((t,r)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:r===0,ref:o=>M.current[r]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Re(r,o.target.value)},onKeyDown:o=>Ve(r,o)},r))}),e.jsxs("p",{children:["Didn't get the code ?",e.jsx("span",{onClick:()=>oe(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>v(!1),children:"Cancel"}),e.jsx("button",{onClick:ce,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:W,onChange:t=>H(t.target.value),onKeyDown:j,max:jt(),style:{colorScheme:d?"dark":"light"}})]}),e.jsxs("div",{className:`${a.admin_edit_gender_container} ${d&&a.dark}`,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${S?`${S}`:""}`,onClick:()=>Ae(),readOnly:!0,onKeyDown:j}),Pe&&e.jsx(yt,{onClickAway:()=>z(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>I("Male"),children:"Male"}),e.jsx("p",{onClick:()=>I("Female"),children:"Female"}),e.jsx("p",{onClick:()=>I("Other"),children:"Other"})]})})]}),e.jsx("button",{className:a.edit_profile_btn,onClick:de,children:Fe?e.jsx(ke,{}):"Save"})]})]})};export{es as default};
