import{A,p as g,q as k,_ as u,t as S,v as h,w as C,x as I,y as b,b as m,u as L,r as v,d as R,j as a,z as N}from"./index-DOAdIdml.js";import{S as U}from"./index-DuU_Esms.js";import{a as $}from"./DashboardAction-Dhb_npE8.js";const D="_admin_queue_wrapper_1qkef_1",B="_admin_queue_content_wrapper_1qkef_29",M="_admin_queue_content_body_1qkef_39",z="_admin_queue_content_body_item_1qkef_129",T="_admin_queue_content_body_error_1qkef_208",P="_modal_container_1qkef_221",r={admin_queue_wrapper:D,admin_queue_content_wrapper:B,admin_queue_content_body:M,admin_queue_content_body_item:z,admin_queue_content_body_error:T,modal_container:P},V=(t,_)=>async o=>{var s,c,d,i;try{o({type:A});const{data:e}=await g.post("/api/queue/barberServedQueue",t);o({type:k,payload:e}),u.success("Customer serve successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const{data:f}=await g.get(`/api/queue/getQListBySalonId?salonId=${_}`);o({type:S,payload:f})}catch(e){if(((s=e==null?void 0:e.response)==null?void 0:s.status)===500){o({type:h,payload:"Something went wrong !"}),u.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}o({type:h,payload:(c=e==null?void 0:e.response)==null?void 0:c.data}),u.error((i=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:i.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},F=(t,_)=>async o=>{var s,c,d,i;try{o({type:C});const{data:e}=await g.post("/api/queue/cancelQ",t);o({type:I,payload:e}),u.success("Customer cancel successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const{data:f}=await g.get(`/api/queue/getQListBySalonId?salonId=${_}`);o({type:S,payload:f})}catch(e){if(((s=e==null?void 0:e.response)==null?void 0:s.status)===500){o({type:b,payload:"Something went wrong !"}),u.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}o({type:b,payload:(c=e==null?void 0:e.response)==null?void 0:c.data}),u.error((i=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:i.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},G=()=>{const t=m(n=>n.AdminLoggedInMiddleware.adminSalonId),_=m(n=>n.AdminLoggedInMiddleware.adminEmail),o=L(),s=v.useRef(new AbortController);v.useEffect(()=>{const n=new AbortController;return s.current=n,o($(t,n.signal)),()=>{s.current&&s.current.abort()}},[t,o]);const c=m(n=>n.getAllQueueList),{loading:d,resolve:i,queueList:e}=c,l=m(R)==="On",E=n=>{if(n.qPosition!==1)return u.error("Queue position is not 1",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});const p=window.confirm("Are you Sure ?"),y={adminEmail:_,barberId:n.barberId,salonId:t,services:n.services,_id:n._id};p&&o(V(y,t))},q=n=>{const p=window.confirm("Are you Sure ?"),y={adminEmail:_,barberId:n.barberId,salonId:t,_id:n._id};p&&o(F(y,t))},x=m(n=>n.adminServeQueue),{loading:Q}=x,j=m(n=>n.adminCancelQueue),{loading:w}=j;return a.jsxs("div",{className:`${r.admin_queue_wrapper} ${l&&r.dark}`,children:[a.jsx("div",{children:a.jsx("p",{children:"Queue List"})}),a.jsx("div",{className:`${r.admin_queue_content_wrapper} ${l&&r.dark}`,children:d&&!i?a.jsx("div",{className:r.admin_queue_content_body,children:a.jsx(U,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:l?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:l?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):!d&&i&&(e==null?void 0:e.length)>0?a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${r.admin_queue_content_body} ${l&&r.dark}`,children:[a.jsxs("div",{children:[a.jsx("p",{children:"Name"}),a.jsx("p",{children:"Time Joined Q"}),a.jsx("p",{children:"Barber Name"}),a.jsx("p",{children:"Q Postion"}),a.jsx("p",{children:"Type"}),a.jsx("p",{children:"Serve"}),a.jsx("p",{children:"Cancel"})]}),e==null?void 0:e.map((n,p)=>a.jsxs("div",{className:`${r.admin_queue_content_body_item} ${l&&r.dark}`,style:{borderBottom:e.length-1===p&&"none"},children:[a.jsx("p",{children:n.name.length>18?n.name.slice(0,18)+"...":n.name}),a.jsx("p",{children:n.timeJoinedQ}),a.jsx("p",{children:n.barberName.length>18?n.barberName.slice(0,18)+"...":n.barberName}),a.jsx("p",{children:n.qPosition}),a.jsx("div",{children:n.serviceType==="VIP"?a.jsx(N,{}):"-"}),a.jsx("div",{children:a.jsx("button",{onClick:()=>E(n),disabled:Q,children:"Serve"})}),a.jsx("div",{children:a.jsx("button",{onClick:()=>q(n),disabled:w,children:"Cancel"})})]},n._id))]})}):!d&&i&&(e==null?void 0:e.length)==0?a.jsx("div",{className:`${r.admin_queue_content_body_error} ${l&&r.dark}`,children:a.jsx("p",{children:"Queue not available"})}):!d&&!i&&a.jsx("div",{className:`${r.admin_queue_content_body_error} ${l&&r.dark}`,children:a.jsx("p",{children:"Queue not available"})})})]})};export{G as default};
