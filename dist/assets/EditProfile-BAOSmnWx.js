import{u as Je,a as qe,b,r as s,d as Qe,j as e,a0 as Xe,aA as fe,C as V,aB as Ze,E as R,N as A,aC as et,_ as m,p as he,aD as tt}from"./index-u-AATrzO.js";import{l as nt,U as ot}from"./libphonenumber-jOZUm_53.js";import{a as at,b as st,c as it,d as rt,e as lt,f as dt}from"./AdminProfileAction--p75dOFx.js";import{B as ge}from"./ButtonLoader-CR5N2D0l.js";import{S as ct}from"./Skeleton-Bl1IUrm_.js";import{M as L}from"./Modal-ghuyP4Rw.js";import{C as mt}from"./ClickAwayListener-D5K8AY6H.js";import"./clsx-B-dksMZM.js";import"./index-pYybFpgN.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-CWP5Jz8O.js";const _t="_admin_edit_profile_container_1op7d_1",pt="_admin_edit_profile_container_left_1op7d_18",ut="_admin_edit_profile_content_left_1op7d_31",ft="_admin_edit_profile_container_right_1op7d_70",ht="_edit_profile_btn_1op7d_138",gt="_upload_image_container_1op7d_198",jt="_admin_profile_loader_1op7d_243",xt="_profile_skeleton_img_1op7d_253",bt="_admin_edit_email_container_1op7d_259",vt="_admin_verified_icon_1op7d_298",yt="_admin_notverified_icon_1op7d_315",Ct="_admin_edit_mobile_container_1op7d_332",wt="_admin_edit_gender_container_1op7d_401",St="_modal_container_1op7d_444",kt="_modal_content_container_1op7d_510",Nt="_edit_modal_btn_1op7d_555",Et="_modal_common_container_1op7d_590",Ot="_error_message_1op7d_725",i={admin_edit_profile_container:_t,admin_edit_profile_container_left:pt,admin_edit_profile_content_left:ut,admin_edit_profile_container_right:ft,edit_profile_btn:ht,upload_image_container:gt,admin_profile_loader:jt,profile_skeleton_img:xt,admin_edit_email_container:bt,admin_verified_icon:vt,admin_notverified_icon:yt,admin_edit_mobile_container:Ct,admin_edit_gender_container:wt,modal_container:St,modal_content_container:kt,edit_modal_btn:Nt,modal_common_container:Et,error_message:Ot},zt=()=>{var me;const _=Je(),K=qe(),n=b(t=>t.AdminLoggedInMiddleware.entiredata.user[0]),[p,je]=s.useState(n==null?void 0:n.emailVerified),[u,xe]=s.useState(n==null?void 0:n.mobileVerified),[r,T]=s.useState(""),[U,$]=s.useState(""),[v,z]=s.useState(""),[B,G]=s.useState(""),[be,P]=s.useState("");s.useEffect(()=>{var t,o,a,f;n&&(G(`${(t=n==null?void 0:n.mobileCountryCode)==null?void 0:t.toString()}${(o=n==null?void 0:n.mobileNumber)==null?void 0:o.toString()}`),T(n==null?void 0:n.name),$((a=n==null?void 0:n.dateOfBirth)==null?void 0:a.split("T")[0]),z(n==null?void 0:n.gender),P((f=n==null?void 0:n.mobileCountryCode)==null?void 0:f.toString()))},[n]);const F=s.useRef(null),ve=()=>{F.current.click()},[ye,y]=s.useState(!1),Ce=async t=>{var _e,pe,ue;const o=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(o.type)){m.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const f=2*1024*1024;if(o.size>f){m.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const h=new FormData;h.append("email",n==null?void 0:n.email),h.append("profile",o),h.append("salonId",n==null?void 0:n.salonId);try{y(!0),await he.post("/api/admin/uploadAdminProfilePicture",h,{headers:{"Content-Type":"multipart/form-data"}}),y(!1);const{data:c}=await he.get("/api/admin/adminloggedin");_({type:tt,payload:c}),m.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(c){if(y(!1),((_e=c==null?void 0:c.response)==null?void 0:_e.status)===500){m.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}m.error((ue=(pe=c==null?void 0:c.response)==null?void 0:pe.data)==null?void 0:ue.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},W=s.useRef(30),H="lastEmailVerificationTime",Y=()=>{if(!p){const t=localStorage.getItem(H),o=Math.floor(Date.now()/1e3);if(t&&o-t<W.current){const a=W.current-(o-t);alert(`Please wait ${a} seconds before resending.`);return}localStorage.setItem(H,o),_(at(n==null?void 0:n.email,x))}},[l,C]=s.useState(["","","",""]),w=s.useRef([]),we=(t,o)=>{const a=[...l];a[t]=o,o&&t<l.length-1&&w.current[t+1].focus(),C(a)},Se=(t,o)=>{if(o.key==="Backspace"&&t>0&&!l[t]){const a=[...l];a[t-1]="",w.current[t-1].focus(),C(a)}o.key==="Enter"&&ne()},J=s.useRef(30),q="lastMobileVerificationTime",Q=()=>{if(!u){const t=localStorage.getItem(q),o=Math.floor(Date.now()/1e3);if(t&&o-t<J.current){const a=J.current-(o-t);alert(`Please wait ${a} seconds before resending.`);return}localStorage.setItem(q,o),_(st(n==null?void 0:n.email,j))}},[d,S]=s.useState(["","","",""]),k=s.useRef([]),ke=(t,o)=>{const a=[...d];a[t]=o,o&&t<d.length-1&&k.current[t+1].focus(),S(a)},Ne=(t,o)=>{if(o.key==="Backspace"&&t>0&&!d[t]){const a=[...d];a[t-1]="",k.current[t-1].focus(),S(a)}o.key==="Enter"&&oe()},[Ee,N]=s.useState(!1),Oe=()=>{N(t=>!t)},E=t=>{z(t),N(!1)},[Me,O]=s.useState(!1),[X,Z]=s.useState(""),[ee,De]=s.useState(""),te=()=>{if(r.length===0||r.length>20)return m.error("Name must be between 1 to 20 characters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),Z("Name must be between 1 to 20 characters");if(Me)return m.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),De("Invalid Number");const t={email:n==null?void 0:n.email,dateOfBirth:U,mobileNumber:Number(B),countryCode:Number(be),name:r,gender:v};_(it(t,K))},g=t=>{t.key==="Enter"&&te()},M=t=>{t.key==="Enter"&&ie()},ne=()=>{const t=l==null?void 0:l.join("");_(rt(n==null?void 0:n.email,t,x,C,je))},oe=()=>{const t=d==null?void 0:d.join("");_(lt(n==null?void 0:n.email,t,j,S,xe))},[ae,Ie]=s.useState(""),[D,Ve]=s.useState(""),[se,Re]=s.useState(""),Ae=b(t=>t.adminUpdateProfile),{loading:Le}=Ae,ie=()=>{if(D!==se)m.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:D,oldPassword:ae};_(dt(t,K))}},Ke=b(t=>t.adminUpdatePassword),{loading:Te}=Ke;b(Qe);const[re,Ue]=s.useState(!1),[le,$e]=s.useState(!1),[de,ze]=s.useState(!1),ce=nt.PhoneNumberUtil.getInstance(),Be=t=>{try{return ce.isValidNumber(ce.parseAndKeepRawInput(t))}catch{return!1}},[Ge,Pe]=s.useState("gb"),Fe=(t,o)=>{O("");const{country:a,inputValue:f}=o;Be(t)?(G(t),P(a==null?void 0:a.dialCode),Pe(a==null?void 0:a.iso2),O(!1)):O(!0)},[We,I]=s.useState(!1),[He,j]=s.useState(!1),[Ye,x]=s.useState(!1);return e.jsxs("main",{className:i.admin_edit_profile_container,children:[e.jsxs("div",{className:i.admin_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:i.admin_edit_profile_content_left,children:[e.jsxs("div",{children:[ye?e.jsx(ct,{variant:"rectangular",className:i.admin_profile_loader,style:{backgroundColor:!1}}):e.jsx("img",{src:(me=n==null?void 0:n.profile[0])==null?void 0:me.url,alt:"profile"}),e.jsx("button",{className:i.upload_image_container,onClick:()=>ve(),children:e.jsx(Xe,{})}),e.jsx("input",{type:"file",ref:F,style:{display:"none"},onChange:Ce})]}),e.jsx("p",{children:(r==null?void 0:r.length)>20?`${r.slice(0,20)}...`:r}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:i.admin_edit_profile_container_right,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:r,onChange:t=>{Z(""),T(t.target.value)},onKeyDown:g,style:{border:X?"0.1rem solid red":"none"}}),e.jsx("p",{className:i.error_message,children:X})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:i.admin_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0}),e.jsx("button",{onClick:()=>Y(),className:p?i.admin_verified_icon:i.admin_notverified_icon,title:p?"Verified":"NotVerified",style:{cursor:p?"not-allowed":"pointer"},children:p?e.jsx(fe,{}):e.jsx(V,{})})]})]}),e.jsx(L,{open:Ye,onClose:()=>x(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(Ze,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:l.map((t,o)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:o===0,ref:a=>w.current[o]=a,onChange:a=>{/^\d*$/.test(a.target.value)&&we(o,a.target.value)},onKeyDown:a=>Se(o,a)},o))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>Y(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>x(!1),children:"Cancel"}),e.jsx("button",{onClick:ne,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>I(!0),readOnly:!0})]}),e.jsx(L,{open:We,onClose:()=>I(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>I(!1),children:e.jsx(V,{})})]}),e.jsxs("div",{className:i.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${le?"text":"password"}`,value:ae,onChange:t=>Ie(t.target.value),placeholder:"Enter Old Password",onKeyDown:M}),e.jsx("div",{onClick:()=>$e(t=>!t),children:le?e.jsx(R,{}):e.jsx(A,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${re?"text":"password"}`,value:D,onChange:t=>Ve(t.target.value),placeholder:"Enter New Password",onKeyDown:M}),e.jsx("div",{onClick:()=>Ue(t=>!t),children:re?e.jsx(R,{}):e.jsx(A,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${de?"text":"password"}`,value:se,onChange:t=>Re(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:M}),e.jsx("div",{onClick:()=>ze(t=>!t),children:de?e.jsx(R,{}):e.jsx(A,{})})]})]}),e.jsx("button",{className:i.edit_modal_btn,onClick:ie,children:Te?e.jsx(ge,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:i.admin_edit_mobile_container,style:{outline:ee&&"0.1rem solid red"},children:[e.jsx("div",{onKeyDown:g,children:e.jsx(ot,{forceDialCode:!0,defaultCountry:Ge,value:B,onChange:(t,o)=>Fe(t,o)})}),e.jsx("button",{onClick:()=>Q(),className:u?i.admin_verified_icon:i.admin_notverified_icon,title:u?"Verified":"NotVerified",style:{cursor:u?"not-allowed":"pointer"},children:u?e.jsx(fe,{}):e.jsx(V,{})})]}),e.jsx("p",{className:i.error_message,children:ee})]}),e.jsx(L,{open:He,onClose:()=>j(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:i.modal_common_container,children:[e.jsx("div",{children:e.jsx(et,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:d.map((t,o)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:o===0,ref:a=>k.current[o]=a,onChange:a=>{/^\d*$/.test(a.target.value)&&ke(o,a.target.value)},onKeyDown:a=>Ne(o,a)},o))}),e.jsxs("p",{children:["Didn't get the code ?",e.jsx("span",{onClick:()=>Q(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>j(!1),children:"Cancel"}),e.jsx("button",{onClick:oe,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:U,onChange:t=>$(t.target.value),onKeyDown:g})]}),e.jsxs("div",{className:i.admin_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${v?`${v}`:""}`,onClick:()=>Oe(),readOnly:!0,onKeyDown:g}),Ee&&e.jsx(mt,{onClickAway:()=>N(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>E("Male"),children:"Male"}),e.jsx("p",{onClick:()=>E("Female"),children:"Female"}),e.jsx("p",{onClick:()=>E("Other"),children:"Other"})]})})]}),e.jsx("button",{className:i.edit_profile_btn,onClick:te,children:Le?e.jsx(ge,{}):"Save"})]})]})};export{zt as default};
