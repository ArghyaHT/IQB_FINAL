import{b as m,u as je,a as ve,r as i,d as xe,j as n,f as ge,C as G,M as fe,_ as J}from"./index-BzyIvIPz.js";import{S as ke}from"./index-BZf1azJq.js";import{g as Ce,a as ye,c as $e,b as Ie,d as Me,e as Be,f as Se}from"./BarberAction-DcqRU9JJ.js";import{B as Q}from"./ButtonLoader-DSyBHFHr.js";import{M as U}from"./Modal-BZFy21ue.js";import"./index-DLEqpiVj.js";import"./clsx-B-dksMZM.js";import"./getReactElementRef-B0Sa57LF.js";const we="_admin_barber_wrapper_ijhpf_1",Ae="_barber_send_btn_ijhpf_34",Ne="_create_barber_btn_ijhpf_72",Ee="_admin_barber_content_wrapper_ijhpf_118",Oe="_admin_barber_content_body_ijhpf_129",De="_admin_barber_content_body_item_ijhpf_224",Ke="_barber_online_btn_active_ijhpf_326",Le="_barber_clock_btn_active_ijhpf_327",He="_barber_online_btn_inactive_ijhpf_338",Re="_barber_clock_btn_inactive_ijhpf_339",Pe="_barber_approve_btn_active_ijhpf_364",qe="_barber_approve_btn_inactive_ijhpf_375",ze="_modal_container_ijhpf_388",Fe="_modal_content_container_ijhpf_455",Te="_barber_content_body_error_ijhpf_564",r={admin_barber_wrapper:we,barber_send_btn:Ae,create_barber_btn:Ne,admin_barber_content_wrapper:Ee,admin_barber_content_body:Oe,admin_barber_content_body_item:De,barber_online_btn_active:Ke,barber_clock_btn_active:Le,barber_online_btn_inactive:He,barber_clock_btn_inactive:Re,barber_approve_btn_active:Pe,barber_approve_btn_inactive:qe,modal_container:ze,modal_content_container:Fe,barber_content_body_error:Te},an=()=>{const h=m(e=>e.AdminLoggedInMiddleware.adminSalonId),V=m(e=>e.getAdminBarberList),{loading:W,resolve:X,getAllBarbers:s}=V,d=je(),O=ve(),Y=()=>{O("/admin-barber/createbarber")},Z=e=>{O(`/admin-barber/editbarber/${e.salonId}`,{state:e})},ee=e=>{window.confirm("Are you sure ?")&&d(ye(e.salonId,e.email,e))};i.useEffect(()=>{if(s&&s.length>0){const e=new Map;s.forEach(a=>{const t=`${a.salonId}-${a.barberId}`;e.set(t,a.isOnline||!1)}),j(e);const o=new Map;s.forEach(a=>{const t=`${a.salonId}-${a.barberId}`;o.set(t,a.isClockedIn||!1)}),I(o)}},[s]);const[u,j]=i.useState(new Map),ne=e=>{j(a=>{const t=new Map(a),l=`${e.salonId}-${e.barberId}`,b=!t.get(l)||!1;return t.set(l,b),t});const o={barberId:e.barberId,salonId:e.salonId,isOnline:!u.get(`${e.salonId}-${e.barberId}`)||!1};d($e(o,j,e,u.get(`${e.salonId}-${e.barberId}`)))},[v,I]=i.useState(new Map),ae=e=>{I(a=>{const t=new Map(a),l=`${e.salonId}-${e.barberId}`,b=!t.get(l)||!1;return t.set(l,b),t});const o={barberId:e.barberId,salonId:e.salonId,isClockedIn:!v.get(`${e.salonId}-${e.barberId}`)||!1};d(Ie(o,I,e,v.get(`${e.salonId}-${e.barberId}`),j))},M=i.useRef(new AbortController);i.useEffect(()=>{const e=new AbortController;return M.current=e,d(Ce(h,e.signal)),()=>{M.current&&M.current.abort()}},[h,d]);const[x,B]=i.useState(new Map);i.useEffect(()=>{if(s){const e=new Map;s.forEach(o=>{const a=`${o.salonId}-${o.email}`;e.set(a,o.isApproved||!1)}),B(e)}},[s]);const re=e=>{B(a=>{const t=new Map(a),l=`${e.salonId}-${e.email}`,b=!t.get(l)||!1;return t.set(l,b),t});const o={salonId:e.salonId,email:e.email,isApproved:!x.get(`${e.salonId}-${e.email}`)||!1};d(Me(o,B,e,x.get(`${e.salonId}-${e.email}`)))},te=m(e=>e.adminApproveBarber),{loading:se,resolve:Ge,response:Je}=te;i.useState(!1);const _=m(xe)==="On",[oe,S]=i.useState(!1),[D,w]=i.useState({}),[p,g]=i.useState([]),[K,f]=i.useState([]),[A,k]=i.useState([]),ie=e=>{const o=!D[e._id];w(a=>({...a,[e._id]:o})),o?(g(a=>[...a,e.email]),f(a=>[...a,+`${e.mobileCountryCode}${e.mobileNumber}`]),k(a=>[...a,e.name]),S(!1)):(g(a=>a.filter(t=>t!==e.email)),f(a=>a.filter(t=>t!==+`${e.mobileCountryCode}${e.mobileNumber}`)),k(a=>a.filter(t=>t!==e.name)),S(!1))},le=e=>{S(o=>{if(o)g([]),f([]),k([]),w({});else{const a=s.map(c=>c.email),t=s.map(c=>+`${c.mobileCountryCode}${c.mobileNumber}`),l=s.map(c=>c.name),b=s.reduce((c,ue)=>(c[ue._id]=!0,c),{});g(a),f(t),k(l),w(b)}return!o})},[ce,C]=i.useState(!1),de=()=>{p.length>0?C(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},[L,H]=i.useState(""),[R,N]=i.useState(""),P=()=>{d(Be({subject:L,message:R,role:"Barber",recipientEmails:p},H,N,C))},y=e=>{e.key==="Enter"&&P()},_e=m(e=>e.adminSendBarberEmail),{loading:q}=_e,[be,$]=i.useState(!1),[z,me]=i.useState(""),pe=()=>{K.length>0?$(!0):J.error("Please select a barber",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})},F=()=>{d(Se({smsBody:z,numbers:K},N,$))},E=e=>{e.key==="Enter"&&F()},he=m(e=>e.adminSendBarberMessage),{loading:T}=he;return n.jsxs("div",{className:`${r.admin_barber_wrapper} ${_&&r.dark}`,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Barber List"}),n.jsxs("div",{children:[n.jsx("button",{className:`${r.barber_send_btn} ${_&&r.dark}`,onClick:de,children:n.jsx("div",{children:n.jsx(ge,{})})}),n.jsx(U,{open:ce,onClose:()=>C(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:r.modal_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Email"}),n.jsx("button",{onClick:()=>C(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:r.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"support@iqueuebarbers.com",readOnly:!0,onKeyDown:y})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:p==null?void 0:p.map(e=>" "+e),onKeyDown:y})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Subject"}),n.jsx("input",{type:"text",placeholder:"Enter Subject",value:L,onChange:e=>H(e.target.value),onKeyDown:y})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:R,onChange:e=>N(e.target.value),onKeyDown:y})]}),q?n.jsx("button",{className:r.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:P,disabled:q,className:r.barber_send_btn,children:"Send"})]})]})}),n.jsx("button",{className:`${r.barber_send_btn} ${_&&r.dark}`,onClick:pe,children:n.jsx("div",{children:n.jsx(fe,{})})}),n.jsx(U,{open:be,onClose:()=>$(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:n.jsxs("div",{className:r.modal_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"Send Message"}),n.jsx("button",{onClick:()=>$(!1),children:n.jsx(G,{})})]}),n.jsxs("div",{className:r.modal_content_container,children:[n.jsxs("div",{children:[n.jsx("p",{children:"From"}),n.jsx("input",{type:"text",value:"iqueuebarbers",readOnly:!0,onKeyDown:E})]}),n.jsxs("div",{children:[n.jsx("p",{children:"To"}),n.jsx("input",{type:"text",value:A==null?void 0:A.map(e=>" "+e),onKeyDown:E})]}),n.jsxs("div",{children:[n.jsx("p",{children:"Message"}),n.jsx("textarea",{type:"text",placeholder:"Enter Message",value:z,onChange:e=>me(e.target.value),onKeyDown:E})]}),T?n.jsx("button",{className:r.barber_send_btn,children:n.jsx(Q,{})}):n.jsx("button",{onClick:F,disabled:T,className:r.barber_send_btn,children:"Send"})]})]})}),n.jsxs("button",{onClick:Y,className:`${r.create_barber_btn}`,disabled:h===0,style:{cursor:h===0?"not-allowed":"cursor"},children:[n.jsx("p",{children:"Create"}),n.jsx("div",{children:"+"})]})]})]}),n.jsx("div",{className:`${r.admin_barber_content_wrapper} ${_&&r.dark}`,children:W?n.jsx("div",{className:r.admin_barber_content_body,children:n.jsx(ke,{count:6,height:"6rem",style:{marginBottom:"1rem"},baseColor:_?"var(--darkmode-loader-bg-color)":"var(--lightmode-loader-bg-color)",highlightColor:_?"var(--darkmode-loader-highlight-color)":"var(--lightmode-loader-highlight-color)"})}):X&&(s==null?void 0:s.length)>0?n.jsxs("div",{className:`${r.admin_barber_content_body} ${_&&r.dark}`,children:[n.jsxs("div",{children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",onChange:le,checked:oe})}),n.jsx("p",{children:"Barber Name"}),n.jsx("p",{children:"Email"}),n.jsx("p",{children:"isOnline"}),n.jsx("p",{children:"isClockIn"}),n.jsx("p",{children:"isApprove"}),n.jsx("p",{children:"Edit"}),n.jsx("p",{children:"Delete"})]}),s==null?void 0:s.map((e,o)=>n.jsxs("div",{className:r.admin_barber_content_body_item,style:{borderBottom:(s==null?void 0:s.length)-1===o&&"none"},children:[n.jsx("div",{children:n.jsx("input",{type:"checkbox",checked:D[e._id]||!1,onChange:()=>ie(e)})}),n.jsx("p",{children:(e==null?void 0:e.name.length)>18?(e==null?void 0:e.name.slice(0,18))+"...":e==null?void 0:e.name}),n.jsx("p",{children:(e==null?void 0:e.email.length)>18?(e==null?void 0:e.email.slice(0,18))+"...":e==null?void 0:e.email}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ne(e),className:u.get(`${e.salonId}-${e.barberId}`)?r.barber_online_btn_active:r.barber_online_btn_inactive,children:u.get(`${e.salonId}-${e.barberId}`)?"Online":"Offline"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ae(e),className:v.get(`${e.salonId}-${e.barberId}`)?r.barber_clock_btn_active:r.barber_clock_btn_inactive,children:v.get(`${e.salonId}-${e.barberId}`)?"Clock-In":"Clock-Out"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>re(e),className:x.get(`${e.salonId}-${e.email}`)?r.barber_approve_btn_active:r.barber_approve_btn_inactive,disabled:!!se,children:x.get(`${e.salonId}-${e.email}`)?"Approved":"Approve"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>Z(e),children:"Edit"})}),n.jsx("div",{children:n.jsx("button",{onClick:()=>ee(e),children:"Delete"})})]},e._id))]}):n.jsx("div",{className:`${r.barber_content_body_error} ${_&&r.dark}`,children:n.jsx("p",{children:"Barbers not available"})})})]})};export{an as default};
