import{u as ut,a as pt,b as g,r as s,d as ht,j as e,a0 as ft,C as S,a1 as vt,o as jt,a6 as bt,aA as Ce,aB as xt,E as U,N as W,aC as gt,_ as f,p as Se,cn as wt}from"./index-u-AATrzO.js";import{l as yt,U as Ct}from"./libphonenumber-jOZUm_53.js";import{B as G}from"./ButtonLoader-CR5N2D0l.js";import{b as St,a as Nt,c as kt,d as Et,e as It,f as zt}from"./BarberProfileAction-BYZ9yFFA.js";import{a as Mt}from"./BarberQueueAction-CZviuVkE.js";import{S as B}from"./Skeleton-Bl1IUrm_.js";import{M as N}from"./Modal-ghuyP4Rw.js";import{C as Ot}from"./ClickAwayListener-D5K8AY6H.js";import"./clsx-B-dksMZM.js";import"./index-pYybFpgN.js";import"./index-8JwjhRSi.js";import"./getReactElementRef-CWP5Jz8O.js";const Rt="_barber_edit_profile_container_hwluz_1",Vt="_barber_edit_profile_container_left_hwluz_18",Tt="_barber_edit_profile_content_left_hwluz_31",Dt="_barber_edit_profile_container_right_hwluz_70",Lt="_edit_profile_btn_hwluz_165",$t="_upload_image_container_hwluz_225",Kt="_barber_profile_loader_hwluz_270",At="_profile_skeleton_img_hwluz_280",Ut="_barber_edit_email_container_hwluz_286",Wt="_barber_verified_icon_hwluz_325",Gt="_barber_notverified_icon_hwluz_342",Bt="_barber_edit_mobile_container_hwluz_359",Ft="_barber_edit_gender_container_hwluz_428",Pt="_modal_container_hwluz_471",Ht="_modal_content_container_hwluz_537",Yt="_edit_modal_btn_hwluz_582",Jt="_modal_common_container_hwluz_617",qt="_edit_modal_container_hwluz_752",Qt="_edit_modal_content_container_hwluz_817",Xt="_service_item_hwluz_824",Zt="_service_add_icon_hwluz_839",en="_service_delete_icon_hwluz_870",tn="_service_item_top_hwluz_901",nn="_service_item_bottom_hwluz_955",on="_edit_modal_content_container_loading_hwluz_1037",sn="_edit_modal_content_container_error_hwluz_1051",an="_error_message_hwluz_1102",a={barber_edit_profile_container:Rt,barber_edit_profile_container_left:Vt,barber_edit_profile_content_left:Tt,barber_edit_profile_container_right:Dt,edit_profile_btn:Lt,upload_image_container:$t,barber_profile_loader:Kt,profile_skeleton_img:At,barber_edit_email_container:Ut,barber_verified_icon:Wt,barber_notverified_icon:Gt,barber_edit_mobile_container:Bt,barber_edit_gender_container:Ft,modal_container:Pt,modal_content_container:Ht,edit_modal_btn:Yt,modal_common_container:Jt,edit_modal_container:qt,edit_modal_content_container:Qt,service_item:Xt,service_add_icon:Zt,service_delete_icon:en,service_item_top:tn,service_item_bottom:nn,edit_modal_content_container_loading:on,edit_modal_content_container_error:sn,error_message:an},gn=()=>{var ve,je,be,xe,ge;const _=ut(),F=pt(),n=g(t=>t.BarberLoggedInMiddleware.entiredata.user[0]);console.log(n==null?void 0:n.salonId);const[b,Ne]=s.useState(n==null?void 0:n.emailVerified),[x,ke]=s.useState(n==null?void 0:n.mobileVerified),[m,Ee]=s.useState(n==null?void 0:n.name),[P,Ie]=s.useState((ve=n==null?void 0:n.dateOfBirth)==null?void 0:ve.split("T")[0]),H=s.useRef(null),ze=()=>{H.current.click()},[Me,k]=s.useState(!1),Oe=async t=>{var d,we,ye;const i=t.target.files[0];if(!["image/jpeg","image/webp","image/png"].includes(i.type)){f.error("Please upload only valid image files (JPEG, WebP, PNG).",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const r=2*1024*1024;if(i.size>r){f.error("File size must be lower than 2mb",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}const h=new FormData;h.append("email",n==null?void 0:n.email),h.append("profile",i),h.append("salonId",n==null?void 0:n.salonId);try{k(!0);const v=await Se.post("/api/barber/uploadBarberProfilePicture",h,{headers:{"Content-Type":"multipart/form-data"}});k(!1);const{data:mt}=await Se.get("/api/barber/barberloggedin");_({type:wt,payload:mt}),f.success("Profile upload successfully",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}catch(v){if(k(!1),((d=v==null?void 0:v.response)==null?void 0:d.status)===500){f.error("Something went wrong !",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});return}f.error((ye=(we=v==null?void 0:v.response)==null?void 0:we.data)==null?void 0:ye.message,{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}})}},Y=s.useRef(30),J="lastEmailVerificationTime",q=()=>{if(!b){const t=localStorage.getItem(J),i=Math.floor(Date.now()/1e3);if(t&&i-t<Y.current){const o=Y.current-(i-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(J,i),_(St(n==null?void 0:n.email,C))}},[u,E]=s.useState(["","","",""]),I=s.useRef([]),Re=(t,i)=>{const o=[...u];o[t]=i,i&&t<u.length-1&&I.current[t+1].focus(),E(o)},Ve=(t,i)=>{if(i.key==="Backspace"&&t>0&&!u[t]){const o=[...u];o[t-1]="",I.current[t-1].focus(),E(o)}i.key==="Enter"&&re()},Q=s.useRef(30),X="lastMobileVerificationTime",Z=()=>{if(!x){const t=localStorage.getItem(X),i=Math.floor(Date.now()/1e3);if(t&&i-t<Q.current){const o=Q.current-(i-t);alert(`Please wait ${o} seconds before resending.`);return}localStorage.setItem(X,i),_(Nt(n==null?void 0:n.email,y))}},[p,z]=s.useState(["","","",""]),M=s.useRef([]),Te=(t,i)=>{const o=[...p];o[t]=i,i&&t<p.length-1&&M.current[t+1].focus(),z(o)},De=(t,i)=>{if(i.key==="Backspace"&&t>0&&!p[t]){const o=[...p];o[t-1]="",M.current[t-1].focus(),z(o)}i.key==="Enter"&&le()},[O,Le]=s.useState(n==null?void 0:n.gender),[$e,R]=s.useState(!1),Ke=()=>{R(t=>!t)},V=t=>{Le(t),R(!1)},[ee,Ae]=s.useState(`${n==null?void 0:n.mobileCountryCode}${(je=n==null?void 0:n.mobileNumber)==null?void 0:je.toString()}`),[Ue,We]=s.useState(n==null?void 0:n.mobileCountryCode),[Ge,te]=s.useState(!1),[ne,ie]=s.useState(""),[oe,se]=s.useState(""),T=()=>{if(m.length===0||m.length>20)return f.error("Name must be between 1 to 20 characters",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),ie("Name must be between 1 to 20 characters");if(Ge)return f.error("Invalid Number",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}}),se("Invalid Number");const t={email:n==null?void 0:n.email,dateOfBirth:P,mobileNumber:Number(ee),countryCode:Number(Ue),name:m,gender:O,password:w,barberServices:c};_(kt(t,F))},j=t=>{t.key==="Enter"&&T()},Be=g(t=>t.barberUpdateProfile),{loading:ae,resolve:rn}=Be,re=()=>{const t=u==null?void 0:u.join("");_(Et(n==null?void 0:n.email,t,C,E,Ne))},le=()=>{const t=p==null?void 0:p.join("");_(It(n==null?void 0:n.email,t,y,z,ke))},[ce,Fe]=s.useState(""),[w,Pe]=s.useState(""),[de,He]=s.useState("");s.useState(!1);const _e=()=>{if(w!==de)f.error("New and confirm password donot match",{duration:3e3,style:{fontSize:"var(--list-modal-header-normal-font)",borderRadius:"0.3rem",background:"#333",color:"#fff"}});else{const t={email:n==null?void 0:n.email,password:w,oldPassword:ce};_(zt(t,F))}},D=t=>{t.key==="Enter"&&_e()},Ye=g(t=>t.barberUpdatePassword),{loading:Je}=Ye;g(ht);const[me,qe]=s.useState(!1),[ue,Qe]=s.useState(!1),[pe,Xe]=s.useState(!1),he=yt.PhoneNumberUtil.getInstance(),Ze=t=>{try{return he.isValidNumber(he.parseAndKeepRawInput(t))}catch{return!1}},[et,tt]=s.useState("gb"),nt=(t,i)=>{se("");const{country:o,inputValue:r}=i;Ze(t)?(Ae(t),We(o==null?void 0:o.dialCode),tt(o==null?void 0:o.iso2),te(!1)):te(!0)},[it,L]=s.useState(!1),[ot,y]=s.useState(!1),[st,C]=s.useState(!1),[at,$]=s.useState(!1);s.useEffect(()=>{n&&_(Mt(n==null?void 0:n.salonId))},[n,_]);const rt=g(t=>t.getAllSalonServicesBarber),{loading:lt,resolve:ln,response:l}=rt;s.useEffect(()=>{var t;l&&K((t=l==null?void 0:l.response)==null?void 0:t.services)},[l]);const[fe,K]=s.useState([]),[c,A]=s.useState(n==null?void 0:n.barberServices),ct=t=>{c.includes(t)||A([...c,{...t,barberServiceEWT:t.serviceEWT}])},dt=t=>{var o;const i=(o=l==null?void 0:l.response)==null?void 0:o.services.find(r=>r.serviceId===t.serviceId);i&&(A(c.filter(r=>r.serviceId!==t.serviceId)),K(fe.map(r=>r.serviceId===t.serviceId?{...r,serviceEWT:i.serviceEWT}:r)))},_t=(t,i)=>{var h;const o=t.target.value.replace(/[^0-9]/g,""),r=o===""?"":Number(o);c.find(d=>d.serviceId===i.serviceId)?A(c.map(d=>d.serviceId===i.serviceId?{...d,barberServiceEWT:r}:d)):K((h=l==null?void 0:l.response)==null?void 0:h.services.map(d=>d.serviceId===i.serviceId?{...d,serviceEWT:r}:d))};return e.jsxs("main",{className:a.barber_edit_profile_container,children:[e.jsxs("div",{className:a.barber_edit_profile_container_left,children:[e.jsx("div",{children:e.jsx("p",{children:"Your Profile"})}),e.jsxs("div",{className:a.barber_edit_profile_content_left,children:[e.jsxs("div",{children:[Me?e.jsx(B,{variant:"rectangular",className:a.barber_profile_loader}):e.jsx("img",{src:(be=n==null?void 0:n.profile[0])==null?void 0:be.url,alt:"profile"}),e.jsx("button",{className:a.upload_image_container,onClick:()=>ze(),children:e.jsx(ft,{})}),e.jsx("input",{type:"file",ref:H,style:{display:"none"},onChange:Oe})]}),e.jsx("p",{children:(m==null?void 0:m.length)>20?`${m.slice(0,20)}...`:m}),e.jsx("p",{children:n==null?void 0:n.email})]})]}),e.jsxs("div",{className:a.barber_edit_profile_container_right,children:[e.jsx("button",{onClick:()=>$(!0),children:"Edit services"}),e.jsx(N,{open:at,onClose:()=>$(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.edit_modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Edit Services"}),e.jsx("button",{onClick:()=>$(!1),children:e.jsx(S,{})})]}),lt?e.jsxs("main",{className:`${a.edit_modal_content_container_loading}`,children:[e.jsx(B,{variant:"rectangular",width:"100%",height:"16rem",style:{borderRadius:"var(--list-wrapper-border-radius)"}}),e.jsx(B,{variant:"rectangular",width:"100%",height:"16rem",style:{borderRadius:"var(--list-wrapper-border-radius)"}})]}):((ge=(xe=l==null?void 0:l.response)==null?void 0:xe.services)==null?void 0:ge.length)>0?e.jsx("main",{className:a.edit_modal_content_container,children:fe.map(t=>{var i,o;return e.jsxs("div",{className:`${a.service_item}`,children:[e.jsxs("div",{className:`${a.service_item_top}`,children:[e.jsx("div",{children:e.jsx("img",{src:(i=t==null?void 0:t.serviceIcon)==null?void 0:i.url,alt:"service icon"})}),e.jsxs("div",{children:[e.jsx("p",{children:t==null?void 0:t.serviceName}),e.jsx("p",{children:t!=null&&t.vipService?"VIP":"Regular"}),e.jsx("p",{children:t==null?void 0:t.serviceDesc})]})]}),e.jsxs("div",{className:`${a.service_item_bottom}`,children:[e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("p",{children:"Service Price"}),e.jsxs("p",{children:[(o=l==null?void 0:l.response)==null?void 0:o.currency,t==null?void 0:t.servicePrice]})]})}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("p",{children:"Est Wait Time"}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(vt,{})}),e.jsx("input",{type:"text",value:c!=null&&c.find(r=>r.serviceId===t.serviceId)?c==null?void 0:c.find(r=>r.serviceId===t.serviceId).barberServiceEWT:t.serviceEWT,onChange:r=>_t(r,t)}),e.jsx("p",{children:"mins"})]})]})})]}),c.find(r=>r.serviceId===t.serviceId)?e.jsx("button",{className:`${a.service_delete_icon}`,onClick:()=>dt(t),children:e.jsx(jt,{})}):e.jsx("button",{className:`${a.service_add_icon}`,onClick:()=>ct(t),children:e.jsx(bt,{})})]},t==null?void 0:t._id)})}):e.jsx("main",{className:`${a.edit_modal_content_container_error}`,children:e.jsx("p",{children:"No services available"})}),e.jsx("button",{onClick:T,children:ae?e.jsx(G,{}):"Save"})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Name"}),e.jsx("input",{type:"text",placeholder:"Enter Name",value:m,onChange:t=>{ie(""),Ee(t.target.value)},onKeyDown:j,style:{border:ne?"0.1rem solid red":"none"}}),e.jsx("p",{className:a.error_message,children:ne})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Email"}),e.jsxs("div",{className:a.barber_edit_email_container,children:[e.jsx("input",{type:"text",placeholder:"Enter Email",value:n==null?void 0:n.email,readOnly:!0,onKeyDown:j}),e.jsx("button",{onClick:()=>q(),className:b?a.barber_verified_icon:a.barber_notverified_icon,title:b?"Verified":"NotVerified",style:{cursor:b?"not-allowed":"pointer"},children:b?e.jsx(Ce,{}):e.jsx(S,{})})]})]}),e.jsx(N,{open:st,onClose:()=>C(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.modal_common_container,children:[e.jsx("div",{children:e.jsx(xt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your email"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:n==null?void 0:n.email})]}),e.jsx("div",{children:u.map((t,i)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:i===0,ref:o=>I.current[i]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Re(i,o.target.value)},onKeyDown:o=>Ve(i,o)},i))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>q(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>C(!1),children:"Cancel"}),e.jsx("button",{onClick:re,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Password"}),e.jsx("input",{type:"text",value:"********",onClick:()=>L(!0),readOnly:!0})]}),e.jsx(N,{open:it,onClose:()=>L(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.modal_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Change your password"}),e.jsx("button",{onClick:()=>L(!1),children:e.jsx(S,{})})]}),e.jsxs("div",{className:a.modal_content_container,children:[e.jsxs("div",{children:[e.jsx("p",{children:"Old Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${ue?"text":"password"}`,value:ce,onChange:t=>Fe(t.target.value),placeholder:"Enter Old Password",onKeyDown:D}),e.jsx("div",{onClick:()=>Qe(t=>!t),children:ue?e.jsx(U,{}):e.jsx(W,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"New Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${me?"text":"password"}`,value:w,onChange:t=>Pe(t.target.value),placeholder:"Enter New Password",onKeyDown:D}),e.jsx("div",{onClick:()=>qe(t=>!t),children:me?e.jsx(U,{}):e.jsx(W,{})})]})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Confirm Password"}),e.jsxs("div",{children:[e.jsx("input",{type:`${pe?"text":"password"}`,value:de,onChange:t=>He(t.target.value),placeholder:"Enter Confirm Password",onKeyDown:D}),e.jsx("div",{onClick:()=>Xe(t=>!t),children:pe?e.jsx(U,{}):e.jsx(W,{})})]})]}),e.jsx("button",{className:a.edit_modal_btn,onClick:_e,children:Je?e.jsx(G,{}):"Save"})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Mob. Number"}),e.jsxs("div",{className:a.barber_edit_mobile_container,style:{outline:oe&&"0.1rem solid red"},children:[e.jsx("div",{onKeyDown:j,children:e.jsx(Ct,{forceDialCode:!0,defaultCountry:et,value:ee,onChange:(t,i)=>nt(t,i)})}),e.jsx("button",{onClick:()=>Z(),className:x?a.barber_verified_icon:a.barber_notverified_icon,title:x?"Verified":"NotVerified",style:{cursor:x?"not-allowed":"pointer"},children:x?e.jsx(Ce,{}):e.jsx(S,{})})]}),e.jsx("p",{className:a.error_message,children:oe})]}),e.jsx(N,{open:ot,onClose:()=>y(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:a.modal_common_container,children:[e.jsx("div",{children:e.jsx(gt,{})}),e.jsxs("div",{children:[e.jsx("p",{children:"Please check your message"}),e.jsxs("p",{children:["We have sent a code to your ",e.jsx("span",{style:{fontWeight:"600",color:"#000"},children:n==null?void 0:n.mobileNumber})]}),e.jsx("div",{children:p.map((t,i)=>e.jsx("input",{type:"text",maxLength:1,value:t,autoFocus:i===0,ref:o=>M.current[i]=o,onChange:o=>{/^\d*$/.test(o.target.value)&&Te(i,o.target.value)},onKeyDown:o=>De(i,o)},i))}),e.jsxs("p",{children:["Didn't get the code ? ",e.jsx("span",{onClick:()=>Z(),children:"Click to resend"})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>y(!1),children:"Cancel"}),e.jsx("button",{onClick:le,children:"Verify"})]})]})]})}),e.jsxs("div",{children:[e.jsx("p",{children:"Date of Birth"}),e.jsx("input",{type:"date",value:P,onChange:t=>Ie(t.target.value),onKeyDown:j})]}),e.jsxs("div",{className:a.barber_edit_gender_container,children:[e.jsx("p",{children:"Gender"}),e.jsx("input",{type:"text",value:`${O?`${O}`:""}`,onClick:()=>Ke(),readOnly:!0,onKeyDown:j}),$e&&e.jsx(Ot,{onClickAway:()=>R(!1),children:e.jsxs("div",{children:[e.jsx("p",{onClick:()=>V("Male"),children:"Male"}),e.jsx("p",{onClick:()=>V("Female"),children:"Female"}),e.jsx("p",{onClick:()=>V("Other"),children:"Other"})]})})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Selected Services"}),e.jsx("input",{type:"text",value:c==null?void 0:c.map(t=>" "+t.serviceName),placeholder:"Your Services",onKeyDown:j})]}),e.jsx("button",{className:a.edit_profile_btn,onClick:T,children:ae?e.jsx(G,{}):"Save"})]})]})};export{gn as default};
